(()=>{"use strict";var t={5:function(t,e,i){var s,n,a,o,r,h,l,d=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),f=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&d(e,t,i[n]);return f(e,t),e}),c=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},v=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};Object.defineProperty(e,"__esModule",{value:!0});const p=i(869),g=u(i(797));class m{constructor(){n.add(this),o.set(this,void 0),c(this,o,new Map,"f")}handle(t,e,i){const s=v(this,n,"m",h).call(this,t,e);v(this,o,"f").has(s)||v(this,o,"f").set(s,i),v(this,n,"m",r).call(this,s)}contains(t,e){return v(this,o,"f").has(v(this,n,"m",h).call(this,t,e))}reload(t,e){this.contains(t,e)&&(v(this,o,"f").get(v(this,n,"m",h).call(this,t,e)).timer=new Date)}clear(){v(this,o,"f").forEach((t,e)=>!v(this,n,"m",l).call(this,e,p.AnimationType.Init)&&v(this,o,"f").delete(e))}reverse(t,e){if(this.contains(t,e)){let i=v(this,o,"f").get(v(this,n,"m",h).call(this,t,e)),s=new Date,a=s.getTime()-(i.timer??s).getTime(),r=a>i.duration?1:i.duration-a;i.timer=new Date((new Date).getTime()-r),i.backward=!i.backward}}isBackward(t,e){return v(this,o,"f").get(v(this,n,"m",h).call(this,t,e))?.backward??!1}isEnd(t,e){let i=v(this,o,"f").get(v(this,n,"m",h).call(this,t,e)),s=new Date;return s.getTime()-(i.timer??s).getTime()>=i.duration}end(t,e){let i=v(this,o,"f").get(v(this,n,"m",h).call(this,t,e));i&&(i.timer=g.Dates.minDate)}static initializeTransitions(){for(let t=0;t<22820;t++){const e=(t+1)/22820;let i=0*Math.pow(1-e,3)+3*Math.pow(1-e,2)*.77*e+3*(1-e)*Math.pow(e,2)*.23+1*Math.pow(e,3),s=0*Math.pow(1-e,3)+3*Math.pow(1-e,2)*.23*e+3*(1-e)*Math.pow(e,2)*.77+1*Math.pow(e,3);a.transitionCurve.set(+i.toFixed(4),s)}a.transitionCurve.set(0,0)}static getTransition(t){return a.transitionCurve.get(+t.toFixed(4))??0}}a=m,o=new WeakMap,n=new WeakSet,r=function(t){const e=v(this,o,"f").get(t),i=new Date,s=i.getTime()-(e.timer??i).getTime(),n=a.getTransition(s>e.duration?1:s/e.duration),r=!e.before||e.before();!e.timer&&r&&(e.timer=i),r&&e.body(e.backward?1-n:n),1!=n||r&&!e.continuous||v(this,o,"f").delete(t)},h=function(t,e){return t+"_"+e},l=function(t,e){return t.endsWith("_"+e)},m.transitionCurve=new Map,e.default=m},10:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.adjustColor=function(t,e){return"#"+t.replace(/^#/,"").replace(/../g,t=>("0"+Math.min(255,Math.max(0,parseInt(t,16)+e)).toString(16)).slice(-2))},e.grayScale=function(t){return"#"+Array(4).join(Math.round([.3,.59,.11].reduce((e,i,s)=>e+i*parseInt(t[2*s+1]+t[2*s+2],16),0)/3).toString(16).padStart(2,"0"))},e.randomColor=function(){let t="#";for(let e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},e.stringWidth=function(t,e){if(!t)return 0;const i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.559375,.2765625,.3546875,.5546875,.5546875,.8890625,.665625,.190625,.3328125,.3328125,.3890625,.5828125,.2765625,.3328125,.2765625,.3015625,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.2765625,.2765625,.584375,.5828125,.584375,.5546875,1.0140625,.665625,.665625,.721875,.721875,.665625,.609375,.7765625,.721875,.2765625,.5,.665625,.5546875,.8328125,.721875,.7765625,.665625,.7765625,.721875,.665625,.609375,.721875,.665625,.94375,.665625,.665625,.609375,.2765625,.3546875,.2765625,.4765625,.5546875,.3328125,.5546875,.5546875,.5,.5546875,.5546875,.2765625,.5546875,.5546875,.221875,.240625,.5,.221875,.8328125,.5546875,.5546875,.5546875,.5546875,.3328125,.5,.2765625,.5546875,.5,.721875,.5,.5,.5,.3546875,.259375,.353125,.5890625];return Array.from(String(t)).reduce((t,e)=>t+(i[e.charCodeAt(0)]??.5279276315789471),0)*(e||14)},e.guid=function(){const t=()=>(65536*(1+Math.random())|0).toString(16).substring(1);return(t()+t()+"-"+t()+"-4"+t().slice(0,3)+"-"+t()+"-"+t()+t()+t()).toLowerCase()},e.isColorVisible=function(t,e){const i=r(t),s=r(e);return(i.r+i.g+i.b)/(s.r+s.g+s.b)<.77},e.getColor=o,e.hexToRgb=r,e.isISOString=function(t){return/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+/.test(t)},e.getHexValues=h,e.getShortHexValues=l,e.applyAlpha=function(t,e){function i(t){const e=h(t);return e?o(e[1],e[2],e[3]):new n.default}const s=i(t),r=i(a.default.canvasBackground),l=1-(e/=255);return function(t,e,i){function s(t){let e=t.toString(16);return 1==e.length?"0"+e:e}return"#"+s(t)+s(e)+s(i)}(Math.round(255*(e*(s.r/255)+l*(r.r/255))),Math.round(255*(e*(s.g/255)+l*(r.g/255))),Math.round(255*(e*(s.b/255)+l*(r.b/255))))};const n=s(i(125)),a=s(i(409));function o(t,e,i){return{r:parseInt(t,16),g:parseInt(e,16),b:parseInt(i,16)}}function r(t){if(t.length>4){const e=h(t);if(e)return o(e[1],e[2],e[3])}else{const e=l(t);if(e)return o(e[1]+e[1],e[2]+e[2],e[3]+e[3])}return new n.default}function h(t){return/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t)}function l(t){return/^#?([a-f\d])([a-f\d])([a-f\d])$/i.exec(t)}},12:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,e){this.text=t,this.color=e}}},39:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class i{static throw(t){throw new Error(t)}static throwIsUndefined(t,e){null==t&&i.throw(e)}}e.default=i},88:function(t,e,i){var s,n,a,o,r,h,l,d,f,u,c,v=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},p=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},g=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const m=g(i(927)),y=g(i(557)),w=g(i(801)),b=g(i(690)),x=g(i(5)),M=g(i(409)),T=g(i(283)),P=i(869),_=g(i(427));n=new WeakMap,a=new WeakMap,o=new WeakMap,r=new WeakMap,s=new WeakSet,h=function(){if(this.settings.enableTooltip=!this.settings.disableInteractions&&this.settings.enableTooltip,null==v(this,n,"f")||this.settings.type!=v(this,r,"f"))switch(v(this,n,"f")?.destroy(),this.settings.type){case P.ChartType.Plot:p(this,n,new y.default(this),"f"),p(this,r,P.ChartType.Plot,"f");break;case P.ChartType.Circular:p(this,n,new _.default(this),"f"),p(this,r,P.ChartType.Circular,"f");break;case P.ChartType.Gauge:p(this,n,new w.default(this),"f"),p(this,r,P.ChartType.Gauge,"f");break;case P.ChartType.TreeMap:p(this,n,new b.default(this),"f"),p(this,r,P.ChartType.TreeMap,"f")}else v(this,n,"f").applySettings(this.settings);v(this,n,"f").prepareSettings(),this.settings.disableInteractions||(v(this,n,"f").initDropdown(),v(this,n,"f").initAnimations()),v(this,n,"f").resize()},l=function(){v(this,n,"f").refresh(),v(this,a,"f")?.refresh()},d=function(){v(this,n,"f").resize(),v(this,a,"f")?.resize()},f=function(t){M.default.initialize(()=>v(this,s,"m",d).call(this),t.isDarkThemeFunction),x.default.initializeTransitions()},u=function(){this.node.style.display=T.default.Display.Flex,this.node.style.flexDirection=T.default.FlexDirection.Column,this.node.style.alignItems=T.default.AlignItems.Center,this.node.style.justifyContent=T.default.JustifyContent.Center,this.node.style.height="100%"},c=function(){null==v(this,o,"f")&&(p(this,o,new ResizeObserver(()=>{v(this,n,"f").canvas?v(this,s,"m",d).call(this):this.destroy()}),"f"),v(this,o,"f").observe(this.node))},e.default=class{constructor(t,e){s.add(this),n.set(this,void 0),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),this.node=t,this.applySettings(e),v(this,s,"m",u).call(this),document.addEventListener(P.Events.VisibilityChanged,()=>v(this,n,"f").resetMouse()),window.addEventListener(P.Events.Blur,()=>v(this,n,"f").resetMouse()),window.addEventListener(P.Events.Click,t=>{t.target!=v(this,n,"f").canvas&&v(this,n,"f").closeDropdowns()})}render(){v(this,n,"f").render(),v(this,a,"f")?.render(),v(this,s,"m",c).call(this),v(this,s,"m",l).call(this)}destroy(){v(this,n,"f").destroy(),v(this,a,"f")?.destroy(),v(this,o,"f").disconnect()}highlight(t){v(this,n,"f").highlight(t)}reset(){M.default.reset(),v(this,s,"m",f).call(this,this.settings)}applySettings(t){this.settings=t,this.reset();const e=this.settings.type!=v(this,r,"f");v(this,s,"m",h).call(this),this.settings.enableLegend&&null!=v(this,a,"f")&&v(this,a,"f").applySettings(t),this.settings.enableLegend&&null==v(this,a,"f")&&(p(this,a,new m.default(this),"f"),v(this,a,"f").render()),this.settings.enableLegend||null==v(this,a,"f")||(v(this,a,"f").destroy(),p(this,a,void 0,"f")),e&&v(this,n,"f").render(),v(this,s,"m",c).call(this)}}},125:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{}},126:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Animations=void 0;class i{}e.Animations=i,i.circular=335,i.legend=500,i.tree=250,i.tooltip=120,i.button=200},138:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=s(i(527));class a extends n.default{constructor(t){super(),Object.assign(this,t),this.baseColor=this.color,this.canRenderLabel=!1,this.isMouseInside=!1}toggle(t){super.toggle(t),this.disabled?this.current=this.value*(1-t):this.current=this.value*t}checkCondition(){return super.checkCondition(),0==this.current&&!this.disabled||0!=this.value}reset(){super.reset(),this.current=this.value}}e.default=a},147:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class i{}i.exportPNG="Save as image...",i.decomposeToTable="Show as table...",i.reset="Reset",i.exportCSV="Save as table...",i.menu="Menu",i.allDataIsHidden="All data is hidden",i.other="Other",i.thousandShort="K",i.millionShort="M",i.billionShort="B",i.show="Show...",i.noLabel="No Label",i.treeMapIsEmpty="Tree Map is empty",i.dataAsTable="Data as table",e.default=i},168:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=s(i(39)),a=i(869),o=s(i(409));e.default=class{static getContext(t){return t.getContext("2d",{willReadFrequently:!0})??n.default.throw(a.ErrorType.NullContext)}static isPixelBusy(t){return null!=t&&t-o.default.canvasBackgroundInt!=0}}},183:function(t,e,i){var s,n,a,o,r,h,l,d,f,u,c,v,p,g,m=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),y=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),w=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&m(e,t,i[n]);return y(e,t),e}),b=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},x=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},M=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const T=M(i(409)),P=M(i(601)),_=w(i(10)),A=M(i(168)),O=w(i(797)),S=M(i(283)),C=i(869);a=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,l=new WeakMap,d=new WeakMap,f=new WeakMap,u=new WeakMap,n=new WeakSet,c=function(t){const e=A.default.getContext(this.canvas),i=Math.max(...x(this,u,"f").map(t=>_.stringWidth(t.text??"")+(t.color?8:0)));let s=t.clientX-x(this,r,"f").x+10,a=t.clientY-x(this,r,"f").y+scrollY+10;s+i+25>x(this,r,"f").width&&(s=x(this,r,"f").width-(i+25)),a+15+18*x(this,u,"f").length>x(this,r,"f").height&&(a=x(this,r,"f").height-15-18*x(this,u,"f").length),e.beginPath(),e.roundRect(s,a,i+24,16+16*x(this,u,"f").length,6);let o=Math.round(255*x(this,n,"m",g).call(this)).toString(16),h=Math.round(207*x(this,n,"m",g).call(this)).toString(16);1==o.length&&(o="0"+o),1==h.length&&(h="0"+h),e.strokeStyle=T.default.dropdownBorder+h,e.lineWidth=1,e.fillStyle=T.default.background+h,e.stroke(),e.fill();for(let t of x(this,u,"f")){let i=0;t.color&&(i=12,e.beginPath(),e.fillStyle=t.color+o,e.arc(s+16,a+17,5,0,2*Math.PI),e.fill()),P.default.tooltip(e),e.fillStyle=T.default.text+o,e.fillText(t.text??"",s+i+12,a+21),a+=16}},v=function(t,e){if(null==e)return;const i=x(this,h,"f").id+e.id;let s=document.getElementById(i);const a=()=>{x(this,n,"m",p).call(this),s.style.visibility=S.default.Visibility.Visible};if(!s){const t=/\${[^}]*}/gm;let n=x(this,h,"f").cloneNode(!0);s=document.createElement(C.Tag.Div),s.innerHTML=n.innerHTML,s.id=i,s.style.position=S.default.Position.Absolute,s.style.pointerEvents=S.default.PointerEvents.None,s.style.visibility=S.default.Visibility.Visible,s.setAttribute(C.Attribute.Name,x(this,h,"f").id);const o=[...s.innerHTML.matchAll(t)];let r=s.innerHTML;for(const t of o){const i=t[0].replace("${","").replace("}","").replaceAll(" ","");r=r.replaceAll(t[0],e.data[i])}s.innerHTML=r,document.body.appendChild(s),s.position=s.getBoundingClientRect(),a()}s.style.visibility==S.default.Visibility.Hidden&&a(),0==s.position.height&&(s.position=s.getBoundingClientRect());const o=10;let l="1",d=t.clientX,f=t.clientY+scrollY;d+s.position.width-x(this,r,"f").x>x(this,r,"f").width-o&&(d=x(this,r,"f").width-s.position.width+x(this,r,"f").x-o,l=".67"),f+s.position.height-x(this,r,"f").y>x(this,r,"f").height-o&&(f=x(this,r,"f").height-s.position.height+x(this,r,"f").y-o,l=".67"),0==d&&0==f&&(l="0"),s.style.left=d+o+"px",s.style.top=f+o+"px",s.style.opacity=l},p=function(){if(!x(this,o,"f"))return;const t=document.querySelectorAll(`[name="${x(this,h,"f").id}"]`);for(let e of t)e.style.visibility=S.default.Visibility.Hidden},g=function(){if(!x(this,f,"f"))return 0;let t=x(this,d,"f")?1-((new Date).getTime()-x(this,f,"f").getTime())/O.Animations.tooltip:((new Date).getTime()-x(this,f,"f").getTime())/O.Animations.tooltip;return t>1&&(t=1),t<0&&(t=0),t},e.default=class{constructor(t,e){n.add(this),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),h.set(this,void 0),l.set(this,void 0),d.set(this,void 0),f.set(this,void 0),u.set(this,void 0),this.canvas=t,this.data=e.data,b(this,a,e.enableTooltip,"f"),b(this,o,!!e.templateId,"f"),x(this,o,"f")&&b(this,h,document.getElementById(e.templateId),"f"),this.refresh()}render(t,e,i,s){if(x(this,n,"m",p).call(this),x(this,a,"f")&&e)if(t||x(this,l,"f")||x(this,d,"f")){t&&b(this,u,i,"f"),x(this,f,"f")||b(this,f,new Date,"f"),x(this,d,"f")?x(this,l,"f")&&b(this,f,new Date,"f"):b(this,l,!0,"f"),x(this,o,"f")?x(this,n,"m",v).call(this,e,s):x(this,n,"m",c).call(this,e);const a=x(this,n,"m",g).call(this);x(this,d,"f")&&a>=1&&(b(this,l,!1,"f"),b(this,d,!1,"f")),x(this,d,"f")&&a<=0&&(b(this,l,!1,"f"),b(this,d,!1,"f"),b(this,f,void 0,"f")),t||null==x(this,f,"f")||b(this,d,!0,"f")}else b(this,f,void 0,"f")}refresh(){b(this,r,this.canvas.getBoundingClientRect(),"f"),x(this,r,"f").x+=scrollX,x(this,r,"f").y+=scrollY}}},226:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});class i{}i.colors=["#000000","#ffffff"],i.backgrounds=["#f7f7f7","#222222"],i.lines=["#000000","#eeeeee"],i.lineAxes=["#e0e0e0","#212121"],i.lineActives=["#898989","#898989"],i.dropdownBorders=["#bcbcbc","#7e7e7e"],i.canvasBackgrounds=["#ffffff","#222222"],e.default=i},230:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t,...e){this.args=e,this.type=t,this.base=JSON.parse(JSON.stringify(e))}}},268:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=s(i(828)),a=i(869);e.default=class{static getRows(t){let e=[],i=[];for(const s of t.values){let o=new Map;for(const i of s.values)o.set(i.x.toString(),i.y),e.push({value:i.x.toString(),display:t.xType==a.PlotAxisType.Date?n.default.date(new Date(i.x)):i.x.toString()});i.push({name:s.label,values:o})}const s=new Set,o=e.filter(t=>!s.has(t.display)&&s.add(t.display));return t.xType==a.PlotAxisType.Date&&o.sort((t,e)=>new Date(t.value).getTime()-new Date(e.value).getTime()),{headers:o,values:i}}}},281:(t,e)=>{Number.prototype.isAnyEquals=function(...t){return t.includes(this)},Date.prototype.addDays=function(t){let e=new Date(this);return e.setDate(e.getDate()+t),e},Date.prototype.addMilliseconds=function(t){let e=new Date(this);return e.setMilliseconds(e.getMilliseconds()+t),e},Map.prototype.trySet=function(t,e){this.has(t)||this.set(t,e)},Array.prototype.sum=function(t){return this.reduce((e,i)=>e+t(i),0)}},283:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){class e{}e.Default="default",e.Pointer="pointer",t.Cursor=e;class i{}i.Flex="flex",t.Display=i;class s{}s.Column="column",s.ColumnReverse="column-reverse",s.Row="row",s.RowReverse="row-reverse",t.FlexDirection=s;class n{}n.Center="center",t.AlignItems=n;class a{}a.Visible="visible",a.Hidden="hidden",t.Visibility=a;class o{}o.Absolute="absolute",t.Position=o;class r{}r.None="none",t.PointerEvents=r;class h{}h.Center="center",t.JustifyContent=h;class l{}l.Pixelated="pixelated",t.ImageRendering=l}(i||(i={})),e.default=i},359:function(t,e,i){var s,n,a,o,r,h,l,d,f,u,c,v=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),p=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),g=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&v(e,t,i[n]);return p(e,t),e}),m=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},y=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},w=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const b=w(i(409)),x=w(i(5)),M=g(i(10)),T=w(i(601)),P=w(i(168)),_=i(869),A=g(i(797)),O=w(i(283));a=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,l=new WeakMap,d=new WeakMap,n=new WeakSet,f=function(){m(this,r,y(this,d,"f").getBoundingClientRect(),"f"),y(this,r,"f").x+=scrollX,y(this,r,"f").y+=scrollY},u=function(t,e,i,s,n){if(!t)return!1;let a=t.clientX-y(this,r,"f").x+scrollX,o=t.clientY-y(this,r,"f").y+scrollY;return a>=e&&a<=e+s&&o>=i&&o<=i+n},c=function(){const t=y(this,l,"f")?0:M.stringWidth(y(this,o,"f").text??"")+12,e=y(this,l,"f")?0:20;m(this,h,{x:y(this,o,"f").x+t>y(this,d,"f").width?y(this,d,"f").width-t:y(this,o,"f").x<0?y(this,d,"f").width+y(this,o,"f").x-t:y(this,o,"f").x,y:y(this,o,"f").y+e>y(this,d,"f").height?y(this,d,"f").height-e:y(this,o,"f").y<0?y(this,d,"f").height+y(this,o,"f").y-e:y(this,o,"f").y,width:t,height:e},"f")},e.default=class{constructor(t,e){n.add(this),this.isActive=!1,a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),h.set(this,void 0),l.set(this,void 0),d.set(this,void 0),m(this,d,t,"f"),m(this,o,e,"f"),y(this,o,"f").icon&&(y(this,o,"f").text=y(this,o,"f").icon),m(this,l,null==y(this,o,"f").text,"f"),this.animations=new x.default}render(t,e){y(this,a,"f")||y(this,n,"m",f).call(this),y(this,l,"f")&&(this.isActive=!0);const i=P.default.getContext(y(this,d,"f"));let s=y(this,h,"f").x,r=y(this,h,"f").y,c=y(this,h,"f").width,v=y(this,h,"f").height;if(i.beginPath(),!y(this,l,"f")){const a=(t,e)=>{this.animations.reload("animation-dropdown",e),i.fillStyle=M.adjustColor(b.default.canvasBackground,-Math.round(25*t))};y(this,n,"m",u).call(this,t,s,r,c,v)?(y(this,d,"f").style.cursor=O.default.Cursor.Pointer,e&&t.x==e.x&&t.y==e.y&&(this.isActive=!this.isActive,e=void 0),this.isActive?i.fillStyle=M.adjustColor(b.default.canvasBackground,-25):this.animations.handle("animation-dropdown",_.AnimationType.MouseOver,{duration:300,body:t=>{a(t,_.AnimationType.MouseLeave)}})):(y(this,d,"f").style.cursor=O.default.Cursor.Default,this.isActive?i.fillStyle=M.adjustColor(b.default.canvasBackground,-25):this.animations.handle("animation-dropdown",_.AnimationType.MouseLeave,{timer:A.Dates.minDate,duration:300,backward:!0,body:t=>{a(t,_.AnimationType.MouseOver)}})),i.roundRect(s,r,c,v,4),i.fill(),T.default.regular(i),y(this,o,"f").icon&&(i.font="20px sans-serif");const h=y(this,o,"f").icon?"Win32"!=navigator.platform?1:-1:0;i.fillText(y(this,o,"f").text??"",s+c/2,r+v/2-h)}if(this.isActive){const a=6,h=6;r+=v;const l=y(this,o,"f").items.filter(t=>t.text),f=y(this,o,"f").items.filter(t=>!t.text);let c=Math.max(...l.map(t=>M.stringWidth(t.text)))+4*a;s+c>y(this,d,"f").width-4&&(s-=s+c-y(this,d,"f").width+4);const p="bb",g=127,m=b.default.dropdownItemHoverColor,w=b.default.dropdownBorder;i.beginPath();const x={x:s,y:r,width:c,height:26*l.length+4*f.length+(1==l.length?a:0)+(2==l.length&&1==f.length?a:0)};i.roundRect(x.x,x.y,x.width,x.height,h),i.fillStyle=b.default.background+p,i.setLineDash([]),i.lineWidth=1,i.strokeStyle=w+p,i.fill(),i.stroke(),i.beginPath(),r+=6;for(const l of y(this,o,"f").items){if(i.beginPath(),1==l.isDivider){r+=2,i.moveTo(s+a,r),i.lineTo(s+c-a,r),i.lineWidth=.5,i.stroke(),r+=4;continue}i.fillStyle="transparent";const o="animation-dropdown"+l.text,f=(t,e,s)=>{if(this.animations.reload(o,e),s&&1==t)return;let n=Math.round(g*t).toString(16);1==n.length&&(n="0"+n),i.fillStyle=m+n};y(this,n,"m",u).call(this,t,s,r,c,20)?(this.animations.handle(o,_.AnimationType.MouseOver,{duration:300,body:t=>{f(t,_.AnimationType.MouseLeave)}}),y(this,d,"f").style.cursor=O.default.Cursor.Pointer,e&&(l.action(),e=void 0,this.isActive=!1)):this.animations.handle(o,_.AnimationType.MouseLeave,{timer:A.Dates.minDate,duration:300,backward:!0,body:t=>{f(t,_.AnimationType.MouseOver,!0)}}),i.roundRect(s+a,r,c-2*a,20,h),i.fill(),T.default.regular(i),i.fillStyle=b.default.text,i.textAlign="left",i.textBaseline="hanging",i.fillText(l.text,s+2*a,r+5),r+=22}}return i.lineWidth=1,!y(this,l,"f")&&null!=e&&this.isActive&&(this.isActive=!1,e=void 0),m(this,a,!0,"f"),y(this,l,"f")&&e&&t.x==e.x&&t.y==e.y&&(this.isActive=!this.isActive,e=void 0),e}refresh(){m(this,a,!1,"f")}resize(){y(this,n,"m",f).call(this),y(this,n,"m",c).call(this)}close(){this.isActive=!1}}},409:function(t,e,i){var s,n=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),o=0;o<i.length;o++)"default"!==i[o]&&n(e,t,i[o]);return a(e,t),e}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const h=o(i(10)),l=r(i(226)),d=i(869);class f{static initialize(t,e){!f.function&&e&&(f.function=e),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(!f.function||f.function())?f.setTheme(1):f.setTheme(0),window.matchMedia("(prefers-color-scheme: dark)").addEventListener(d.Events.Change,e=>{f.setTheme(!e.matches||f.function&&!f.function()?0:1),t()})}static setTheme(t){f.currentTheme=t,f.text=l.default.colors[t],f.background=l.default.backgrounds[t],f.line=l.default.lines[t],f.lineAxis=l.default.lineAxes[t],f.lineActive=l.default.lineActives[t],f.dropdownItemHoverColor=h.adjustColor(f.background,0==t?-50:50),f.dropdownBorder=l.default.dropdownBorders[t],f.canvasBackground=l.default.canvasBackgrounds[t],f.canvasBackgroundInt=Number(`0xff${f.canvasBackground.slice(1)}`)}static reset(){this.function=void 0}}f.currentTheme=0,e.default=f},427:function(t,e,i){var s,n=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),o=0;o<i.length;o++)"default"!==i[o]&&n(e,t,i[o]);return a(e,t),e}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const h=r(i(459)),l=r(i(510)),d=r(i(138)),f=o(i(10)),u=r(i(359)),c=r(i(409)),v=r(i(601)),p=r(i(12)),g=r(i(743)),m=r(i(804)),y=r(i(147)),w=r(i(897)),b=r(i(168)),x=r(i(828)),M=i(869),T=o(i(797)),P=r(i(283)),_=r(i(230));class A extends h.default{constructor(t){super(t),this.startAngle=Math.PI/4,this.isMousePositionChanged=!1,this.prevMousePos={x:0,y:0},this.moveEvent=new MouseEvent(M.Events.MouseMove)}calculateAngles(){const t=this.data.values.sum(t=>t.current);let e=this.startAngle;this.angles=this.data.values.flatMap(i=>{const s=i.current/t*2*Math.PI;return{id:i.id,value:s,sum:(e+=s)-s}}).reverse()}getAngle(t){return this.angles.find(e=>e.id==t.id)?.value??0}getAccumulator(t){return this.angles.find(e=>e.id==t.id)?.sum??this.startAngle}calculatePoint(t){let e=this.getAccumulator(t);const i=(t,i,s)=>({x:s.x+t*Math.cos(e+i),y:s.y+t*Math.sin(e+i)}),s=i(this.radius,0,this.center),n=this.getAngle(t);let a=i(this.radius,n,this.center),o=[];if(t.direction=e+n/2,n>0){if(t.current>0){let e=i(this.radius+10,n/2,this.center),s=i(this.radius+20,n/2,this.center);const a=e.x>this.center.x?1:-1;let o={x:s.x+10*a,y:s.y};t.labelPoints=[new _.default(M.DrawPointType.Move,e.x,e.y),new _.default(M.DrawPointType.QuadraticCurve,s.x,s.y,o.x,o.y)]}this.isDonut||o.push(new _.default(M.DrawPointType.Move,this.center.x,this.center.y)),o.push(new _.default(M.DrawPointType.Line,s.x,s.y));let r=0,h=n;for(;h>0;){let t=h-Math.PI/6>0?Math.PI/6:h;a=i(this.radius,r+t,this.center);const e=Math.PI-t,s=i(this.radius/Math.sin(e/2),r+t/2,this.center);o.push(new _.default(M.DrawPointType.QuadraticCurve,s.x,s.y,a.x,a.y)),r+=t,h-=Math.PI/6}if(this.isDonut||0!=t.innerRadius){const e=this.radius*(t.innerRadius/100),s={x:a.x-(this.radius-e)*(a.x-this.center.x)/this.radius,y:a.y-(this.radius-e)*(a.y-this.center.y)/this.radius};for(o.push(new _.default(M.DrawPointType.Line,s.x,s.y)),h=0,r=n;h<n;){let t=h+Math.PI/6<n?Math.PI/6:n-h;a=i(e,r-t,this.center);const s=Math.PI-t,l=i(e/Math.sin(s/2),r-t/2,this.center);o.push(new _.default(M.DrawPointType.QuadraticCurve,l.x,l.y,a.x,a.y)),r-=t,h+=Math.PI/6}}e+=n}return t.points=o,t}scale(t,e,i){const s=this.center.x+this.radius/2*Math.cos(t.direction),n=this.center.y+this.radius/2*Math.sin(t.direction);for(let a of t.points)for(let t=0;t<a.args.length;t+=2){const o=a.base[t],r=a.base[t+1],h=Math.sqrt(Math.pow(o-s,2)+Math.pow(r-n,2)),l=(h*e+h*(1-e)*i)/h;a.args[t]=l*o+(1-l)*s,a.args[t+1]=l*r+(1-l)*n}for(let a of t.labelPoints)for(let t=0;t<a.args.length;t+=2){const o=a.base[t],r=a.base[t+1],h=Math.sqrt(Math.pow(o-s,2)+Math.pow(r-n,2)),l=(h*e+h*(1-e)*i)/h;a.args[t]=l*o+(1-l)*s,a.args[t+1]=l*r+(1-l)*n}}focus(t,e,i){t.color=f.applyAlpha(t.baseColor,255-255*e*i),t.textColor=f.applyAlpha(c.default.text,255-255*e*i)}translate(t,e,i){const s=(this.center.x+this.radius*Math.cos(t.direction)-this.center.x)*e,n=(this.center.y+this.radius*Math.sin(t.direction)-this.center.y)*e;t.translate={x:s*i,y:n*i};for(let e of t.points)for(let t=0;t<e.args.length;t+=2)e.args[t]=e.base[t]+s*i,e.args[t+1]=e.base[t+1]+n*i;for(let e of t.labelPoints)for(let t=0;t<e.args.length;t+=2)e.args[t]=e.base[t]+s*i,e.args[t+1]=e.base[t+1]+n*i}outline(t,e,i){t.lineStyles=0==i?{lineWidth:1,lineJoin:"miter",lineCap:"butt"}:{lineWidth:this.getAngle(t)>Math.PI/6?e*i:1,lineJoin:"round",lineCap:"round"}}canRenderLabel(t,e){if(t.state==M.AnimationType.None&&null!=t.canRenderLabel)return t.canRenderLabel;if(0==t.current)return t.canRenderLabel=!1;if(t.state==M.AnimationType.None&&t.canRenderLabel)return t.canRenderLabel;const i=t.labelPoints[0].args[0]<t.labelPoints[1].args[0]?1:-1;let s=!1;const n=t.labelPoints[1].args[0],a=t.labelPoints[1].args[1],o=f.stringWidth(t.label),r=1==i?n+12:n-o-12+(t.translate?t.translate.x:0),h=a-12+(t.translate?t.translate.y:0),l=new Uint32Array(e.getImageData(r,h,o,28).data.buffer);if((r<0||r+o>this.canvas.width||a-12<0||a+12>this.canvas.height)&&(s=!0),!s)for(let t=0;t<l.length;t++)if(b.default.isPixelBusy(l[t])){s=!0;break}return t.canRenderLabel=!s}drawLabel(t,e){if(!this.canRenderLabel(t,e))return;e.beginPath(),e.moveTo(t.labelPoints[0].args[0],t.labelPoints[0].args[1]),e.quadraticCurveTo(t.labelPoints[1].args[0],t.labelPoints[1].args[1],t.labelPoints[1].args[2],t.labelPoints[1].args[3]),e.strokeStyle=t.textColor,0!=t.current&&t.current!=t.value&&(e.strokeStyle=f.applyAlpha(t.textColor,Math.round(t.current/t.value*255))),e.lineWidth=1,e.lineJoin="miter",e.lineCap="butt",e.stroke(),e.fillStyle=t.textColor,0!=t.current&&t.current!=t.value&&(e.fillStyle=f.applyAlpha(t.textColor,Math.round(t.current/t.value*255)));const i=t.labelPoints[0].args[0]<t.labelPoints[1].args[0]?1:-1;v.default.circularLabel(e,1==i),e.fillText(t.label,t.labelPoints[1].args[0]+16*i,t.labelPoints[1].args[1]+4)}drawSector(t,e){e.beginPath(),t.lineStyles&&(e.lineWidth=t.lineStyles.lineWidth,e.lineJoin=t.lineStyles.lineJoin,e.lineCap=t.lineStyles.lineCap);for(const i of t.points)switch(i.type){case M.DrawPointType.Move:e.moveTo(i.args[0],i.args[1]);break;case M.DrawPointType.Line:e.lineTo(i.args[0],i.args[1]);break;case M.DrawPointType.QuadraticCurve:e.quadraticCurveTo(i.args[0],i.args[1],i.args[2],i.args[3])}e.fillStyle=t.color,e.strokeStyle=t.color,e.closePath(),e.fill(),e.stroke()}animate(t){this.animations.handle(t.id,M.AnimationType.Init,{duration:T.Animations.circular+(this.data.values.indexOf(t)+1)/this.data.values.length*T.Animations.circular,continuous:!0,before:()=>t.state==M.AnimationType.Init,body:e=>{this.scale(t,.7,e),this.focus(t,1,1-e),1==e&&(t.state=M.AnimationType.None)}}),this.animations.handle(t.id,M.AnimationType.Click,{duration:0,before:()=>t.state==M.AnimationType.Click,body:e=>{this.translate(t,.1,1),this.outline(t,8,1)}}),this.animations.handle(t.id,M.AnimationType.MouseOver,{duration:T.Animations.circular,before:()=>t.state.isAnyEquals(M.AnimationType.MouseOver,M.AnimationType.MouseLeave),body:e=>{t.color!=t.baseColor&&this.focus(t,.5,e),this.translate(t,.1,e),this.outline(t,8,e),t.state==M.AnimationType.MouseLeave&&this.data.values.filter(t=>t.state==M.AnimationType.MouseOver).length>0&&this.animations.end(t.id,M.AnimationType.AnotherItemOver)}}),this.animations.handle(t.id,M.AnimationType.AnotherItemOver,{duration:T.Animations.circular,before:()=>t.state.isAnyEquals(M.AnimationType.AnotherItemOver,M.AnimationType.AnotherItemLeave),body:e=>{this.focus(t,.5,e)}})}handle(t){if(t.disabled)return;if(t.state==M.AnimationType.None&&!this.isInsideCircle)return;const e=this.isInsideSector(this.moveEvent,t,this.center),i=!!this.clickEvent&&this.isInsideSector(this.clickEvent,t,this.center);if(this.moveEvent&&e&&this.hover?.push(t.id),1!=this.data.values.filter(t=>!t.disabled).length){if(i)return t.state=M.AnimationType.Click,this.pinned.includes(t.id)?this.pinned=this.pinned.filter(e=>e!=t.id):this.pinned.push(t.id),void(this.clickEvent=void 0);if(!this.pinned.includes(t.id)){if(e)return t.state=M.AnimationType.MouseOver,void(this.animations.isBackward(t.id,M.AnimationType.MouseOver)&&this.animations.reverse(t.id,M.AnimationType.MouseOver));if(t.state==M.AnimationType.MouseOver&&!e)return t.state=M.AnimationType.MouseLeave,void(this.animations.isBackward(t.id,M.AnimationType.MouseOver)||this.animations.reverse(t.id,M.AnimationType.MouseOver));if(t.state==M.AnimationType.MouseLeave&&this.animations.isEnd(t.id,M.AnimationType.MouseOver))t.state=M.AnimationType.None;else if(t.state!=M.AnimationType.MouseLeave)return this.data.values.filter(t=>t.state==M.AnimationType.MouseOver).length>0?(t.state=M.AnimationType.AnotherItemOver,void(this.animations.isBackward(t.id,M.AnimationType.AnotherItemOver)&&this.animations.reverse(t.id,M.AnimationType.AnotherItemOver))):this.data.values.filter(t=>t.state==M.AnimationType.MouseLeave).length>0?(t.state=M.AnimationType.AnotherItemLeave,void(this.animations.isBackward(t.id,M.AnimationType.AnotherItemOver)||this.animations.reverse(t.id,M.AnimationType.AnotherItemOver))):void(t.state==M.AnimationType.AnotherItemLeave&&this.animations.isEnd(t.id,M.AnimationType.AnotherItemOver)&&(t.state=M.AnimationType.None))}}}render(){super.render();const t=this.data.values.filter(t=>t.value!=t.current&&0!=t.current).length>0;if(this.isMousePositionChanged=this.prevMousePos.x!=this.moveEvent.clientX||this.prevMousePos.y!=this.moveEvent.clientY,this.isMousePositionChanged){const t=this.getMousePosition(this.moveEvent);this.isInsideCircle=this.isWithinRadius({x:t.x-this.center.x,y:t.y-this.center.y})}if(this.prevMousePos={x:this.moveEvent.clientX,y:this.moveEvent.clientY},t){this.calculateAngles();for(let t of this.data.values)t=this.calculatePoint(t)}if(0==this.data.values.filter(t=>!t.disabled).length)return void this.empty();this.hover=[];const e=b.default.getContext(this.canvas);for(const t of this.data.values)this.animate(t),this.drawSector(t,e),this.drawLabel(t,e),t.state!=M.AnimationType.Init&&this.handle(t);super.renderDropdown();const i=this.data.values.find(t=>t.id==this.hover[0]),s=this.hover.length>0;s||this.contextMenu?this.renderContextMenu(i?.data??{}):this.menuEvent=void 0,this.tooltip.render(s&&!this.dropdown?.isActive,this.moveEvent,[new p.default(`${i?.label}: ${x.default.format(i?.current,M.PlotAxisType.Number,this.settings.valuePostfix)}`)],i),this.innerTitle(),this.canvas.style.cursor=s?P.default.Cursor.Pointer:P.default.Cursor.Default,this.isDestroy||requestAnimationFrame(this.render.bind(this))}isWithinRadius(t){return t.x*t.x+t.y*t.y<=this.radius*this.radius}isInsideSector(t,e,i){if(!this.isMousePositionChanged)return e.isMouseInside;const s=this.getMousePosition(t);return e.isMouseInside=(t=>{let s=Math.atan2(t.y-i.y,t.x-i.x);s<0&&(s+=2*Math.PI),s<this.startAngle&&(s=2*Math.PI-Math.abs(this.startAngle-s)+this.startAngle);let n=this.angles.findIndex(t=>t.id==e.id),a=this.angles[n].sum;return!this.dropdown?.isActive&&a<=s&&a+this.angles[n].value-s>=0})(s)&&this.isInsideCircle}empty(){const t=b.default.getContext(this.canvas);t.beginPath(),t.arc(this.center.x,this.center.y,this.radius,0,2*Math.PI),t.strokeStyle=c.default.text,t.stroke(),v.default.regular(t),t.fillText(y.default.allDataIsHidden,this.center.x,this.center.y),requestAnimationFrame(this.render.bind(this))}innerTitle(){if(this.canRenderInnerTitle){const t=b.default.getContext(this.canvas);this.innerTitleStyle(t),t.fillText(this.data.innerTitle,this.center.x,this.center.y)}}calculateSizes(){const t=this.settings.title?T.Values.titleOffset:0,e=this.canvas.width>this.canvas.height-2*t?this.canvas.height-2*t:this.canvas.width;this.center={x:this.canvas.width/2,y:t+this.canvas.height/2};let i=0;for(const t of this.data.values){const e=f.stringWidth(t.label);e>i&&(i=e)}this.radius=e/2-(i+50),this.radius<e/2-50&&(this.radius=e/2-50),null!=this.data.innerTitle&&""!=this.data.innerTitle&&(this.innerTitleStyle=v.default.large,this.canRenderInnerTitle=f.stringWidth(this.data.innerTitle,16)<this.data.innerRadius/100*this.radius*2,this.canRenderInnerTitle||(this.innerTitleStyle=v.default.regular,this.canRenderInnerTitle=f.stringWidth(this.data.innerTitle,14)<this.data.innerRadius/100*this.radius*2),this.canRenderInnerTitle||console.warn("Inner title is declared, but can't be rendered"))}refresh(){super.refresh(),this.dropdown?.refresh()}resize(){super.resize(),this.initAnimations(),this.calculateSizes(),this.dropdown?.resize();for(let t of this.data.values)t.canRenderLabel=void 0,t=this.calculatePoint(t)}prepareSettings(){super.prepareSettings(),this.calculateSizes(),this.data.values=this.data.values.map(t=>new d.default(t)),this.settings.enableOther&&(this.settings.contextMenu?this.settings.contextMenu.push({isDivider:!0}):this.settings.contextMenu=[],this.settings.contextMenu.push({text:y.default.show,condition:t=>t?._other,action:()=>{new w.default(g.default.toChart(this.settings,this.other),{width:.8*window.innerWidth,height:.8*window.innerHeight},y.default.other).open()}})),this.pinned=[],this.isDonut=0!=(this.data.innerRadius??0);for(let t of this.data.values)t.disabled=!t.value,t.value??=0,t.current=t.value,t.innerRadius??=this.data.innerRadius??0,t.value<0&&console.warn(`"${t.label}" has negative value (${t.value}) and will not be render`);if(this.data.values=this.data.values.filter(t=>t.value>=0),this.settings.enableOther&&this.data.values.length>20){this.other=this.data.values.splice(20);const t=this.other.sum(t=>t.current);this.data.values=this.data.values.slice(0,20),this.data.values.push(new d.default({value:t,current:t,label:y.default.other,id:f.guid(),color:this.other[this.other.length-1].color,innerRadius:this.data.innerRadius,data:{_other:!0}}))}this.calculateAngles();for(let t of this.data.values)t=this.calculatePoint(t),t.textColor=c.default.text,t.state=this.settings.disableInitAnimation?M.AnimationType.None:M.AnimationType.Init}initDropdown(){super.initDropdown(),this.dropdown=new u.default(this.canvas,{x:-10,y:10,icon:M.Icon.ThreeLines,items:[{text:y.default.exportPNG,action:()=>{m.default.asPng(this.canvas,this.settings.title)}},{text:y.default.exportCSV,action:()=>{m.default.asCsv(g.default.toTable(l.default.getRows(this.data)),this.settings.title)}},{isDivider:!0},{text:y.default.decomposeToTable,action:()=>{new w.default(g.default.toTable(l.default.getRows(this.data)),void 0,this.settings.title??y.default.dataAsTable).open()}}]})}}e.default=A},459:function(t,e,i){var s,n,a,o=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),h=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&o(e,t,i[n]);return r(e,t),e}),l=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},d=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const f=d(i(688)),u=h(i(10)),c=d(i(927)),v=d(i(359)),p=d(i(147)),g=d(i(168)),m=d(i(601)),y=i(869),w=h(i(797));class b extends f.default{constructor(t){super(t),n.add(this),this.isDestroy=!1,this.highlightItems=[],this.state=this.settings.disableInitAnimation?y.RenderState.Idle:y.RenderState.Init}render(){super.render(),this.renderTitle()}destroy(){this.isDestroy=!0,this.canvas.remove()}renderDropdown(){this.clickEvent=this.dropdown?.render(this.moveEvent,this.clickEvent)}resize(){l(this,n,"m",a).call(this),this.tooltip.refresh(),this.dropdown?.resize()}prepareSettings(){this.data=this.settings.data;const t=this.node.parentElement.getBoundingClientRect();this.settings.minWidth=isNaN(+this.settings.width)?0:+this.settings.width,this.settings.minHeight=isNaN(+this.settings.height)?0:+this.settings.height,this.settings.width=0!=this.settings.minWidth&&t.width<this.settings.minWidth?this.settings.minWidth:t.width,this.settings.height=0!=this.settings.minHeight&&t.height<this.settings.minHeight?this.settings.minHeight:t.height,this.canvas.width=this.settings.width,this.canvas.height=this.settings.height;for(let t of this.settings.data.values)t.id=u.guid(),t.label??=p.default.noLabel;this.calculateColors();for(let t of this.settings.contextMenu??[])null!=t.id&&(t.action=e=>this.node.dispatchEvent(new CustomEvent(t.id??"",{detail:e})))}calculateColors(t=!1){const e=u.adjustColor(this.settings.baseColor??u.randomColor(),-67);let i=0;for(let s of this.settings.data.values){if(null==s.color||t){let t=Math.round(i/this.settings.data.values.length*134);s.color=u.adjustColor(e,t)}i++}}initDropdown(){}renderContextMenu(t){if(this.dropdown?.isActive)return this.menuEvent=void 0,!1;if(null!=this.menuEvent&&0!=this.settings.contextMenu?.length){if(null==this.contextMenu&&null!=this.settings.contextMenu){let e=[];for(const i of this.settings.contextMenu)i.condition&&!i.condition(t)||e.push({id:i.id,text:i.text,isDivider:i.isDivider,action:()=>{i.action(t),this.menuEvent=void 0,this.contextMenu=void 0}});this.contextMenu=new v.default(this.canvas,{x:this.menuEvent.x-this.canvasPosition.x,y:this.menuEvent.y-this.canvasPosition.y,items:e,data:t}),this.contextMenu.resize(),this.clickEvent=void 0}const e=null!=this.clickEvent;if(this.clickEvent=this.contextMenu?.render(this.moveEvent,this.clickEvent),null==this.clickEvent&&e)return this.contextMenu=void 0,this.menuEvent=void 0,!0}return!1}highlight(t){this.highlightItems=t?[t.id]:[]}closeDropdowns(){this.dropdown?.close(),this.menuEvent=void 0}renderTitle(){const t=g.default.getContext(this.canvas);this.settings.title&&(m.default.title(t),t.fillText(this.settings.title,this.canvas.width/2,w.Values.titleOffset))}getMousePosition(t){return{x:t.clientX-this.canvasPosition.x+scrollX,y:t.clientY-this.canvasPosition.y+scrollY}}applySettings(t){this.settings=t}}n=new WeakSet,a=function(){let t=this.node.getBoundingClientRect();this.settings.width=this.settings.minWidth&&t.width<this.settings.minWidth?this.settings.minWidth:t.width,this.settings.height=this.settings.minHeight&&t.height<this.settings.minHeight?this.settings.minHeight:t.height,this.canvas.width=this.settings.width,this.canvas.height=this.settings.height,this.settings.enableLegend&&(null!=this.settings.legendPlace&&this.settings.legendPlace!=y.LegendPlace.Top&&this.settings.legendPlace!=y.LegendPlace.Bottom||(this.canvas.height-=c.default.getLegendHeight(this.settings.data.values,this.canvas.width)),this.settings.legendPlace!=y.LegendPlace.Left&&this.settings.legendPlace!=y.LegendPlace.Right||(this.canvas.width-=500))},e.default=b},495:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{static getRows(t){const e="Value";let i=[];for(const s of t.values)i.push({name:s.label,values:new Map([[e,s.value]])});return{headers:[{value:e,display:e}],values:i}}}},510:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{static getRows(t){const e="Value";let i=[];for(const s of t.values)i.push({name:s.label,values:new Map([[e,s.value]])});return{headers:[{value:e,display:e}],values:i}}}},527:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{toggle(t){0==t&&(this.disabled=!this.disabled)}checkCondition(){return!1}reset(){this.disabled=!1}}},557:function(t,e,i){var s,n,a,o,r,h,l,d,f,u,c,v,p,g,m,y,w,b,x,M,T,P=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),_=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),A=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&P(e,t,i[n]);return _(e,t),e}),O=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},S=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},C=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const D=C(i(268)),k=C(i(459)),E=A(i(10)),I=C(i(359)),j=C(i(902)),L=C(i(183)),R=C(i(409)),W=C(i(601)),B=C(i(12)),N=C(i(804)),F=C(i(743)),$=C(i(897)),H=C(i(147)),z=C(i(828)),V=C(i(168)),q=i(869),G=A(i(797));class Y extends k.default{constructor(t){super(t),n.add(this),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),h.set(this,void 0),l.set(this,void 0),d.set(this,void 0),f.set(this,void 0),u.set(this,void 0),c.set(this,void 0),v.set(this,void 0),p.set(this,void 0),g.set(this,void 0),m.set(this,void 0),y.set(this,void 0)}render(){super.render();let t=[new B.default(O(this,d,"f").get(Math.round(O(this,h,"f")))??O(this,f,"f").get(Math.round(O(this,l,"f"))))];const e=V.default.getContext(this.canvas);W.default.regular(e),e.lineJoin="round";const i=R.default.lineActive;O(this,n,"m",M).call(this),O(this,n,"m",x).call(this,!0);let s=0,v=0,p=0,g=0,T=0;const P=this.data.values.filter(t=>!t.disabled);let _=0,A=P.filter(t=>t.type==q.PlotType.Column).length,C=0,D=P.filter(t=>t.type==q.PlotType.Bar).length,k=[];for(let t=0;t<O(this,c,"f").length;t++)k.push(0);for(const d of P){e.beginPath(),e.strokeStyle=d.color,e.fillStyle=d.color,e.lineWidth=d.width,e.lineCap="round";const f=0!=this.highlightItems.length;if(!this.animations.contains(d.id,q.AnimationType.Init)){const t=(t,i)=>{if(this.animations.reload(d.id,i),0==t)return;let s=Math.round(255-127*t).toString(16);s.length<2&&(s=0+s),e.fillStyle=d.color+s,e.strokeStyle=d.color+s};f&&!this.highlightItems.includes(d.id)?this.animations.handle(d.id,q.AnimationType.AnotherItemOver,{duration:G.Animations.circular,body:e=>{t(e,q.AnimationType.AnotherItemLeave)}}):f||this.animations.handle(d.id,q.AnimationType.AnotherItemLeave,{timer:G.Dates.minDate,duration:G.Animations.circular,backward:!0,body:e=>{t(e,q.AnimationType.AnotherItemOver)}})}switch(d.lineType){case q.LineType.Dash:e.setLineDash([3*d.width,2*d.width]);break;case q.LineType.Dotted:e.setLineDash([d.width,d.width]);case q.LineType.Solid:}for(const i of d.values){let x=d.values.indexOf(i),M=O(this,u,"f").indexOf(this.data.xType==q.PlotAxisType.Date?i.x?.toString():i.x),P=O(this,c,"f").indexOf(i.y);const E=()=>({x:z.default.format(i.x,this.data.xType),y:z.default.format(i.y,this.data.xType,this.settings.valuePostfix)});switch(s=O(this,r,"f").left,d.type!=q.PlotType.Bar&&(s+=M*O(this,a,"f").step),d.type==q.PlotType.Line&&(s-=O(this,a,"f").step/2-O(this,a,"f").step),d.type){case q.PlotType.Line:v=O(this,r,"f").top+O(this,m,"f").height-i.y/O(this,o,"f").unit*O(this,o,"f").step-Math.abs(O(this,o,"f").min/O(this,o,"f").unit*O(this,o,"f").step);const u=1500/d.values.length*1.2;if(this.state==q.RenderState.Init||this.animations.contains(i.id,q.AnimationType.Init))this.animations.handle(i.id,q.AnimationType.Init,{timer:new Date(Date.now()).addMilliseconds(u*(x-1)),duration:u,continuous:!0,body:t=>{if(0==x)return;s=O(this,r,"f").left+M*O(this,a,"f").step-O(this,a,"f").step/2,v=O(this,r,"f").top+O(this,m,"f").height-i.y/O(this,o,"f").unit*O(this,o,"f").step-Math.abs(O(this,o,"f").min/O(this,o,"f").unit*O(this,o,"f").step);const n=d.values[x-1];let h={x:O(this,r,"f").left+M*O(this,a,"f").step-O(this,a,"f").step/2,y:O(this,r,"f").top+O(this,m,"f").height-n.y/O(this,o,"f").unit*O(this,o,"f").step-Math.abs(O(this,o,"f").min/O(this,o,"f").unit*O(this,o,"f").step)};const l=h.x+(O(this,a,"f").step+(s-h.x))*t,f=h.y+(v-h.y)*t;h.x!=l&&h.y!=f&&(e.moveTo(h.x,h.y),e.lineTo(l,f))}});else if(e.lineTo(s,v),O(this,n,"m",w).call(this,s)){const e=this.getMousePosition(this.moveEvent);Math.abs(e.y-v)<5&&(S(this,y,{x:s,y:v,index:x,data:i.data,series:d},"f"),t.push(new B.default(`${d.label}: ${E().y}`,d.color)),S(this,h,s-O(this,a,"f").step/2,"f"))}break;case q.PlotType.AttentionLine:p=this.canvas.height-O(this,r,"f").bottom-i.y/O(this,o,"f").unit*O(this,o,"f").step,e.moveTo(O(this,r,"f").left,p),this.state==q.RenderState.Init||this.animations.contains(i.id,q.AnimationType.Init)?this.animations.handle(i.id,q.AnimationType.Init,{duration:1500,continuous:!0,body:t=>{e.lineTo(O(this,r,"f").left+(this.canvas.width-O(this,r,"f").left-O(this,r,"f").right)*t,this.canvas.height-O(this,r,"f").bottom-i.y/O(this,o,"f").unit*O(this,o,"f").step)}}):e.lineTo(this.canvas.width-O(this,r,"f").right,p);break;case q.PlotType.Column:p=i.y>this.data.yMax?this.data.yMax:i.y,v=O(this,m,"f").height*p/O(this,o,"f").max,v<O(this,o,"f").minStep&&(v=O(this,o,"f").minStep),T=O(this,a,"f").step*(d.width?d.width/100:.5)/A,e.beginPath(),this.state==q.RenderState.Init||this.animations.contains(i.id+_,q.AnimationType.Init)?this.animations.handle(i.id+_,q.AnimationType.Init,{duration:800,continuous:!0,body:t=>{p=i.y>this.data.yMax?this.data.yMax:i.y,s=O(this,r,"f").left+M*O(this,a,"f").step,v=O(this,m,"f").height*p/O(this,o,"f").max*t,v<O(this,o,"f").minStep&&(v=O(this,o,"f").minStep*t),_=this.data.values.filter(t=>t.type==q.PlotType.Column).indexOf(d),e.roundRect(s+_*T+(O(this,a,"f").step-A*T)/2,this.canvas.height-O(this,r,"f").bottom-v,T,v,[6,6,0,0]),e.fill()}}):(!O(this,n,"m",b).call(this,s+_*T+(O(this,a,"f").step-A*T)/2,this.canvas.height-O(this,r,"f").bottom-v,T,v)||null!=this.contextMenu?.isActive&&0!=this.contextMenu?.isActive||(S(this,y,{x:s,y:v,index:x,data:i.data,series:d},"f"),t.push(new B.default(`${d.label}: ${E().y}`,d.color)),S(this,h,s,"f")),e.roundRect(s+_*T+(O(this,a,"f").step-A*T)/2,this.canvas.height-O(this,r,"f").bottom-v,T,v,[6,6,0,0]),e.fill());break;case q.PlotType.Bar:v=O(this,r,"f").top+P*O(this,o,"f").step+O(this,o,"f").step/2+(100-d.width)*O(this,o,"f").step/100/2;const c=d.width*O(this,o,"f").step/100/D;this.state==q.RenderState.Init||this.animations.contains(i.id+C,q.AnimationType.Init)?this.animations.handle(i.id+C,q.AnimationType.Init,{duration:800,continuous:!0,body:t=>{v=O(this,r,"f").top+P*O(this,o,"f").step+O(this,o,"f").step/2+(100-d.width)*O(this,o,"f").step/100/2,C=this.data.values.filter(t=>t.type==q.PlotType.Bar).indexOf(d),e.fillRect(s,v-O(this,o,"f").step/2+C*c,i.x/O(this,a,"f").unit*O(this,a,"f").step*t,c)}}):(f||(O(this,n,"m",b).call(this,s,v-O(this,o,"f").step/2+C*c,i.x/O(this,a,"f").unit*O(this,a,"f").step,c)?(S(this,y,{x:s,y:v,index:x,data:i.data,series:d},"f"),e.fillStyle+="88",t.push(new B.default(`${d.label}: ${E().x}`,d.color)),S(this,l,v-O(this,o,"f").step/2,"f")):e.fillStyle=d.color),e.fillRect(s,v-O(this,o,"f").step/2+C*c,i.x/O(this,a,"f").unit*O(this,a,"f").step,c));break;case q.PlotType.StackingColumn:if(v=this.canvas.height-O(this,r,"f").bottom-i.y/O(this,o,"f").unit*O(this,o,"f").step,T=O(this,a,"f").step*(d.width?d.width/100:.5),this.state==q.RenderState.Init||this.animations.contains(i.id+x,q.AnimationType.Init))this.animations.handle(i.id+x,q.AnimationType.Init,{duration:800,continuous:!0,body:t=>{_=this.data.values.filter(t=>t.type==q.PlotType.StackingColumn&&t.values.filter(t=>this.data.xType==q.PlotAxisType.Date?t.x.getTime()==i.x.getTime():t.x==i.x).length>0).indexOf(d),s=O(this,r,"f").left+M*O(this,a,"f").step,v=this.canvas.height-O(this,r,"f").bottom-i.y/O(this,o,"f").unit*O(this,o,"f").step,0==_&&(k[M]=0);let n=null!=k[M]?k[M]:0;p=this.canvas.height-O(this,r,"f").bottom+n,g=(v-this.canvas.height+O(this,r,"f").bottom)*t,p>O(this,r,"f").top&&(p+g<O(this,r,"f").top&&(g-=p+g-O(this,r,"f").top),e.fillRect(s+(O(this,a,"f").step-T)/2,p,T,g)),k[M]+=(v-this.canvas.height+O(this,r,"f").bottom)*t}});else{0==_&&(k[M]=0);let o=null!=k[M]?k[M]:0;p=this.canvas.height-O(this,r,"f").bottom+o,g=v-this.canvas.height+O(this,r,"f").bottom,p>O(this,r,"f").top&&(p+g<O(this,r,"f").top&&(g-=p+g-O(this,r,"f").top),O(this,n,"m",b).call(this,s+(O(this,a,"f").step-T)/2,p+g,T,Math.abs(g))&&(S(this,y,{x:s,y:v,index:M,data:i.data,series:d},"f"),t.push(new B.default(`${d.label}: ${E().y}`,d.color)),S(this,h,s,"f")),e.fillRect(s+(O(this,a,"f").step-T)/2,p,T,g)),k[M]+=v-this.canvas.height+O(this,r,"f").bottom}}}switch(e.setLineDash([]),d.type){case q.PlotType.Line:if(e.stroke(),O(this,y,"f")&&O(this,y,"f").series==d){e.beginPath(),e.lineWidth=1,e.strokeStyle=i,e.moveTo(O(this,r,"f").left,O(this,y,"f").y),e.lineTo(this.canvas.width-O(this,r,"f").right,O(this,y,"f").y),e.stroke();let t=Math.round(1.1*d.width);t<5&&(t=5),e.beginPath(),e.arc(O(this,y,"f").x,O(this,y,"f").y,t,0,2*Math.PI),e.fill(),e.lineWidth=Math.ceil(t/2),e.strokeStyle=E.adjustColor(d.color,50),e.stroke()}break;case q.PlotType.AttentionLine:e.stroke(),W.default.regular(e),e.fillText(d.label,O(this,r,"f").left+(this.canvas.width-O(this,r,"f").left-O(this,r,"f").right)/2,this.canvas.height-O(this,r,"f").bottom-d.values[0].y/O(this,o,"f").unit*O(this,o,"f").step+16);break;case q.PlotType.Column:case q.PlotType.StackingColumn:O(this,y,"f")&&this.highlight(O(this,y,"f").series),_++;break;case q.PlotType.Bar:O(this,y,"f")&&(e.lineWidth=1,e.strokeStyle=i,e.moveTo(O(this,r,"f").left,O(this,l,"f")+O(this,o,"f").step/2),e.lineTo(this.canvas.width-O(this,r,"f").right,O(this,l,"f")+O(this,o,"f").step/2),e.stroke()),C++}}O(this,n,"m",x).call(this),this.renderTitle(),this.tooltip.render(t.length>1&&!this.dropdown?.isActive,this.moveEvent,t,O(this,y,"f")?O(this,y,"f").series.values[O(this,y,"f").index]:void 0),this.isDestroy||requestAnimationFrame(this.render.bind(this)),this.state=q.RenderState.Idle,super.renderDropdown(),this.menuEvent&&!O(this,y,"f")&&(this.menuEvent=void 0),null==O(this,y,"f")&&this.highlight(),!O(this,y,"f")||!this.renderContextMenu(O(this,y,"f").data)&&this.menuEvent||S(this,y,void 0,"f")}refresh(){super.refresh()}resize(){super.resize(),S(this,v,void 0,"f"),O(this,n,"m",T).call(this)}prepareSettings(){if(super.prepareSettings(),S(this,v,void 0,"f"),S(this,p,void 0,"f"),this.data.values=this.data.values.map(t=>new j.default(t)),this.data.values.filter(t=>t.type==q.PlotType.Bar).length>0)for(let t of this.data.values){for(let e of t.values){const t=e.x;e.x=e.y,e.y=t}t.values.sort((t,e)=>e.x>t.x?1:-1)}for(let t of this.data.values){t.disabled=!t.values,t.type??=q.PlotType.Line;for(let e of t.values)e.id=E.guid(),this.data.xType==q.PlotAxisType.Date&&(E.isISOString(e.x)?e.x=new Date(e.x):console.warn(`${e.x} is not a date in ISO format.`))}S(this,r,{top:30,right:40,bottom:50,left:80},"f"),this.data.simple&&S(this,r,{top:10,right:10,bottom:10,left:10},"f"),this.settings.title&&(O(this,r,"f").top+=G.Values.titleOffset),this.tooltip=new L.default(this.canvas,this.settings),S(this,d,new Map,"f"),S(this,f,new Map,"f")}initDropdown(){super.initDropdown(),this.data.simple?this.dropdown=void 0:this.dropdown=new I.default(this.canvas,{x:-10,y:10,icon:q.Icon.ThreeLines,items:[{text:H.default.exportPNG,action:()=>{N.default.asPng(this.canvas,this.settings.title)}},{text:H.default.exportCSV,action:()=>{N.default.asCsv(F.default.toTable(D.default.getRows(this.data)),this.settings.title)}},{isDivider:!0},{text:H.default.decomposeToTable,action:()=>{new $.default(F.default.toTable(D.default.getRows(this.data)),void 0,this.settings.title??H.default.dataAsTable).open()}}]})}}a=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,l=new WeakMap,d=new WeakMap,f=new WeakMap,u=new WeakMap,c=new WeakMap,v=new WeakMap,p=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakMap,n=new WeakSet,w=function(t){if(!this.moveEvent)return!1;const e=this.getMousePosition(this.moveEvent);return!this.dropdown?.isActive&&t-O(this,a,"f").step/2<=e.x&&e.x<t+O(this,a,"f").step/2&&O(this,r,"f").top<=e.y&&e.y<=this.canvas.height-O(this,r,"f").bottom&&O(this,r,"f").left<e.x},b=function(t,e,i,s){if(!this.moveEvent)return!1;const n=this.getMousePosition(this.moveEvent);return!this.dropdown?.isActive&&n.x>=t&&n.x<=t+i&&n.y>=e&&n.y<=e+s},x=function(t=!1){if(O(this,v,"f")&&t)return;if(this.data.simple)return;const e=V.default.getContext(this.canvas);if(t&&e.clearRect(0,0,this.canvas.width,this.canvas.height),O(this,v,"f"))return void e.drawImage(O(this,v,"f"),0,0);if(!t)return;e.fillStyle=R.default.canvasBackground,e.fillRect(0,0,O(this,r,"f").left,this.canvas.height),e.fillRect(0,0,this.canvas.width,O(this,r,"f").top),e.fillRect(this.canvas.width-O(this,r,"f").right,0,this.canvas.width,this.canvas.height),e.fillRect(0,this.canvas.height-O(this,r,"f").bottom,this.canvas.width,this.canvas.height);const i=this.data.values.filter(t=>t.type==q.PlotType.Bar).length>0;e.setLineDash([]),(this.data.xTitle||this.data.yTitle)&&(e.textAlign="center",e.textBaseline="bottom",e.fillStyle=R.default.text,this.data.xTitle&&e.fillText(this.data.xTitle,O(this,r,"f").left+(this.canvas.width-O(this,r,"f").left-O(this,r,"f").right)/2,this.canvas.height-4),this.data.yTitle&&(e.rotate(-Math.PI/2),e.textBaseline="top",e.fillText(this.data.yTitle,-(O(this,r,"f").top+(this.canvas.height-O(this,r,"f").top-O(this,r,"f").bottom)/2),8),e.resetTransform())),e.textAlign="center",e.textBaseline="top";const s=O(this,a,"f").step,n=this.canvas.height-O(this,r,"f").bottom;let h=0,l=O(this,r,"f").left+s/2;for(let t=0;t<O(this,u,"f").length+1;t++)O(this,d,"f").trySet(Math.round(O(this,r,"f").left+t*O(this,a,"f").step),z.default.format(O(this,u,"f")[t],this.data.xType));const p=Math.max(...[...O(this,d,"f").values()].map(t=>Math.ceil(E.stringWidth(t))))+10,m=Math.floor((this.canvas.width-O(this,r,"f").left-O(this,r,"f").right)/p),y=Math.ceil(1/(m/O(this,u,"f").length));for(;l<this.canvas.width-O(this,r,"f").right;)h%y==0&&(e.fillStyle=R.default.text+"b7",e.fillText((O(this,d,"f").get(Math.round(l-O(this,a,"f").step/2))??"")+(i?this.settings.valuePostfix:""),l,n+6)),l+=s,h++;e.textAlign="right",e.textBaseline="middle";const w=O(this,o,"f").count>10?10:O(this,o,"f").count;let b=i?1:0,x=O(this,c,"f").length/w;for(let t=i?1:0;t<O(this,c,"f").length+1;t++){const s=this.canvas.height-b*x*O(this,o,"f").step-O(this,r,"f").bottom,n=Math.round(this.canvas.height-t*O(this,o,"f").step-O(this,r,"f").bottom);if(O(this,f,"f").get(n)||O(this,f,"f").set(n,z.default.format(O(this,o,"f").min+(t+(i?-1:0))*(O(this,o,"f").max-O(this,o,"f").min)/O(this,o,"f").count,q.PlotAxisType.Number,this.settings.valuePostfix)),t>=b*x){const t={x:O(this,r,"f").left,y:s,label:O(this,g,"f")>=1?Math.round((O(this,o,"f").min+(b*x+(i?-1:0))*(O(this,o,"f").max-O(this,o,"f").min)/O(this,o,"f").count)/O(this,g,"f"))*O(this,g,"f"):Math.round(O(this,o,"f").min+(b*x+(i?-1:0))*(O(this,o,"f").max-O(this,o,"f").min)/O(this,o,"f").count/O(this,g,"f"))*O(this,g,"f")};-0==t.label&&(t.label=0);let n="";if(this.data.shortLabels){const e=Math.floor(t.label.toString().length/4);e>0&&(t.label/=Math.pow(1e3,e),n=[H.default.thousandShort,H.default.millionShort,H.default.billionShort][e-1])}e.fillText(z.default.number(t.label)+n+(i?"":this.settings.valuePostfix??""),t.x-12,t.y+(i?O(this,o,"f").step/2:0)),b++}}e.beginPath(),e.strokeStyle=R.default.line,e.lineWidth=1;const M=.5,T=this.data.values.filter(t=>t.type==q.PlotType.Bar).length>0;e.moveTo(O(this,r,"f").left-(T?M:0),this.canvas.height-O(this,r,"f").bottom+(T?-.5:M)),T?e.lineTo(O(this,r,"f").left-M,O(this,r,"f").top):e.lineTo(this.canvas.width-O(this,r,"f").right,this.canvas.height-O(this,r,"f").bottom+M),e.stroke(),this.canvas.width>0&&this.canvas.height>0&&createImageBitmap(e.getImageData(0,0,this.canvas.width,this.canvas.height)).then(t=>S(this,v,t,"f"))},M=function(){if(this.data.simple)return;const t=V.default.getContext(this.canvas);if(O(this,p,"f"))return void t.putImageData(O(this,p,"f"),0,0);t.fillStyle=R.default.canvasBackground,t.fillRect(0,0,this.canvas.width,this.canvas.height);const e=R.default.lineAxis,i=this.data.values.filter(t=>t.type==q.PlotType.Bar).length>0;if(i){const i=O(this,a,"f").step,s=this.canvas.height-O(this,r,"f").bottom;let n=0,o=O(this,r,"f").left+i/2;for(let t=0;t<O(this,u,"f").length+1;t++)O(this,d,"f").trySet(Math.round(O(this,r,"f").left+t*O(this,a,"f").step),z.default.format(O(this,u,"f")[t-1],this.data.xType));const h=Math.max(...[...O(this,d,"f").values()].map(t=>Math.ceil(E.stringWidth(t))))+10,l=Math.floor((this.canvas.width-O(this,r,"f").left-O(this,r,"f").right)/h),f=Math.ceil(1/(l/O(this,u,"f").length));for(;o<this.canvas.width-O(this,r,"f").right;)n%f==0&&(t.beginPath(),t.moveTo(o,s),t.lineTo(o,O(this,r,"f").top),t.lineWidth=1,t.strokeStyle=e,t.setLineDash([6,6]),t.stroke()),o+=i,n++}t.textAlign="right",t.textBaseline="middle";const s=O(this,o,"f").count>10?10:O(this,o,"f").count;let n=i?1:0,h=O(this,c,"f").length/s;for(let s=i?1:0;s<O(this,c,"f").length+1;s++){const i=this.canvas.height-n*h*O(this,o,"f").step-O(this,r,"f").bottom;if(s>=n*h){const s={x:O(this,r,"f").left,y:i};this.data.values.filter(t=>t.type.isAnyEquals(q.PlotType.Column,q.PlotType.StackingColumn,q.PlotType.Line)).length>0&&(t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(this.canvas.width-O(this,r,"f").right,s.y),t.lineWidth=1,t.strokeStyle=e,t.setLineDash([6,6]),t.stroke()),n++}}this.canvas.width>0&&this.canvas.height>0&&S(this,p,t.getImageData(0,0,this.canvas.width,this.canvas.height),"f")},T=function(){let t=this.data.values.flatMap(t=>t.values.map(t=>t.x)),e=this.data.values.flatMap(t=>t.values.map(t=>t.y));const i=this.data.xType==q.PlotAxisType.Date;if(i){let e=new Date(Math.min(...t));for(;e.getTime()<Math.max(...t);)t.includes(e.getTime())||t.push(new Date(e.getTime())),e=e.addDays(1);t.sort((t,e)=>t<e?-1:1)}e.sort((t,e)=>e>t?-1:1),S(this,u,[...new Set(t.filter(t=>null!=t).map(t=>i?t.toString():t))],"f"),S(this,c,[...new Set(e.filter(t=>null!=t))],"f"),S(this,a,{min:Math.min(...t),max:Math.max(...t),unit:(Math.abs(Math.min(...t))+Math.abs(Math.max(...t)))/(O(this,u,"f").length-1),step:(this.canvas.width-O(this,r,"f").left-O(this,r,"f").right)/O(this,u,"f").length,minStep:0,count:O(this,u,"f").length},"f");let s=Math.min(...e);s>0&&(s=0),S(this,o,{min:s,max:this.data.yMax??Math.max(...e),unit:(Math.abs(s)+Math.abs(this.data.yMax??Math.max(...e)))/(O(this,c,"f").length-1),step:(this.canvas.height-O(this,r,"f").top-O(this,r,"f").bottom)/O(this,c,"f").length,minStep:0,count:O(this,c,"f").length},"f");let n,h=this.data.values.filter(t=>t.type==q.PlotType.StackingColumn);if(h.length>0){let t=h.map(t=>t.values.flatMap(t=>+t.y));n=O(this,o,"f").max;for(let e=0;e<t[0].length;e++){let i=0;for(const s of t)i+=s[e];i>n&&(n=i)}O(this,o,"f").max=n>this.data.yMax?this.data.yMax:n,O(this,o,"f").unit=(Math.abs(O(this,o,"f").min)+Math.abs(O(this,o,"f").max))/(O(this,c,"f").length-1)}const l=E.stringWidth(z.default.number(O(this,o,"f").max));l>O(this,r,"f").left-40&&!this.data.simple&&(O(this,r,"f").left+=l-O(this,r,"f").left+40,O(this,a,"f").step=(this.canvas.width-O(this,r,"f").left-O(this,r,"f").right)/O(this,u,"f").length),S(this,g,Math.abs(O(this,o,"f").min)+Math.abs(O(this,o,"f").max),"f"),.5<=O(this,g,"f")&&O(this,g,"f")<1?S(this,g,.05,"f"):1<=O(this,g,"f")&&O(this,g,"f")<10?S(this,g,.1,"f"):10<=O(this,g,"f")&&O(this,g,"f")<100?S(this,g,2,"f"):100<=O(this,g,"f")&&O(this,g,"f")<1e3?S(this,g,20,"f"):1e3<=O(this,g,"f")&&O(this,g,"f")<1e4?S(this,g,50,"f"):1e4<=O(this,g,"f")&&O(this,g,"f")<1e5?S(this,g,1e3,"f"):1e5<=O(this,g,"f")&&O(this,g,"f")<1e6?S(this,g,1e4,"f"):1e6<=O(this,g,"f")&&O(this,g,"f")<1e7?S(this,g,5e4,"f"):S(this,g,1,"f"),1!=O(this,g,"f")&&(n=e.length>10?10*(O(this,o,"f").max/10+O(this,g,"f")-O(this,o,"f").max/10%O(this,g,"f")):Math.ceil(O(this,o,"f").max/O(this,g,"f"))*O(this,g,"f"),O(this,o,"f").max=n>this.data.yMax?this.data.yMax:n,O(this,o,"f").unit=(Math.abs(O(this,o,"f").min)+Math.abs(O(this,o,"f").max))/O(this,c,"f").length),S(this,m,{width:this.canvas.width-O(this,r,"f").left-O(this,r,"f").right,height:this.canvas.height-O(this,r,"f").top-O(this,r,"f").bottom},"f"),O(this,a,"f").minStep=.002*O(this,m,"f").width,O(this,o,"f").minStep=.002*O(this,m,"f").height},e.default=Y},572:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Dates=void 0;class i{}e.Dates=i,i.minDate=new Date(2e3,1,1)},601:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=s(i(409));e.default=class{static title(t){t.fillStyle=n.default.text,t.textAlign="center",t.textBaseline="middle",t.font="20px sans-serif"}static regular(t){t.fillStyle=n.default.text,t.textAlign="center",t.textBaseline="middle",t.font="14px sans-serif"}static large(t){t.fillStyle=n.default.text,t.textAlign="center",t.textBaseline="middle",t.font="16px sans-serif"}static tooltip(t){t.font="14px sans-serif",t.textAlign="start",t.textBaseline="alphabetic"}static circularLabel(t,e){t.textAlign=e?"start":"end",t.textBaseline="alphabetic",t.font="14px sans-serif"}}},688:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=s(i(5)),a=s(i(183)),o=s(i(168)),r=i(869),h=s(i(283)),l=s(i(409));e.default=class{constructor(t){this.state=r.RenderState.Init,this.node=t.node,this.settings=t.settings,this.animations=new n.default,this.canvas=document.createElement(r.Tag.Canvas),this.canvas.style.imageRendering=h.default.ImageRendering.Pixelated,this.node.append(this.canvas),this.initAnimations()}render(){const t=o.default.getContext(this.canvas);t.fillStyle=l.default.canvasBackground,t.fillRect(0,0,this.canvas.width,this.canvas.height)}refresh(){this.tooltip.refresh(),this.state=this.settings.disableInitAnimation?r.RenderState.Idle:r.RenderState.Init}resetMouse(){this.moveEvent=new MouseEvent(r.Events.MouseMove),this.clickEvent=new MouseEvent(r.Events.Click),this.menuEvent=void 0}initAnimations(){this.tooltip=new a.default(this.canvas,this.settings),this.canvasPosition=this.canvas.getBoundingClientRect(),this.canvasPosition.x+=scrollX,this.canvasPosition.y+=scrollY,this.state!=r.RenderState.Init||this.settings.disableInteractions||(this.canvas.onmousemove=t=>this.moveEvent=t,this.canvas.onclick=t=>this.clickEvent=t,this.canvas.oncontextmenu=t=>{t.preventDefault(),this.contextMenu=void 0,this.menuEvent?this.menuEvent=void 0:this.menuEvent=t},this.canvas.onmouseleave=()=>this.moveEvent=new MouseEvent(r.Events.MouseMove))}destroy(){this.canvas.remove()}}},690:function(t,e,i){var s,n,a,o,r=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),h=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),l=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&r(e,t,i[n]);return h(e,t),e}),d=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},f=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const u=f(i(495)),c=f(i(459)),v=f(i(138)),p=l(i(10)),g=f(i(359)),m=f(i(601)),y=f(i(12)),w=f(i(804)),b=f(i(743)),x=f(i(897)),M=f(i(147)),T=f(i(168)),P=f(i(828)),_=i(869),A=l(i(797));class O extends c.default{constructor(t){super(t),n.add(this),this.settings.enableLegend=!1}render(){if(super.render(),0==this.data.values.filter(t=>t.value>0).length)return d(this,n,"m",o).call(this),void requestAnimationFrame(this.render.bind(this));const t=this.settings.title?A.Values.titleOffset:0,e=this.canvas.width-2*this.data.padding,i=this.canvas.height-2*this.data.padding-t;let s,r,h=this.data.values.sum(t=>t.value),l=e*i,f=this.data.padding,u=this.data.padding+t,c=this.data.padding,v=this.data.padding+t;const g=T.default.getContext(this.canvas);let w=!0;for(let o=0;o<this.data.values.length;o++){const y=this.data.values[o],b=e-(f-this.data.padding),x=i-(u-this.data.padding-t);let M=[{color:y.color,label:y.label,s:y.value/h*l,value:y.value,id:y.id,x:f,y:u}];if(o+1<=this.data.values.length-1){const t=this.data.values[o+1];M.push({color:t.color,label:t.label,s:t.value/h*l,value:t.value,id:t.id,x:f,y:u}),o++}const T=1==M.length,P=o==this.data.values.length-1;if(w)for(let t=1;t<=b+o*o;t++){const e=b-t,i=M[0].s/e;if(i+(T?0:M[1].s/e)>=x){M[0].w=Math.floor(e),M[0].h=Math.floor(i),T||(M[1].w=Math.floor(e),M[1].h=x-M[0].h,M[1].y+=M[0].h);break}}else for(let t=1;t<=x+o*o;t++){const e=x-t,i=M[0].s/e;if(i+(T?0:M[1].s/e)>=b){M[0].h=Math.floor(e),M[0].w=Math.floor(i),T||(M[1].h=Math.floor(e),M[1].w=b-M[0].w,M[1].x+=M[0].w);break}}for(const t of M){P&&(w?(t.w=b,T&&(t.h=x)):(t.h=x,T&&(t.w=b))),g.beginPath(),g.fillStyle=t.color;const e=this.state!=_.RenderState.Init&&!this.animations.contains(t.id,_.AnimationType.Init),i=o+M.indexOf(t)+(P&&T?1:0),c=260,v=()=>{let t=0;for(let e=0;e<i;e++)t+=c-c*(e/this.data.values.length)/Math.E;return t},y=c-c*i/(this.data.values.length+1);if(e){const e=(e,i)=>{const s=t.x+t.w/2,n=t.y+t.h/2,a=t.w>t.h?1-12/t.w:1-12/t.h,o=1-a;g.translate(s-s*(a+e*o),n-n*(a+e*o)),g.scale(a+e*o,a+e*o),this.animations.reload(t.id,i)};d(this,n,"m",a).call(this,t)&&!s?(s=t,r=t.data,this.animations.handle(t.id,_.AnimationType.MouseOver,{duration:A.Animations.tree,backward:!0,body:t=>{e(t,_.AnimationType.MouseLeave)}})):this.animations.handle(t.id,_.AnimationType.MouseLeave,{timer:A.Dates.minDate,duration:A.Animations.tree,body:t=>{e(t,_.AnimationType.MouseOver)}})}else this.animations.handle(t.id,_.AnimationType.Init,{duration:v(),continuous:!0,body:e=>{if(e*v()-v()+y<0)return g.fillStyle+="00";e=(e*v()-v()+y)/y;const i=t.x+t.w/2,s=t.y+t.h/2,n=.7,a=1-n;g.translate(i-i*(n+e*a),s-s*(n+e*a)),g.scale(n+e*a,n+e*a);let o=Math.round(255*e).toString(16);o.length<2&&(o=0+o),g.fillStyle=t.color+o}});const O=4;g.roundRect(f+O,u+O,t.w-O,t.h-O,2*O),g.fill(),t.label&&p.stringWidth(t.label)<t.w-O&&t.h-O>16&&!this.animations.contains(t.id,_.AnimationType.Init)&&(g.beginPath(),m.default.large(g),g.fillStyle=p.isColorVisible(t.color,"#ffffff")?"#ffffff":"#000000",g.fillText(t.label,f+2+t.w/2,u+2+t.h/2)),g.resetTransform(),w?u+=t.h:f+=t.w,l-=t.w*t.h,h-=t.value}w?(f+=M[0].w,u=v):(u+=M[0].h,f=c),c=f,v=u,w=!w}this.tooltip.render(!!s&&!this.dropdown?.isActive,this.moveEvent,[new y.default(`${s?.label}: ${P.default.format(s?.value,_.PlotAxisType.Number,this.settings.valuePostfix)}`)],this.data.values.find(t=>t.id==s?.id)),this.isDestroy||requestAnimationFrame(this.render.bind(this)),this.state=_.RenderState.Idle,super.renderDropdown(),s||this.contextMenu?this.renderContextMenu(r):this.menuEvent=void 0}refresh(){super.refresh()}resize(){super.resize(),this.initAnimations(),this.animations.clear()}prepareSettings(){super.prepareSettings(),this.data.values=this.data.values.map(t=>new v.default(t)),this.data.values=this.data.values.filter(t=>t.value>0),this.data.values.sort((t,e)=>(e.value??0)-(t.value??0)),this.calculateColors(!0);for(let t of this.data.values)t.disabled=!t.value,t.value??=0}initDropdown(){super.initDropdown(),this.dropdown=new g.default(this.canvas,{x:-10,y:10,icon:_.Icon.ThreeLines,items:[{text:M.default.exportCSV,action:()=>{w.default.asCsv(b.default.toTable(u.default.getRows(this.data)),this.settings.title)}},{isDivider:!0},{text:M.default.decomposeToTable,action:()=>{new x.default(b.default.toTable(u.default.getRows(this.data)),void 0,this.settings.title??M.default.dataAsTable).open()}}]})}}n=new WeakSet,a=function(t){if(!this.moveEvent||!t)return!1;const e=this.getMousePosition(this.moveEvent);return!this.dropdown?.isActive&&t.x<=e.x&&e.x<=t.x+t.w&&t.y<=e.y&&e.y<=t.y+t.h},o=function(){const t=T.default.getContext(this.canvas);m.default.regular(t),t.fillText(M.default.treeMapIsEmpty,this.canvas.width/2,this.canvas.height/2)},e.default=O},743:function(t,e,i){var s,n=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),o=0;o<i.length;o++)"default"!==i[o]&&n(e,t,i[o]);return a(e,t),e}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const h=o(i(10)),l=r(i(828)),d=r(i(283)),f=i(869);e.default=class{static toTable(t){let e=document.createElement(f.Tag.Div);e.classList.add("o-table");let i=new Map,s="",n="",a=0,o=new Map;for(const e of t.values){let i=new Map;for(const e of t.headers)i.set(e.value,0);for(const[t,s]of e.values)i.set(t,s);let s="";for(let t=0;t<a;t++)s+=" ";o.set(e.name+s,i),a++}for(const e of t.headers)n+=`\n                <div>\n                    ${e.display}\n                </div>\n            `;for(const[t,e]of o){let n="";for(const[t,s]of e)if(n+=`\n                    <div>\n                        ${null==s?"":l.default.number(s)}\n                    </div>\n                `,i.has(t)){let e=+(i.get(t)??0);i.set(t,e+ +s)}else i.set(t,s);s+=`\n                <div class="o-table-row">\n                    <div>\n                        ${t.trim()}\n                    </div>\n                    \n                    ${n} \n                </div>\n            `}let r="";for(const[,t]of i)r+=`\n                <div>\n                    ${null==t?"":l.default.number(t)}\n                </div>\n            `;return e.innerHTML=`\n            <div class="o-table-header">\n                <div></div>\n\n                ${n}\n            </div>\n        \n            <div class="o-table-body">\n                ${s}\n            </div>\n            \n            <div class="o-table-footer">\n                <div></div>\n\n                ${r}\n            </div>\n        `,e}static toChart(t,e){let i=document.createElement(f.Tag.Div),s=document.createElement(f.Tag.Div),n=document.createElement(f.Tag.Script),a=h.guid();i.style.display=d.default.Display.Flex,i.style.height="100%",s.id=a,s.style.flexGrow="1";let o=JSON.parse(JSON.stringify(t));return o.title&&(o.title=o.title+" (Other)"),o.data.values=e,o.minWidth=void 0,o.minHeight=void 0,n.innerHTML=`\n            new OCharts.chart(document.getElementById('${a}'), ${JSON.stringify(o)})\n                .render()\n        `,i.append(s,n),i}}},797:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Values=e.Dates=e.Animations=void 0;var s=i(126);Object.defineProperty(e,"Animations",{enumerable:!0,get:function(){return s.Animations}});var n=i(572);Object.defineProperty(e,"Dates",{enumerable:!0,get:function(){return n.Dates}});var a=i(975);Object.defineProperty(e,"Values",{enumerable:!0,get:function(){return a.Values}})},801:function(t,e,i){var s,n,a,o,r,h,l,d=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),f=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&d(e,t,i[n]);return f(e,t),e}),c=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},v=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},p=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const g=p(i(459)),m=u(i(10)),y=p(i(359)),w=p(i(409)),b=p(i(601)),x=p(i(12)),M=p(i(804)),T=p(i(828)),P=p(i(168)),_=p(i(147)),A=i(869);class O extends g.default{constructor(t){super(t),n.add(this),a.set(this,void 0),o.set(this,void 0),this.settings.enableLegend=!1}render(){super.render(),c(this,n,"m",r).call(this);const t=this.data.values[0];this.tooltip.render(c(this,n,"m",h).call(this,this.moveEvent,t)&&!this.dropdown?.isActive,this.moveEvent,[new x.default(`${t?.label}: ${T.default.format(t?.current,A.PlotAxisType.Number,this.settings.valuePostfix)}`)],t),this.isDestroy||requestAnimationFrame(this.render.bind(this)),this.state=A.RenderState.Idle,super.renderDropdown()}refresh(){super.refresh()}resize(){super.resize(),this.initAnimations(),c(this,n,"m",l).call(this)}prepareSettings(){super.prepareSettings();for(let t of this.data.values)t.disabled=!t.value,t.value??=0;this.data.values.length>0&&this.data.values[0].value>this.data.max&&(this.data.values[0].value=this.data.max)}initDropdown(){super.initDropdown(),this.dropdown=new y.default(this.canvas,{x:-10,y:10,icon:A.Icon.ThreeLines,items:[{text:_.default.exportPNG,action:()=>{M.default.asPng(this.canvas,this.settings.title)}}]})}}a=new WeakMap,o=new WeakMap,n=new WeakSet,r=function(){const t=P.default.getContext(this.canvas),e=this.data.values[0]??{id:m.guid()};(this.state==A.RenderState.Init||this.animations.contains(e.id,A.AnimationType.Init))&&this.animations.handle(e.id,A.AnimationType.Init,{duration:450,continuous:!0,body:t=>{e.current=e.value*t}}),t.beginPath(),t.strokeStyle=e.color,t.lineCap="round",t.lineWidth=40;const i=e.current/this.data.max,s=(isNaN(i)?1:i)*Math.PI;e.value&&(t.arc(c(this,o,"f").x,c(this,o,"f").y,c(this,a,"f"),Math.PI,s-Math.PI),t.stroke()),t.beginPath(),t.lineWidth=1,t.lineCap="square";let n=0,r=Math.PI;for(;r>=0;){let e=r-Math.PI/10>0?Math.PI/10:r;const i=t=>({x:c(this,o,"f").x+(c(this,a,"f")+t)*Math.cos(Math.PI+n),y:c(this,o,"f").y+(c(this,a,"f")+t)*Math.sin(Math.PI+n)});let h=i(50),l=i(90),d=i(115);const f=Math.PI-r>s?"66":"ff";t.moveTo(h.x,h.y),t.lineTo(l.x,l.y),t.strokeStyle=w.default.text+f,t.stroke(),b.default.regular(t),t.fillStyle=w.default.text+f,t.fillText(T.default.number(this.data.max-r/Math.PI*this.data.max),d.x,d.y),n+=e,r-=Math.PI/10}},h=function(t,e){if(!t)return!1;const i=this.getMousePosition(t),s={x:i.x-c(this,o,"f").x,y:i.y-c(this,o,"f").y};return!this.dropdown?.isActive&&(t=>{let i=Math.atan2(t.y-c(this,o,"f").y,t.x-c(this,o,"f").x);i<0&&(i+=2*Math.PI);const s=e.current/this.data.max,n=(isNaN(s)?1:s)*Math.PI;return i>Math.PI&&Math.PI+n>=i})(i)&&(t=>{const e=c(this,a,"f")+20,i=c(this,a,"f")-20;return t.x*t.x+t.y*t.y<=e*e&&t.x*t.x+t.y*t.y>=i*i})(s)},l=function(){const t=this.canvas.width<this.canvas.height/2?this.canvas.height/2:this.canvas.width;v(this,a,t/2-200,"f"),v(this,o,{x:this.canvas.width/2,y:this.canvas.height-c(this,a,"f")/5},"f")},e.default=O},804:function(t,e,i){var s,n=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),o=0;o<i.length;o++)"default"!==i[o]&&n(e,t,i[o]);return a(e,t),e}),r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const h=r(i(409)),l=o(i(10)),d=r(i(168)),f=i(869);class u{static asPng(t,e){requestAnimationFrame(()=>{const i=d.default.getContext(t);let s=l.stringWidth(f.Icon.ThreeLines)+20;i.fillStyle=h.default.canvasBackground,i.fillRect(t.width-s,0,s,64);let n=0,a=0;const o=new Uint32Array(i.getImageData(0,0,t.width,t.height).data.buffer);let r=!1;for(let e=0;e<t.width;e++){for(let i=0;i<t.height;i++)if(d.default.isPixelBusy(o[e+i*t.width])){r=!0;break}if(r)break;n++}r=!1;for(let e=t.width;e>=0;e--){for(let i=0;i<t.height;i++)if(d.default.isPixelBusy(o[e+i*t.width])){r=!0;break}if(r)break;a++}n>4&&(n-=4),a>4&&(a-=4),n>a&&(n=a),a>n&&(a=n);let c=document.createElement(f.Tag.Canvas);c.width=t.width-n-a,c.height=t.height;const v=d.default.getContext(c);v.fillStyle=h.default.background,v.fillRect(0,0,t.width,t.height),v.drawImage(t,-n,0),u.saveAs((e??"chart")+".png",c.toDataURL("image/png"))})}static asCsv(t,e){let i=t.querySelectorAll("tr"),s=[];for(let t=0;t<i.length;t++){let e=[],n=i[t].querySelectorAll("td, th");for(let t=0;t<n.length;t++){let i=n[t].innerHTML.replace(/(\r\n|\n|\r)/gm,"").replace(/(\s\s)/gm," ");i=i.replace(/"/g,'""'),e.push('"'+i+'"')}s.push(e.join(","))}u.saveAs((e??"table")+".csv",s.join("\n"),"data:text/csv;charset=utf-8,"+encodeURIComponent(s.join("\n")),!0)}static saveAs(t,e,i,s){if(null!=window.showSaveFilePicker){const n={suggestedName:t,types:[{accept:s?{"text/csv":".csv"}:{"image/*":".png"}}],excludeAcceptAllOption:!0};function a(t){const e=atob(t.split(",")[1]),i=t.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(e.length),n=new Uint8Array(s);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return new Blob([s],{type:i})}window.showSaveFilePicker(n).then(t=>{t.createWritable().then(t=>{t.write(s?e:a(e)).then(()=>t.close())})})}else{let o=document.createElement(f.Tag.A);o.href=i??e,o.download=t,o.click()}}}e.default=u},828:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0});const s=i(869);class n{static format(t,e,i){let a="";switch(e){case s.PlotAxisType.Number:a=n.number(t);break;case s.PlotAxisType.Date:a=n.date(new Date(t));break;case s.PlotAxisType.Text:a=n.text(t)}return a+(i??"")}}n.number=t=>t?.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})??"",n.date=t=>t?.toLocaleDateString()??"",n.text=t=>t??"",e.default=n},830:function(t,e,i){var s,n,a,o,r,h,l,d,f,u=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),c=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),v=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&u(e,t,i[n]);return c(e,t),e}),p=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},g=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},m=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const y=m(i(601)),w=m(i(409)),b=m(i(5)),x=v(i(10)),M=m(i(168)),T=i(869),P=v(i(797)),_=m(i(283));a=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,l=new WeakMap,n=new WeakSet,d=function(){p(this,r,g(this,a,"f").getBoundingClientRect(),"f"),g(this,r,"f").x+=scrollX,g(this,r,"f").y+=scrollY;const t=x.stringWidth(g(this,o,"f").text)+12;p(this,l,{x:g(this,o,"f").x+t>g(this,a,"f").width?g(this,a,"f").width-t:g(this,o,"f").x<0?g(this,a,"f").width+g(this,o,"f").x-t:g(this,o,"f").x,y:g(this,o,"f").y+20>g(this,a,"f").height?g(this,a,"f").height-20:g(this,o,"f").y<0?g(this,a,"f").height+g(this,o,"f").y-20:g(this,o,"f").y,width:t,height:20},"f")},f=function(t){if(!t)return!1;let e=t.clientX-g(this,r,"f").x+scrollX,i=t.clientY-g(this,r,"f").y+scrollY;return e>=g(this,l,"f").x&&e<=g(this,l,"f").x+g(this,l,"f").width&&i>=g(this,l,"f").y&&i<=g(this,l,"f").y+g(this,l,"f").height},e.default=class{constructor(t,e){n.add(this),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),h.set(this,void 0),l.set(this,void 0),p(this,a,t,"f"),p(this,o,e,"f"),this.animations=new b.default,g(this,n,"m",d).call(this)}render(t,e){g(this,h,"f")||g(this,n,"m",d).call(this);const i=M.default.getContext(g(this,a,"f"));i.beginPath();const s=(t,e)=>{this.animations.reload("animation-button",e),i.fillStyle=x.adjustColor(w.default.canvasBackground,-Math.round(25*t))};return g(this,n,"m",f).call(this,t)?(g(this,a,"f").style.cursor=_.default.Cursor.Pointer,e&&g(this,n,"m",f).call(this,e)&&(g(this,o,"f").action(),e=void 0),this.animations.handle("animation-button",T.AnimationType.MouseOver,{duration:300,body:t=>{s(t,T.AnimationType.MouseLeave)}})):this.animations.handle("animation-button",T.AnimationType.MouseLeave,{timer:P.Dates.minDate,duration:300,backward:!0,body:t=>{s(t,T.AnimationType.MouseOver)}}),i.roundRect(g(this,l,"f").x,g(this,l,"f").y,g(this,l,"f").width,g(this,l,"f").height,4),i.fill(),y.default.regular(i),i.fillText(g(this,o,"f").text,g(this,l,"f").x+g(this,l,"f").width/2,g(this,l,"f").y+g(this,l,"f").height/2),p(this,h,!0,"f"),e}resize(){g(this,n,"m",d).call(this)}}},832:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=s(i(88));function a(){}a.chart=function(t,e){return new n.default(t,e)},window.OCharts=a},869:(t,e)=>{var i,s,n,a,o,r,h,l,d,f,u,c,v;Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPointType=e.Icon=e.RenderState=e.Tag=e.PlotType=e.PlotAxisType=e.LineType=e.LegendPlace=e.Events=e.ErrorType=e.ChartType=e.Attribute=e.AnimationType=void 0,function(t){t[t.None=0]="None",t[t.MouseOver=1]="MouseOver",t[t.MouseLeave=2]="MouseLeave",t[t.Init=3]="Init",t[t.Click=4]="Click",t[t.AnotherItemOver=5]="AnotherItemOver",t[t.AnotherItemLeave=6]="AnotherItemLeave"}(i||(e.AnimationType=i={})),function(t){t.Name="name"}(s||(e.Attribute=s={})),function(t){t[t.Plot=0]="Plot",t[t.Circular=1]="Circular",t[t.Gauge=2]="Gauge",t[t.TreeMap=3]="TreeMap"}(n||(e.ChartType=n={})),function(t){t.NullContext="Can't find context",t.ElementNotExist="Element does not exist"}(a||(e.ErrorType=a={})),function(t){t.VisibilityChanged="visibilitychange",t.Blur="blur",t.MouseMove="mousemove",t.Click="click",t.Change="change",t.ContextMenu="contextmenu"}(o||(e.Events=o={})),function(t){t[t.Bottom=0]="Bottom",t[t.Left=1]="Left",t[t.Top=2]="Top",t[t.Right=3]="Right"}(r||(e.LegendPlace=r={})),function(t){t[t.Solid=0]="Solid",t[t.Dash=1]="Dash",t[t.Dotted=2]="Dotted"}(h||(e.LineType=h={})),function(t){t[t.Number=0]="Number",t[t.Date=1]="Date",t[t.Text=2]="Text"}(l||(e.PlotAxisType=l={})),function(t){t[t.Line=0]="Line",t[t.AttentionLine=1]="AttentionLine",t[t.Column=2]="Column",t[t.Bar=3]="Bar",t[t.StackingColumn=4]="StackingColumn"}(d||(e.PlotType=d={})),function(t){t.Canvas="canvas",t.A="a",t.Div="div",t.Dialog="dialog",t.Table="table",t.Script="script",t.Button="button",t.Span="span"}(f||(e.Tag=f={})),function(t){t[t.Idle=0]="Idle",t[t.Init=1]="Init"}(u||(e.RenderState=u={})),function(t){t.ThreeLines="",t.Close=""}(c||(e.Icon=c={})),function(t){t[t.Move=0]="Move",t[t.Line=1]="Line",t[t.QuadraticCurve=2]="QuadraticCurve"}(v||(e.DrawPointType=v={}))},897:function(t,e,i){var s,n,a,o,r=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},h=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const d=l(i(39)),f=i(869);n=new WeakMap,s=new WeakSet,a=function(t){d.default.throwIsUndefined(this.modal,f.ErrorType.ElementNotExist);let e=document.createElement(f.Tag.Span);e.classList.add(u.title),e.innerHTML=t??"";let i=document.createElement(f.Tag.Button);i.classList.add(u.close),i.innerHTML=f.Icon.Close;let s=document.createElement(f.Tag.Div);s.classList.add(u.header),s.appendChild(e),s.appendChild(i),this.modal.appendChild(s),i.onclick=()=>this.close()},o=function(t){null==r(this,n,"f")&&(h(this,n,document.createElement(f.Tag.Div),"f"),r(this,n,"f").classList.add(u.content),this.modal?.appendChild(r(this,n,"f"))),null!=t&&r(this,n,"f").appendChild(t)},e.default=class{constructor(t,e,i){s.add(this),n.set(this,void 0),this.modal=document.createElement(f.Tag.Dialog),this.modal.classList.add(u.modal),e&&(this.modal.style.width=`${e.width}px`,this.modal.style.height=`${e.height}px`),this.modal.oncancel=()=>this.close(),document.body.appendChild(this.modal),r(this,s,"m",a).call(this,i),r(this,s,"m",o).call(this,t)}open(){d.default.throwIsUndefined(this.modal,f.ErrorType.ElementNotExist),this.modal.showModal()}close(){d.default.throwIsUndefined(this.modal,f.ErrorType.ElementNotExist),this.modal.close(),this.modal.remove(),this.modal=void 0}};class u{}u.modal="o-modal",u.title="o-modal-title",u.close="o-modal-close",u.header="o-modal-header",u.content="o-modal-content"},902:function(t,e,i){var s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const n=s(i(527)),a=i(869);class o extends n.default{constructor(t){super(),this.lineType=a.LineType.Solid,Object.assign(this,t)}toggle(t){super.toggle(t)}checkCondition(){return super.checkCondition(),!0}reset(){super.reset()}}e.default=o},927:function(t,e,i){var s,n,a,o,r,h,l,d=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),f=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&d(e,t,i[n]);return f(e,t),e}),c=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},v=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},p=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const g=p(i(688)),m=u(i(10)),y=p(i(138)),w=p(i(409)),b=p(i(601)),x=p(i(168)),M=p(i(830)),T=p(i(147)),P=u(i(797)),_=p(i(283)),A=i(869);class O extends g.default{constructor(t){super(t),n.add(this),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),h.set(this,void 0),this.isDestroy=!1,c(this,r,t,"f"),this.prepareSettings()}render(){super.render();const t=x.default.getContext(this.canvas);let e={x:20,y:21};this.canvas.style.cursor=_.default.Cursor.Default,b.default.regular(t),t.textAlign="start",t.textBaseline="alphabetic",t.translate(v(this,o,"f").x,v(this,o,"f").y),c(this,h,0,"f");for(const t of this.settings.data.values.filter(t=>!t.hideInLegend))e=v(this,n,"m",l).call(this,t,e.x,e.y);t.translate(-v(this,o,"f").x,-v(this,o,"f").y),this.isDestroy||requestAnimationFrame(this.render.bind(this)),this.clickEvent=v(this,a,"f")?.render(this.moveEvent,this.clickEvent),this.state=A.RenderState.Idle}destroy(){this.isDestroy=!0,this.canvas.remove()}refresh(){this.state=A.RenderState.Init}resize(){this.calculateSizes(),v(this,a,"f")?.resize(),this.initAnimations()}calculateSizes(){switch(this.settings.legendPlace){case A.LegendPlace.Bottom:default:this.canvas.width=this.settings.width,this.canvas.height=O.getLegendHeight(this.settings.data.values,this.canvas.width),this.node.style.flexDirection=_.default.FlexDirection.Column;break;case A.LegendPlace.Top:this.canvas.width=this.settings.width,this.canvas.height=O.getLegendHeight(this.settings.data.values,this.canvas.width),this.node.style.flexDirection=_.default.FlexDirection.ColumnReverse;break;case A.LegendPlace.Left:this.canvas.width=500,this.canvas.height=this.settings.height,this.node.style.flexDirection=_.default.FlexDirection.Row;break;case A.LegendPlace.Right:this.canvas.width=500,this.canvas.height=this.settings.height,this.node.style.flexDirection=_.default.FlexDirection.RowReverse}c(this,o,{x:O.getOffsetToCenter(this.settings.data.values,this.canvas.width),y:(this.canvas.height-O.getLegendHeight(this.settings.data.values,this.canvas.width))/2},"f")}applySettings(t){this.settings=t,this.prepareSettings()}prepareSettings(){this.resize(),this.settings.disableInteractions||c(this,a,new M.default(this.canvas,{x:-10,y:12,text:T.default.reset,action:()=>{for(let t of this.settings.data.values)t.reset()}}),"f")}static getOffsetToCenter(t,e){let i=20;for(const s of t.filter(t=>!t.hideInLegend)){const t=m.stringWidth(s.label);if(i+t+47>=e-100)break;i+=t+47}return e/2-i/2}static getLegendHeight(t,e){let i=1,s=20,n=O.getOffsetToCenter(t,e);for(const a of t.filter(t=>!t.hideInLegend)){const t=m.stringWidth(a.label);s+t+48>=e-32-n&&(s=20,i++),s+=t+48}return 24+20*i+6*(i-1)}}a=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,n=new WeakSet,l=function(t,e,i){var s;const n=x.default.getContext(this.canvas),a=m.stringWidth(t.label);e+48+a>=this.canvas.width-40-v(this,o,"f").x&&(e=20,i+=26);let l=e-6-6,d=i-3-6,f=12+a+18;const u=t=>{if(!t)return!1;const e=t.clientX-this.canvasPosition.x+scrollX-v(this,o,"f").x,i=t.clientY-this.canvasPosition.y+scrollY-v(this,o,"f").y;return e>=l&&e<=l+f&&i>=d&&i<=d+20},p=(e,i)=>{this.animations.reload(t.id,i),n.beginPath(),n.roundRect(l,d,f,20,6),n.fillStyle=m.adjustColor(w.default.canvasBackground,Math.round(-25*e)),n.fill()};return this.animations.handle(t.id,A.AnimationType.Click,{duration:P.Animations.legend,continuous:!0,before:()=>null!=this.clickEvent&&(u(this.clickEvent)||t instanceof y.default&&0!==t.current&&t.value!==t.current)&&t.checkCondition(),body:e=>{t.toggle(e),1==e&&(this.clickEvent=new PointerEvent(A.Events.Click))}}),u(this.moveEvent)?(this.animations.handle(t.id,A.AnimationType.MouseOver,{duration:P.Animations.button,body:t=>{p(t,A.AnimationType.MouseLeave)}}),t.disabled||(c(this,h,(s=v(this,h,"f"),++s),"f"),v(this,r,"f").highlight(t)),this.canvas.style.cursor=_.default.Cursor.Pointer):this.animations.handle(t.id,A.AnimationType.MouseLeave,{timer:P.Dates.minDate,duration:P.Animations.button,backward:!0,body:t=>{p(t,A.AnimationType.MouseOver)}}),n.beginPath(),n.arc(e-1,i+1,3,0,2*Math.PI),n.fillStyle=t.disabled?m.grayScale(t.color):t.color,n.fill(),n.fillStyle=w.default.text,t.disabled&&(n.fillStyle+="7f"),n.fillText(t.label,e+9+1,i+6),e+=20,t.disabled&&(n.moveTo(e-10,i+2),n.lineTo(e+a-10,i+2),n.strokeStyle=w.default.text+"7f",n.stroke()),{x:e+=a+22,y:i}},e.default=O},975:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Values=void 0;class i{}e.Values=i,i.titleOffset=30}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var a=e[s]={exports:{}};return t[s].call(a.exports,a,a.exports,i),a.exports}i(281),i(832)})();
//# sourceMappingURL=ocharts.js.map