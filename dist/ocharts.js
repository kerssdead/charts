(()=>{"use strict";var t={5:function(t,e,i){var s,n,a,o,r,h,l,c=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),d=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),f=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&c(e,t,i[n]);return d(e,t),e}),u=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},v=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};Object.defineProperty(e,"__esModule",{value:!0}),e.Animations=void 0;const p=i(869),g=f(i(797));class m{constructor(){n.add(this),o.set(this,void 0),u(this,o,new Map,"f")}handle(t,e,i){const s=v(this,n,"m",h).call(this,t,e);v(this,o,"f").has(s)||v(this,o,"f").set(s,i),v(this,n,"m",r).call(this,s)}contains(t,e){return v(this,o,"f").has(v(this,n,"m",h).call(this,t,e))}reload(t,e){this.contains(t,e)&&(v(this,o,"f").get(v(this,n,"m",h).call(this,t,e)).timer=new Date)}clear(){v(this,o,"f").forEach((t,e)=>!v(this,n,"m",l).call(this,e,p.AnimationType.Init)&&v(this,o,"f").delete(e))}reverse(t,e){if(this.contains(t,e)){let i=v(this,o,"f").get(v(this,n,"m",h).call(this,t,e)),s=new Date,a=s.getTime()-(i.timer??s).getTime(),r=a>i.duration?1:i.duration-a;i.timer=new Date((new Date).getTime()-r),i.backward=!i.backward}}isBackward(t,e){return v(this,o,"f").get(v(this,n,"m",h).call(this,t,e))?.backward??!1}isEnd(t,e){let i=v(this,o,"f").get(v(this,n,"m",h).call(this,t,e)),s=new Date;return s.getTime()-(i.timer??s).getTime()>=i.duration}end(t,e){let i=v(this,o,"f").get(v(this,n,"m",h).call(this,t,e));i&&(i.timer=g.Dates.minDate)}static initializeTransitions(){for(let t=0;t<22820;t++){const e=(t+1)/22820;let i=0*Math.pow(1-e,3)+3*Math.pow(1-e,2)*.77*e+3*(1-e)*Math.pow(e,2)*.23+1*Math.pow(e,3),s=0*Math.pow(1-e,3)+3*Math.pow(1-e,2)*.23*e+3*(1-e)*Math.pow(e,2)*.77+1*Math.pow(e,3);a.transitionCurve.set(+i.toFixed(4),s)}a.transitionCurve.set(0,0)}static getTransition(t){return a.transitionCurve.get(+t.toFixed(4))??0}}e.Animations=m,a=m,o=new WeakMap,n=new WeakSet,r=function(t){const e=v(this,o,"f").get(t),i=new Date,s=i.getTime()-(e.timer??i).getTime(),n=a.getTransition(s>e.duration?1:s/e.duration),r=!e.before||e.before();!e.timer&&r&&(e.timer=i),r&&e.body(e.backward?1-n:n),1!=n||r&&!e.continuous||v(this,o,"f").delete(t)},h=function(t,e){return t+"_"+e},l=function(t,e){return t.endsWith("_"+e)},m.transitionCurve=new Map},10:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.adjustColor=function(t,e){return"#"+t.replace(/^#/,"").replace(/../g,t=>("0"+Math.min(255,Math.max(0,parseInt(t,16)+e)).toString(16)).slice(-2))},e.grayScale=function(t){return"#"+Array(4).join(Math.round([.3,.59,.11].reduce((e,i,s)=>e+i*parseInt(t[2*s+1]+t[2*s+2],16),0)/3).toString(16).padStart(2,"0"))},e.randomColor=function(){let t="#";for(let e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t},e.stringWidth=function(t,e){if(!t)return 0;const i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.559375,.2765625,.3546875,.5546875,.5546875,.8890625,.665625,.190625,.3328125,.3328125,.3890625,.5828125,.2765625,.3328125,.2765625,.3015625,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.2765625,.2765625,.584375,.5828125,.584375,.5546875,1.0140625,.665625,.665625,.721875,.721875,.665625,.609375,.7765625,.721875,.2765625,.5,.665625,.5546875,.8328125,.721875,.7765625,.665625,.7765625,.721875,.665625,.609375,.721875,.665625,.94375,.665625,.665625,.609375,.2765625,.3546875,.2765625,.4765625,.5546875,.3328125,.5546875,.5546875,.5,.5546875,.5546875,.2765625,.5546875,.5546875,.221875,.240625,.5,.221875,.8328125,.5546875,.5546875,.5546875,.5546875,.3328125,.5,.2765625,.5546875,.5,.721875,.5,.5,.5,.3546875,.259375,.353125,.5890625];return Array.from(String(t)).reduce((t,e)=>t+(i[e.charCodeAt(0)]??.5279276315789471),0)*(e||14)},e.guid=function(){const t=()=>(65536*(1+Math.random())|0).toString(16).substring(1);return(t()+t()+"-"+t()+"-4"+t().slice(0,3)+"-"+t()+"-"+t()+t()+t()).toLowerCase()},e.isColorVisible=function(t,e){const i=a(t),s=a(e);return(i.r+i.g+i.b)/(s.r+s.g+s.b)<.77},e.hexToRgb=a,e.isISOString=function(t){return/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+/.test(t)},e.applyAlpha=function(t,e){function i(t){let e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:{r:0,g:0,b:0}}function s(t){let e=t.toString(16);return 1==e.length?"0"+e:e}const a=i(t),o=i(n.Theme.canvasBackground),r=1-(e/=255);return h=Math.round(255*(e*(a.r/255)+r*(o.r/255))),l=Math.round(255*(e*(a.g/255)+r*(o.g/255))),c=Math.round(255*(e*(a.b/255)+r*(o.b/255))),"#"+s(h)+s(l)+s(c);var h,l,c};const s=i(125),n=i(409);function a(t){if(t.length>4){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(e)return{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}}else{const e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i.exec(t);if(e)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16)}}return new s.Color}},12:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TooltipValue=void 0,e.TooltipValue=class{constructor(t,e){this.text=t,this.color=e}}},39:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Errors=void 0;class i{static throw(t){throw new Error(t)}static throwIsUndefined(t,e){null==t&&i.throw(e)}}e.Errors=i},88:function(t,e,i){var s,n,a,o,r,h,l,c,d,f,u,v=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},p=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i};Object.defineProperty(e,"__esModule",{value:!0}),e.Chart=void 0;const g=i(927),m=i(557),y=i(801),w=i(690),b=i(5),x=i(409),T=i(283),M=i(869),P=i(427);e.Chart=class{constructor(t,e){s.add(this),n.set(this,void 0),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),this.node=t,this.applySettings(e),v(this,s,"m",f).call(this),document.addEventListener(M.Events.VisibilityChanged,()=>v(this,n,"f").resetMouse()),window.addEventListener(M.Events.Blur,()=>v(this,n,"f").resetMouse()),window.addEventListener(M.Events.Click,t=>{t.target!=v(this,n,"f").canvas&&v(this,n,"f").closeDropdowns()})}render(){v(this,n,"f").render(),v(this,a,"f")?.render(),v(this,s,"m",u).call(this),v(this,s,"m",l).call(this)}destroy(){v(this,n,"f").destroy(),v(this,a,"f")?.destroy(),v(this,o,"f").disconnect()}highlight(t){v(this,n,"f").highlight(t)}reset(){x.Theme.reset(),v(this,s,"m",d).call(this,this.settings)}applySettings(t){this.settings=t,this.reset();const e=this.settings.type!=v(this,r,"f");v(this,s,"m",h).call(this),this.settings.enableLegend&&null!=v(this,a,"f")&&v(this,a,"f").applySettings(t),this.settings.enableLegend&&null==v(this,a,"f")&&(p(this,a,new g.Legend(this),"f"),v(this,a,"f").render()),this.settings.enableLegend||null==v(this,a,"f")||(v(this,a,"f").destroy(),p(this,a,void 0,"f")),e&&v(this,n,"f").render(),v(this,s,"m",u).call(this)}},n=new WeakMap,a=new WeakMap,o=new WeakMap,r=new WeakMap,s=new WeakSet,h=function(){if(this.settings.enableTooltip=!this.settings.disableInteractions&&this.settings.enableTooltip,null==v(this,n,"f")||this.settings.type!=v(this,r,"f"))switch(v(this,n,"f")?.destroy(),this.settings.type){case M.ChartType.Plot:p(this,n,new m.PlotRenderer(this),"f"),p(this,r,M.ChartType.Plot,"f");break;case M.ChartType.Circular:p(this,n,new P.CircularRenderer(this),"f"),p(this,r,M.ChartType.Circular,"f");break;case M.ChartType.Gauge:p(this,n,new y.GaugeRenderer(this),"f"),p(this,r,M.ChartType.Gauge,"f");break;case M.ChartType.TreeMap:p(this,n,new w.TreeRenderer(this),"f"),p(this,r,M.ChartType.TreeMap,"f")}else v(this,n,"f").applySettings(this.settings);v(this,n,"f").prepareSettings(),this.settings.disableInteractions||(v(this,n,"f").initDropdown(),v(this,n,"f").initAnimations()),v(this,n,"f").resize()},l=function(){v(this,n,"f").refresh(),v(this,a,"f")?.refresh()},c=function(){v(this,n,"f").resize(),v(this,a,"f")?.resize()},d=function(t){x.Theme.initialize(()=>v(this,s,"m",c).call(this),t.isDarkThemeFunction),b.Animations.initializeTransitions()},f=function(){this.node.style.display=T.Styles.Display.Flex,this.node.style.flexDirection=T.Styles.FlexDirection.Column,this.node.style.alignItems=T.Styles.AlignItems.Center,this.node.style.justifyContent=T.Styles.JustifyContent.Center,this.node.style.height="100%"},u=function(){null==v(this,o,"f")&&(p(this,o,new ResizeObserver(()=>{v(this,n,"f").canvas?v(this,s,"m",c).call(this):this.destroy()}),"f"),v(this,o,"f").observe(this.node))}},125:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Color=void 0,e.Color=class{}},126:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Animations=void 0;class i{}e.Animations=i,i.circular=335,i.legend=500,i.tree=250,i.tooltip=120,i.button=200},138:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Sector=void 0;const s=i(527);class n extends s.Value{constructor(t){super(),Object.assign(this,t),this.baseColor=this.color,this.canRenderLabel=!1,this.isMouseInside=!1}toggle(t){super.toggle(t),this.disabled?this.current=this.value*(1-t):this.current=this.value*t}checkCondition(){return super.checkCondition(),0==this.current&&!this.disabled||0!=this.value}reset(){super.reset(),this.current=this.value}}e.Sector=n},147:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextResources=void 0;class i{}e.TextResources=i,i.exportPNG="Save as image...",i.decomposeToTable="Show as table...",i.reset="Reset",i.exportCSV="Save as table...",i.menu="Menu",i.allDataIsHidden="All data is hidden",i.other="Other",i.thousandShort="K",i.millionShort="M",i.billionShort="B",i.show="Show...",i.noLabel="No Label",i.treeMapIsEmpty="Tree Map is empty",i.dataAsTable="Data as table"},168:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Canvas=void 0;const s=i(39),n=i(869),a=i(409);e.Canvas=class{static getContext(t){return t.getContext("2d",{willReadFrequently:!0})??s.Errors.throw(n.ErrorType.NullContext)}static isPixelBusy(t){return null!=t&&t-a.Theme.canvasBackgroundInt!=0}}},183:function(t,e,i){var s,n,a,o,r,h,l,c,d,f,u,v,p,g,m=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),y=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),w=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&m(e,t,i[n]);return y(e,t),e}),b=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},x=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};Object.defineProperty(e,"__esModule",{value:!0}),e.Tooltip=void 0;const T=i(409),M=i(601),P=w(i(10)),C=i(168),S=w(i(797)),A=i(283),_=i(869);e.Tooltip=class{constructor(t,e){n.add(this),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),h.set(this,void 0),l.set(this,void 0),c.set(this,void 0),d.set(this,void 0),f.set(this,void 0),this.canvas=t,this.data=e.data,b(this,a,e.enableTooltip,"f"),b(this,o,!!e.templateId,"f"),x(this,o,"f")&&b(this,h,document.getElementById(e.templateId),"f"),this.refresh()}render(t,e,i,s){if(x(this,n,"m",p).call(this),x(this,a,"f")&&e)if(t||x(this,l,"f")||x(this,c,"f")){t&&b(this,f,i,"f"),x(this,d,"f")||b(this,d,new Date,"f"),x(this,c,"f")?x(this,l,"f")&&b(this,d,new Date,"f"):b(this,l,!0,"f"),x(this,o,"f")?x(this,n,"m",v).call(this,e,s):x(this,n,"m",u).call(this,e);const a=x(this,n,"m",g).call(this);x(this,c,"f")&&a>=1&&(b(this,l,!1,"f"),b(this,c,!1,"f")),x(this,c,"f")&&a<=0&&(b(this,l,!1,"f"),b(this,c,!1,"f"),b(this,d,void 0,"f")),t||null==x(this,d,"f")||b(this,c,!0,"f")}else b(this,d,void 0,"f")}refresh(){b(this,r,this.canvas.getBoundingClientRect(),"f"),x(this,r,"f").x+=scrollX,x(this,r,"f").y+=scrollY}},a=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,f=new WeakMap,n=new WeakSet,u=function(t){const e=C.Canvas.getContext(this.canvas),i=Math.max(...x(this,f,"f").map(t=>P.stringWidth(t.text??"")+(t.color?8:0)));let s=t.clientX-x(this,r,"f").x+10,a=t.clientY-x(this,r,"f").y+scrollY+10;s+i+25>x(this,r,"f").width&&(s=x(this,r,"f").width-(i+25)),a+15+18*x(this,f,"f").length>x(this,r,"f").height&&(a=x(this,r,"f").height-15-18*x(this,f,"f").length),e.beginPath(),e.roundRect(s,a,i+24,16+16*x(this,f,"f").length,6);let o=Math.round(255*x(this,n,"m",g).call(this)).toString(16),h=Math.round(207*x(this,n,"m",g).call(this)).toString(16);1==o.length&&(o="0"+o),1==h.length&&(h="0"+h),e.strokeStyle=T.Theme.dropdownBorder+h,e.lineWidth=1,e.fillStyle=T.Theme.background+h,e.stroke(),e.fill();for(let t of x(this,f,"f")){let i=0;t.color&&(i=12,e.beginPath(),e.fillStyle=t.color+o,e.arc(s+16,a+17,5,0,2*Math.PI),e.fill()),M.TextStyles.tooltip(e),e.fillStyle=T.Theme.text+o,e.fillText(t.text??"",s+i+12,a+21),a+=16}},v=function(t,e){if(null==e)return;const i=x(this,h,"f").id+e.id;let s=document.getElementById(i);const a=()=>{x(this,n,"m",p).call(this),s.style.visibility=A.Styles.Visibility.Visible};if(!s){const t=/\${[^}]*}/gm;let n=x(this,h,"f").cloneNode(!0);s=document.createElement(_.Tag.Div),s.innerHTML=n.innerHTML,s.id=i,s.style.position=A.Styles.Position.Absolute,s.style.pointerEvents=A.Styles.PointerEvents.None,s.style.visibility=A.Styles.Visibility.Visible,s.setAttribute(_.Attribute.Name,x(this,h,"f").id);const o=[...s.innerHTML.matchAll(t)];let r=s.innerHTML;for(const t of o){const i=t[0].replace("${","").replace("}","").replaceAll(" ","");r=r.replaceAll(t[0],e.data[i])}s.innerHTML=r,document.body.appendChild(s),s.position=s.getBoundingClientRect(),a()}s.style.visibility==A.Styles.Visibility.Hidden&&a(),0==s.position.height&&(s.position=s.getBoundingClientRect());const o=10;let l="1",c=t.clientX,d=t.clientY+scrollY;c+s.position.width-x(this,r,"f").x>x(this,r,"f").width-o&&(c=x(this,r,"f").width-s.position.width+x(this,r,"f").x-o,l=".67"),d+s.position.height-x(this,r,"f").y>x(this,r,"f").height-o&&(d=x(this,r,"f").height-s.position.height+x(this,r,"f").y-o,l=".67"),0==c&&0==d&&(l="0"),s.style.left=c+o+"px",s.style.top=d+o+"px",s.style.opacity=l},p=function(){if(!x(this,o,"f"))return;const t=document.querySelectorAll(`[name="${x(this,h,"f").id}"]`);for(let e of t)e.style.visibility=A.Styles.Visibility.Hidden},g=function(){if(!x(this,d,"f"))return 0;let t=x(this,c,"f")?1-((new Date).getTime()-x(this,d,"f").getTime())/S.Animations.tooltip:((new Date).getTime()-x(this,d,"f").getTime())/S.Animations.tooltip;return t>1&&(t=1),t<0&&(t=0),t}},226:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ThemeOptions=void 0;class i{}e.ThemeOptions=i,i.colors=["#000000","#ffffff"],i.backgrounds=["#f7f7f7","#222222"],i.lines=["#000000","#eeeeee"],i.lineAxes=["#e0e0e0","#212121"],i.lineActives=["#898989","#898989"],i.dropdownBorders=["#bcbcbc","#7e7e7e"],i.canvasBackgrounds=["#ffffff","#222222"]},230:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPoint=void 0,e.DrawPoint=class{constructor(t,...e){this.args=e,this.type=t,this.base=JSON.parse(JSON.stringify(e))}}},268:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PlotData=void 0;const s=i(828),n=i(869);e.PlotData=class{static getRows(t){let e=[],i=[];for(const a of t.values){let o=new Map;for(const i of a.values)o.set(i.x.toString(),i.y),e.push({value:i.x.toString(),display:t.xType==n.PlotAxisType.Date?s.Formatter.date(new Date(i.x)):i.x.toString()});i.push({name:a.label,values:o})}const a=new Set,o=e.filter(t=>!a.has(t.display)&&a.add(t.display));return t.xType==n.PlotAxisType.Date&&o.sort((t,e)=>new Date(t.value).getTime()-new Date(e.value).getTime()),{headers:o,values:i}}}},283:(t,e)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.Styles=void 0,function(t){class e{}e.Default="default",e.Pointer="pointer",t.Cursor=e;class i{}i.Flex="flex",t.Display=i;class s{}s.Column="column",s.ColumnReverse="column-reverse",s.Row="row",s.RowReverse="row-reverse",t.FlexDirection=s;class n{}n.Center="center",t.AlignItems=n;class a{}a.Visible="visible",a.Hidden="hidden",t.Visibility=a;class o{}o.Absolute="absolute",t.Position=o;class r{}r.None="none",t.PointerEvents=r;class h{}h.Center="center",t.JustifyContent=h;class l{}l.Pixelated="pixelated",t.ImageRendering=l}(i||(e.Styles=i={}))},359:function(t,e,i){var s,n,a,o,r,h,l,c,d,f,u,v=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),p=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),g=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&v(e,t,i[n]);return p(e,t),e}),m=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},y=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};Object.defineProperty(e,"__esModule",{value:!0}),e.Dropdown=void 0;const w=i(409),b=i(5),x=g(i(10)),T=i(601),M=i(168),P=i(869),C=g(i(797)),S=i(283);e.Dropdown=class{constructor(t,e){n.add(this),this.isActive=!1,a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),h.set(this,void 0),l.set(this,void 0),c.set(this,void 0),m(this,c,t,"f"),m(this,o,e,"f"),y(this,o,"f").icon&&(y(this,o,"f").text=y(this,o,"f").icon),m(this,l,null==y(this,o,"f").text,"f"),this.animations=new b.Animations}render(t,e){y(this,a,"f")||y(this,n,"m",d).call(this),y(this,l,"f")&&(this.isActive=!0);const i=M.Canvas.getContext(y(this,c,"f"));let s=y(this,h,"f").x,r=y(this,h,"f").y,u=y(this,h,"f").width,v=y(this,h,"f").height;if(i.beginPath(),!y(this,l,"f")){const a=(t,e)=>{this.animations.reload("animation-dropdown",e),i.fillStyle=x.adjustColor(w.Theme.canvasBackground,-Math.round(25*t))};y(this,n,"m",f).call(this,t,s,r,u,v)?(y(this,c,"f").style.cursor=S.Styles.Cursor.Pointer,e&&t.x==e.x&&t.y==e.y&&(this.isActive=!this.isActive,e=void 0),this.isActive?i.fillStyle=x.adjustColor(w.Theme.canvasBackground,-25):this.animations.handle("animation-dropdown",P.AnimationType.MouseOver,{duration:300,body:t=>{a(t,P.AnimationType.MouseLeave)}})):(y(this,c,"f").style.cursor=S.Styles.Cursor.Default,this.isActive?i.fillStyle=x.adjustColor(w.Theme.canvasBackground,-25):this.animations.handle("animation-dropdown",P.AnimationType.MouseLeave,{timer:C.Dates.minDate,duration:300,backward:!0,body:t=>{a(t,P.AnimationType.MouseOver)}})),i.roundRect(s,r,u,v,4),i.fill(),T.TextStyles.regular(i),y(this,o,"f").icon&&(i.font="20px sans-serif");const h=y(this,o,"f").icon?"Win32"!=navigator.platform?1:-1:0;i.fillText(y(this,o,"f").text??"",s+u/2,r+v/2-h)}if(this.isActive){const a=6,h=6;r+=v;const l=y(this,o,"f").items.filter(t=>t.text),d=y(this,o,"f").items.filter(t=>!t.text);let u=Math.max(...l.map(t=>x.stringWidth(t.text)))+4*a;s+u>y(this,c,"f").width-4&&(s-=s+u-y(this,c,"f").width+4);const p="bb",g=127,m=w.Theme.dropdownItemHoverColor,b=w.Theme.dropdownBorder;i.beginPath();const M={x:s,y:r,width:u,height:26*l.length+4*d.length+(1==l.length?a:0)+(2==l.length&&1==d.length?a:0)};i.roundRect(M.x,M.y,M.width,M.height,h),i.fillStyle=w.Theme.background+p,i.setLineDash([]),i.lineWidth=1,i.strokeStyle=b+p,i.fill(),i.stroke(),i.beginPath(),r+=6;for(const l of y(this,o,"f").items){if(i.beginPath(),1==l.isDivider){r+=2,i.moveTo(s+a,r),i.lineTo(s+u-a,r),i.lineWidth=.5,i.stroke(),r+=4;continue}i.fillStyle="transparent";const o="animation-dropdown"+l.text,d=(t,e,s)=>{if(this.animations.reload(o,e),s&&1==t)return;let n=Math.round(g*t).toString(16);1==n.length&&(n="0"+n),i.fillStyle=m+n};y(this,n,"m",f).call(this,t,s,r,u,20)?(this.animations.handle(o,P.AnimationType.MouseOver,{duration:300,body:t=>{d(t,P.AnimationType.MouseLeave)}}),y(this,c,"f").style.cursor=S.Styles.Cursor.Pointer,e&&(l.action(),e=void 0,this.isActive=!1)):this.animations.handle(o,P.AnimationType.MouseLeave,{timer:C.Dates.minDate,duration:300,backward:!0,body:t=>{d(t,P.AnimationType.MouseOver,!0)}}),i.roundRect(s+a,r,u-2*a,20,h),i.fill(),T.TextStyles.regular(i),i.fillStyle=w.Theme.text,i.textAlign="left",i.textBaseline="hanging",i.fillText(l.text,s+2*a,r+5),r+=22}}return i.lineWidth=1,!y(this,l,"f")&&null!=e&&this.isActive&&(this.isActive=!1,e=void 0),m(this,a,!0,"f"),y(this,l,"f")&&e&&t.x==e.x&&t.y==e.y&&(this.isActive=!this.isActive,e=void 0),e}refresh(){m(this,a,!1,"f")}resize(){y(this,n,"m",d).call(this),y(this,n,"m",u).call(this)}close(){this.isActive=!1}},a=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,l=new WeakMap,c=new WeakMap,n=new WeakSet,d=function(){m(this,r,y(this,c,"f").getBoundingClientRect(),"f"),y(this,r,"f").x+=scrollX,y(this,r,"f").y+=scrollY},f=function(t,e,i,s,n){if(!t)return!1;let a=t.clientX-y(this,r,"f").x+scrollX,o=t.clientY-y(this,r,"f").y+scrollY;return a>=e&&a<=e+s&&o>=i&&o<=i+n},u=function(){const t=y(this,l,"f")?0:x.stringWidth(y(this,o,"f").text??"")+12,e=y(this,l,"f")?0:20;m(this,h,{x:y(this,o,"f").x+t>y(this,c,"f").width?y(this,c,"f").width-t:y(this,o,"f").x<0?y(this,c,"f").width+y(this,o,"f").x-t:y(this,o,"f").x,y:y(this,o,"f").y+e>y(this,c,"f").height?y(this,c,"f").height-e:y(this,o,"f").y<0?y(this,c,"f").height+y(this,o,"f").y-e:y(this,o,"f").y,width:t,height:e},"f")}},409:function(t,e,i){var s,n=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),o=0;o<i.length;o++)"default"!==i[o]&&n(e,t,i[o]);return a(e,t),e});Object.defineProperty(e,"__esModule",{value:!0}),e.Theme=void 0;const r=o(i(10)),h=i(226),l=i(869);class c{static initialize(t,e){!c.function&&e&&(c.function=e),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(!c.function||c.function())?c.setTheme(1):c.setTheme(0),window.matchMedia("(prefers-color-scheme: dark)").addEventListener(l.Events.Change,e=>{c.setTheme(!e.matches||c.function&&!c.function()?0:1),t()})}static setTheme(t){c.currentTheme=t,c.text=h.ThemeOptions.colors[t],c.background=h.ThemeOptions.backgrounds[t],c.line=h.ThemeOptions.lines[t],c.lineAxis=h.ThemeOptions.lineAxes[t],c.lineActive=h.ThemeOptions.lineActives[t],c.dropdownItemHoverColor=r.adjustColor(c.background,0==t?-50:50),c.dropdownBorder=h.ThemeOptions.dropdownBorders[t],c.canvasBackground=h.ThemeOptions.canvasBackgrounds[t],c.canvasBackgroundInt=Number(`0xff${c.canvasBackground.slice(1)}`)}static reset(){this.function=void 0}}e.Theme=c,c.currentTheme=0},427:function(t,e,i){var s,n,a,o,r,h,l,c,d,f,u,v,p=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),g=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),m=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&p(e,t,i[n]);return g(e,t),e}),y=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},w=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};Object.defineProperty(e,"__esModule",{value:!0}),e.CircularRenderer=void 0;const b=i(459),x=i(510),T=i(138),M=m(i(10)),P=i(359),C=i(409),S=i(601),A=i(12),_=i(743),O=i(804),D=i(147),k=i(897),E=i(168),I=i(828),j=i(869),R=m(i(797)),L=i(283),W=i(230);class B extends b.Renderer{constructor(t){super(t),n.set(this,void 0),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),h.set(this,void 0),l.set(this,void 0),c.set(this,void 0),d.set(this,void 0),f.set(this,void 0),u.set(this,void 0),v.set(this,void 0),this.startAngle=Math.PI/4,this.isMousePositionChanged=!1,this.prevPoint={x:0,y:0},this.onMouseMoveEvent=new MouseEvent(j.Events.MouseMove)}calculateAngles(){const t=this.data.values.reduce((t,e)=>t+e.current,0);let e=this.startAngle;y(this,f,this.data.values.flatMap(i=>{const s=i.current/t*2*Math.PI;return{id:i.id,value:s,sum:(e+=s)-s}}).reverse(),"f")}getAngle(t){return w(this,f,"f").find(e=>e.id==t.id)?.value??0}getAccumulator(t){return w(this,f,"f").find(e=>e.id==t.id)?.sum??this.startAngle}calculatePoint(t){let e=this.getAccumulator(t);const i=(t,i,s)=>({x:s.x+t*Math.cos(e+i),y:s.y+t*Math.sin(e+i)});y(this,d,i(w(this,o,"f"),0,w(this,c,"f")),"f");const s=this.getAngle(t);t.direction=e+s/2;let n=i(w(this,o,"f"),s,w(this,c,"f")),r=[];if(s>0){if(t.current>0){let e=i(w(this,o,"f")+10,s/2,w(this,c,"f")),n=i(w(this,o,"f")+20,s/2,w(this,c,"f"));const a=e.x>w(this,c,"f").x?1:-1;let r={x:n.x+10*a,y:n.y};t.labelPoints=[new W.DrawPoint(j.DrawPointType.Move,e.x,e.y),new W.DrawPoint(j.DrawPointType.QuadraticCurve,n.x,n.y,r.x,r.y)]}w(this,a,"f")||r.push(new W.DrawPoint(j.DrawPointType.Move,w(this,c,"f").x,w(this,c,"f").y)),r.push(new W.DrawPoint(j.DrawPointType.Line,w(this,d,"f").x,w(this,d,"f").y));let h=0,l=s;for(;l>0;){let t=l-Math.PI/6>0?Math.PI/6:l;n=i(w(this,o,"f"),h+t,w(this,c,"f"));const e=Math.PI-t,s=i(w(this,o,"f")/Math.sin(e/2),h+t/2,w(this,c,"f"));r.push(new W.DrawPoint(j.DrawPointType.QuadraticCurve,s.x,s.y,n.x,n.y)),h+=t,l-=Math.PI/6}if(w(this,a,"f")||0!=t.innerRadius){const e=w(this,o,"f")*(t.innerRadius/100),a={x:n.x-(w(this,o,"f")-e)*(n.x-w(this,c,"f").x)/w(this,o,"f"),y:n.y-(w(this,o,"f")-e)*(n.y-w(this,c,"f").y)/w(this,o,"f")};for(r.push(new W.DrawPoint(j.DrawPointType.Line,a.x,a.y)),l=0,h=s;l<s;){let t=l+Math.PI/6<s?Math.PI/6:s-l;n=i(e,h-t,w(this,c,"f"));const a=Math.PI-t,o=i(e/Math.sin(a/2),h-t/2,w(this,c,"f"));r.push(new W.DrawPoint(j.DrawPointType.QuadraticCurve,o.x,o.y,n.x,n.y)),h-=t,l+=Math.PI/6}n=i(w(this,o,"f"),s,w(this,c,"f"))}e+=s}return y(this,d,n,"f"),t.points=r,t}scale(t,e,i){const s=w(this,c,"f").x+w(this,o,"f")/2*Math.cos(t.direction),n=w(this,c,"f").y+w(this,o,"f")/2*Math.sin(t.direction);for(let a of t.points)for(let t=0;t<a.args.length;t+=2){const o=a.base[t],r=a.base[t+1],h=Math.sqrt(Math.pow(o-s,2)+Math.pow(r-n,2)),l=(h*e+h*(1-e)*i)/h;a.args[t]=l*o+(1-l)*s,a.args[t+1]=l*r+(1-l)*n}for(let a of t.labelPoints)for(let t=0;t<a.args.length;t+=2){const o=a.base[t],r=a.base[t+1],h=Math.sqrt(Math.pow(o-s,2)+Math.pow(r-n,2)),l=(h*e+h*(1-e)*i)/h;a.args[t]=l*o+(1-l)*s,a.args[t+1]=l*r+(1-l)*n}}focus(t,e,i){t.color=M.applyAlpha(t.baseColor,255-255*e*i),t.textColor=M.applyAlpha(C.Theme.text,255-255*e*i)}translate(t,e,i){const s=(w(this,c,"f").x+w(this,o,"f")*Math.cos(t.direction)-w(this,c,"f").x)*e,n=(w(this,c,"f").y+w(this,o,"f")*Math.sin(t.direction)-w(this,c,"f").y)*e;t.translate={x:s*i,y:n*i};for(let e of t.points)for(let t=0;t<e.args.length;t+=2)e.args[t]=e.base[t]+s*i,e.args[t+1]=e.base[t+1]+n*i;for(let e of t.labelPoints)for(let t=0;t<e.args.length;t+=2)e.args[t]=e.base[t]+s*i,e.args[t+1]=e.base[t+1]+n*i}outline(t,e,i){t.lineStyles=0==i?{lineWidth:1,lineJoin:"miter",lineCap:"butt"}:{lineWidth:this.getAngle(t)>Math.PI/6?e*i:1,lineJoin:"round",lineCap:"round"}}canRenderLabel(t,e){if(0==t.current)return t.canRenderLabel=!1;if(t.state==j.AnimationType.None&&t.canRenderLabel)return t.canRenderLabel;const i=t.labelPoints[0].args[0]<t.labelPoints[1].args[0]?1:-1;let s=!1;const n=t.labelPoints[1].args[0],a=t.labelPoints[1].args[1],o=M.stringWidth(t.label),r=1==i?n+12:n-o-12+(t.translate?t.translate.x:0),h=a-12+(t.translate?t.translate.y:0),l=new Uint32Array(e.getImageData(r,h,o,28).data.buffer);if((r<0||r+o>this.canvas.width||a-12<0||a+12>this.canvas.height)&&(s=!0),!s)for(let t=0;t<l.length;t++)if(E.Canvas.isPixelBusy(l[t])){s=!0;break}return t.canRenderLabel=!s}drawLabel(t,e){if(!this.canRenderLabel(t,e))return;e.beginPath(),e.moveTo(t.labelPoints[0].args[0],t.labelPoints[0].args[1]),e.quadraticCurveTo(t.labelPoints[1].args[0],t.labelPoints[1].args[1],t.labelPoints[1].args[2],t.labelPoints[1].args[3]),e.strokeStyle=t.textColor,0!=t.current&&t.current!=t.value&&(e.strokeStyle=M.applyAlpha(t.textColor,Math.round(t.current/t.value*255))),e.lineWidth=1,e.lineJoin="miter",e.lineCap="butt",e.stroke(),e.fillStyle=t.textColor,0!=t.current&&t.current!=t.value&&(e.fillStyle=M.applyAlpha(t.textColor,Math.round(t.current/t.value*255)));const i=t.labelPoints[0].args[0]<t.labelPoints[1].args[0]?1:-1;S.TextStyles.circularLabel(e,1==i),e.fillText(t.label,t.labelPoints[1].args[0]+16*i,t.labelPoints[1].args[1]+4)}drawSector(t,e){e.beginPath(),t.lineStyles&&(e.lineWidth=t.lineStyles.lineWidth,e.lineJoin=t.lineStyles.lineJoin,e.lineCap=t.lineStyles.lineCap);for(const i of t.points)switch(i.type){case j.DrawPointType.Move:e.moveTo(i.args[0],i.args[1]);break;case j.DrawPointType.Line:e.lineTo(i.args[0],i.args[1]);break;case j.DrawPointType.QuadraticCurve:e.quadraticCurveTo(i.args[0],i.args[1],i.args[2],i.args[3])}e.fillStyle=t.color,e.strokeStyle=t.color,e.closePath(),e.fill(),e.stroke()}animate(t){this.animations.handle(t.id,j.AnimationType.Init,{duration:R.Animations.circular+(this.data.values.indexOf(t)+1)/this.data.values.length*R.Animations.circular,continuous:!0,before:()=>t.state==j.AnimationType.Init,body:e=>{this.scale(t,.7,e),this.focus(t,1,1-e),1==e&&(t.state=j.AnimationType.None)}}),this.animations.handle(t.id,j.AnimationType.Click,{duration:0,before:()=>t.state==j.AnimationType.Click,body:e=>{this.translate(t,.1,1),this.outline(t,8,1)}}),this.animations.handle(t.id,j.AnimationType.MouseOver,{duration:R.Animations.circular,before:()=>t.state.isAnyEquals(j.AnimationType.MouseOver,j.AnimationType.MouseLeave),body:e=>{t.color!=t.baseColor&&this.focus(t,.5,e),this.translate(t,.1,e),this.outline(t,8,e),t.state==j.AnimationType.MouseLeave&&this.data.values.filter(t=>t.state==j.AnimationType.MouseOver).length>0&&this.animations.end(t.id,j.AnimationType.AnotherItemOver)}}),this.animations.handle(t.id,j.AnimationType.AnotherItemOver,{duration:R.Animations.circular,before:()=>t.state.isAnyEquals(j.AnimationType.AnotherItemOver,j.AnimationType.AnotherItemLeave),body:e=>{this.focus(t,.5,e)}})}handle(t){var e;if(t.disabled)return;const i=this.isInsideSector(this.onMouseMoveEvent,t,w(this,c,"f")),s=!!this.onClickEvent&&this.isInsideSector(this.onClickEvent,t,w(this,c,"f"));if(this.onMouseMoveEvent&&i&&(y(this,h,t.id,"f"),y(this,r,(e=w(this,r,"f"),++e),"f")),1!=this.data.values.filter(t=>!t.disabled).length){if(s)return t.state=j.AnimationType.Click,w(this,l,"f").includes(t.id)?y(this,l,w(this,l,"f").filter(e=>e!=t.id),"f"):w(this,l,"f").push(t.id),void(this.onClickEvent=void 0);if(!w(this,l,"f").includes(t.id)){if(i)return t.state=j.AnimationType.MouseOver,void(this.animations.isBackward(t.id,j.AnimationType.MouseOver)&&this.animations.reverse(t.id,j.AnimationType.MouseOver));if(t.state==j.AnimationType.MouseOver&&!i)return t.state=j.AnimationType.MouseLeave,void(this.animations.isBackward(t.id,j.AnimationType.MouseOver)||this.animations.reverse(t.id,j.AnimationType.MouseOver));if(t.state==j.AnimationType.MouseLeave&&this.animations.isEnd(t.id,j.AnimationType.MouseOver))t.state=j.AnimationType.None;else if(t.state!=j.AnimationType.MouseLeave)return this.data.values.filter(t=>t.state==j.AnimationType.MouseOver).length>0?(t.state=j.AnimationType.AnotherItemOver,void(this.animations.isBackward(t.id,j.AnimationType.AnotherItemOver)&&this.animations.reverse(t.id,j.AnimationType.AnotherItemOver))):this.data.values.filter(t=>t.state==j.AnimationType.MouseLeave).length>0?(t.state=j.AnimationType.AnotherItemLeave,void(this.animations.isBackward(t.id,j.AnimationType.AnotherItemOver)||this.animations.reverse(t.id,j.AnimationType.AnotherItemOver))):void(t.state==j.AnimationType.AnotherItemLeave&&this.animations.isEnd(t.id,j.AnimationType.AnotherItemOver)&&(t.state=j.AnimationType.None))}}}render(){super.render();const t=this.data.values.filter(t=>t.value!=t.current&&0!=t.current).length>0;if(this.isMousePositionChanged=this.prevPoint.x!=this.onMouseMoveEvent.clientX||this.prevPoint.y!=this.onMouseMoveEvent.clientY,this.prevPoint={x:this.onMouseMoveEvent.clientX,y:this.onMouseMoveEvent.clientY},t){this.calculateAngles();for(let t of this.data.values)t=this.calculatePoint(t)}if(0==this.data.values.filter(t=>!t.disabled).length)return void this.empty();y(this,r,0,"f");const e=E.Canvas.getContext(this.canvas);for(const t of this.data.values)this.animate(t),this.drawSector(t,e),this.drawLabel(t,e),t.state!=j.AnimationType.Init&&this.handle(t);super.renderDropdown();const i=this.data.values.find(t=>t.id==w(this,h,"f")),s=w(this,r,"f")>0;s||this.contextMenu?this.renderContextMenu(i?.data??{}):this.onContextMenuEvent=void 0,this.tooltip.render(s&&!this.dropdown?.isActive,this.onMouseMoveEvent,[new A.TooltipValue(`${i?.label}: ${I.Formatter.format(i?.current,j.PlotAxisType.Number,this.settings.valuePostfix)}`)],i),this.innerTitle(),this.canvas.style.cursor=w(this,r,"f")>0?L.Styles.Cursor.Pointer:L.Styles.Cursor.Default,this.isDestroy||requestAnimationFrame(this.render.bind(this))}isInsideSector(t,e,i){if(!this.isMousePositionChanged)return e.isMouseInside;const s=t=>t.x*t.x+t.y*t.y<=w(this,o,"f")*w(this,o,"f")&&(!w(this,a,"f")||t.x*t.x+t.y*t.y>=w(this,o,"f")*(e.innerRadius/100)*w(this,o,"f")*(e.innerRadius/100)),n=this.getMousePosition(t),r={x:n.x-i.x,y:n.y-i.y},h={x:n.x-i.x-e.translate?.x,y:n.y-i.y-e.translate?.y};return e.isMouseInside=(t=>{let s=Math.atan2(t.y-i.y,t.x-i.x);s<0&&(s+=2*Math.PI),s<this.startAngle&&(s=2*Math.PI-Math.abs(this.startAngle-s)+this.startAngle);let n=w(this,f,"f").findIndex(t=>t.id==e.id),a=w(this,f,"f")[n].sum;return!this.dropdown?.isActive&&a<=s&&a+w(this,f,"f")[n].value-s>=0})(n)&&(s(r)||s(h))}empty(){const t=E.Canvas.getContext(this.canvas);t.beginPath(),t.arc(w(this,c,"f").x,w(this,c,"f").y,w(this,o,"f"),0,2*Math.PI),t.strokeStyle=C.Theme.text,t.stroke(),S.TextStyles.regular(t),t.fillText(D.TextResources.allDataIsHidden,w(this,c,"f").x,w(this,c,"f").y),requestAnimationFrame(this.render.bind(this))}innerTitle(){if(w(this,n,"f")){const t=E.Canvas.getContext(this.canvas);w(this,v,"f").call(this,t),t.fillText(this.data.innerTitle,w(this,c,"f").x,w(this,c,"f").y)}}calculateSizes(){const t=this.settings.title?R.Values.titleOffset:0,e=this.canvas.width>this.canvas.height-2*t?this.canvas.height-2*t:this.canvas.width;y(this,c,{x:this.canvas.width/2,y:t+this.canvas.height/2},"f");let i=0;for(const t of this.data.values){const e=M.stringWidth(t.label);e>i&&(i=e)}y(this,o,e/2-(i+50),"f"),w(this,o,"f")<e/2-50&&y(this,o,e/2-50,"f"),null!=this.data.innerTitle&&""!=this.data.innerTitle&&(y(this,v,S.TextStyles.large,"f"),y(this,n,M.stringWidth(this.data.innerTitle,16)<this.data.innerRadius/100*w(this,o,"f")*2,"f"),w(this,n,"f")||(y(this,v,S.TextStyles.regular,"f"),y(this,n,M.stringWidth(this.data.innerTitle,14)<this.data.innerRadius/100*w(this,o,"f")*2,"f")),w(this,n,"f")||console.warn("Inner title is declared, but can't be rendered"))}refresh(){super.refresh(),this.dropdown?.refresh()}resize(){super.resize(),this.initAnimations(),this.calculateSizes(),this.dropdown?.resize();for(let t of this.data.values)t=this.calculatePoint(t)}prepareSettings(){super.prepareSettings(),this.calculateSizes(),this.data.values=this.data.values.map(t=>new T.Sector(t)),this.settings.enableOther&&(this.settings.contextMenu?this.settings.contextMenu.push({isDivider:!0}):this.settings.contextMenu=[],this.settings.contextMenu.push({text:D.TextResources.show,condition:t=>t?._other,action:()=>{new k.Modal(_.Decomposition.toChart(this.settings,w(this,u,"f")),{width:.8*window.innerWidth,height:.8*window.innerHeight},D.TextResources.other).open()}})),y(this,l,[],"f"),y(this,a,0!=(this.data.innerRadius??0),"f");for(let t of this.data.values)t.disabled=!t.value,t.value??=0,t.current=t.value,t.innerRadius??=this.data.innerRadius??0,t.value<0&&console.warn(`"${t.label}" has negative value (${t.value}) and will not be render`);if(this.data.values=this.data.values.filter(t=>t.value>=0),this.settings.enableOther&&this.data.values.length>20){y(this,u,this.data.values.splice(20),"f");const t=w(this,u,"f").reduce((t,e)=>t+e.current,0);this.data.values=this.data.values.slice(0,20),this.data.values.push(new T.Sector({value:t,current:t,label:D.TextResources.other,id:M.guid(),color:w(this,u,"f")[w(this,u,"f").length-1].color,innerRadius:this.data.innerRadius,data:{_other:!0}}))}this.calculateAngles();for(let t of this.data.values)t=this.calculatePoint(t),t.textColor=C.Theme.text,t.state=this.settings.disableInitAnimation?j.AnimationType.None:j.AnimationType.Init}initDropdown(){super.initDropdown(),this.dropdown=new P.Dropdown(this.canvas,{x:-10,y:10,icon:j.Icon.ThreeLines,items:[{text:D.TextResources.exportPNG,action:()=>{O.Export.asPng(this.canvas,this.settings.title)}},{text:D.TextResources.exportCSV,action:()=>{O.Export.asCsv(_.Decomposition.toTable(x.CircularData.getRows(this.data)),this.settings.title)}},{isDivider:!0},{text:D.TextResources.decomposeToTable,action:()=>{new k.Modal(_.Decomposition.toTable(x.CircularData.getRows(this.data)),void 0,this.settings.title??D.TextResources.dataAsTable).open()}}]})}}e.CircularRenderer=B,n=new WeakMap,a=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,f=new WeakMap,u=new WeakMap,v=new WeakMap},459:function(t,e,i){var s,n,a,o=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),r=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),h=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&o(e,t,i[n]);return r(e,t),e}),l=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=void 0;const c=i(688),d=h(i(10)),f=i(927),u=i(359),v=i(147),p=i(168),g=i(601),m=i(869),y=h(i(797));class w extends c.Renderable{constructor(t){super(t),n.add(this),this.isDestroy=!1,this.highlightItems=[],this.state=this.settings.disableInitAnimation?m.RenderState.Idle:m.RenderState.Init}render(){super.render(),this.renderTitle()}destroy(){this.isDestroy=!0,this.canvas.remove()}renderDropdown(){this.onClickEvent=this.dropdown?.render(this.onMouseMoveEvent,this.onClickEvent)}resize(){l(this,n,"m",a).call(this),this.tooltip.refresh(),this.dropdown?.resize()}prepareSettings(){this.data=this.settings.data;const t=this.node.parentElement.getBoundingClientRect();this.settings.minWidth=isNaN(+this.settings.width)?0:+this.settings.width,this.settings.minHeight=isNaN(+this.settings.height)?0:+this.settings.height,this.settings.width=0!=this.settings.minWidth&&t.width<this.settings.minWidth?this.settings.minWidth:t.width,this.settings.height=0!=this.settings.minHeight&&t.height<this.settings.minHeight?this.settings.minHeight:t.height,this.canvas.width=this.settings.width,this.canvas.height=this.settings.height;for(let t of this.settings.data.values)t.id=d.guid(),t.label??=v.TextResources.noLabel;this.calculateColors();for(let t of this.settings.contextMenu??[])null!=t.id&&(t.action=e=>this.node.dispatchEvent(new CustomEvent(t.id??"",{detail:e})))}calculateColors(t=!1){const e=this.settings.baseColor??d.randomColor();let i=Math.round(100/this.settings.data.values.length),s=-50;i<=1&&(i=1);for(let n of this.settings.data.values)(null==n.color||t)&&(n.color=d.adjustColor(e,s+=i))}initDropdown(){}renderContextMenu(t){if(this.dropdown?.isActive)return this.onContextMenuEvent=void 0,!1;if(null!=this.onContextMenuEvent&&0!=this.settings.contextMenu?.length){if(null==this.contextMenu&&null!=this.settings.contextMenu){let e=[];for(const i of this.settings.contextMenu)i.condition&&!i.condition(t)||e.push({id:i.id,text:i.text,isDivider:i.isDivider,action:()=>{i.action(t),this.onContextMenuEvent=void 0,this.contextMenu=void 0}});this.contextMenu=new u.Dropdown(this.canvas,{x:this.onContextMenuEvent.x-this.canvasPosition.x,y:this.onContextMenuEvent.y-this.canvasPosition.y,items:e,data:t}),this.contextMenu.resize(),this.onClickEvent=void 0}const e=null!=this.onClickEvent;if(this.onClickEvent=this.contextMenu?.render(this.onMouseMoveEvent,this.onClickEvent),null==this.onClickEvent&&e)return this.contextMenu=void 0,this.onContextMenuEvent=void 0,!0}return!1}highlight(t){this.highlightItems=t?[t.id]:[]}closeDropdowns(){this.dropdown?.close(),this.onContextMenuEvent=void 0}renderTitle(){const t=p.Canvas.getContext(this.canvas);this.settings.title&&(g.TextStyles.title(t),t.fillText(this.settings.title,this.canvas.width/2,y.Values.titleOffset))}getMousePosition(t){return{x:t.clientX-this.canvasPosition.x+scrollX,y:t.clientY-this.canvasPosition.y+scrollY}}applySettings(t){this.settings=t}}e.Renderer=w,n=new WeakSet,a=function(){let t=this.node.getBoundingClientRect();this.settings.width=this.settings.minWidth&&t.width<this.settings.minWidth?this.settings.minWidth:t.width,this.settings.height=this.settings.minHeight&&t.height<this.settings.minHeight?this.settings.minHeight:t.height,this.canvas.width=this.settings.width,this.canvas.height=this.settings.height,this.settings.enableLegend&&(null!=this.settings.legendPlace&&this.settings.legendPlace!=m.LegendPlace.Top&&this.settings.legendPlace!=m.LegendPlace.Bottom||(this.canvas.height-=f.Legend.getLegendHeight(this.settings.data.values,this.canvas.width)),this.settings.legendPlace!=m.LegendPlace.Left&&this.settings.legendPlace!=m.LegendPlace.Right||(this.canvas.width-=500))}},495:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TreeData=void 0,e.TreeData=class{static getRows(t){const e="Value";let i=[];for(const s of t.values)i.push({name:s.label,values:new Map([[e,s.value]])});return{headers:[{value:e,display:e}],values:i}}}},510:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CircularData=void 0,e.CircularData=class{static getRows(t){const e="Value";let i=[];for(const s of t.values)i.push({name:s.label,values:new Map([[e,s.value]])});return{headers:[{value:e,display:e}],values:i}}}},527:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Value=void 0,e.Value=class{toggle(t){0==t&&(this.disabled=!this.disabled)}checkCondition(){return!1}reset(){this.disabled=!1}}},557:function(t,e,i){var s,n,a,o,r,h,l,c,d,f,u,v,p,g,m,y,w,b,x,T,M,P=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),C=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),S=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&P(e,t,i[n]);return C(e,t),e}),A=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},_=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i};Object.defineProperty(e,"__esModule",{value:!0}),e.PlotRenderer=void 0;const O=i(268),D=i(459),k=S(i(10)),E=i(359),I=i(902),j=i(183),R=i(409),L=i(601),W=i(12),B=i(804),F=i(743),N=i(897),V=i(147),$=i(828),H=i(168),z=i(869),G=S(i(797));class q extends D.Renderer{constructor(t){super(t),n.add(this),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),h.set(this,void 0),l.set(this,void 0),c.set(this,void 0),d.set(this,void 0),f.set(this,void 0),u.set(this,void 0),v.set(this,void 0),p.set(this,void 0),g.set(this,void 0),m.set(this,void 0),y.set(this,void 0)}render(){super.render();let t=[new W.TooltipValue(A(this,c,"f").get(Math.round(A(this,h,"f")))??A(this,d,"f").get(Math.round(A(this,l,"f"))))];const e=H.Canvas.getContext(this.canvas);L.TextStyles.regular(e),e.lineJoin="round";const i=R.Theme.lineActive;A(this,n,"m",T).call(this),A(this,n,"m",x).call(this,!0);let s=0,v=0,p=0,g=0,M=0;const P=this.data.values.filter(t=>!t.disabled);let C=0,S=P.filter(t=>t.type==z.PlotType.Column).length,O=0,D=P.filter(t=>t.type==z.PlotType.Bar).length,E=[];for(let t=0;t<A(this,u,"f").length;t++)E.push(0);for(const c of P){e.beginPath(),e.strokeStyle=c.color,e.fillStyle=c.color,e.lineWidth=c.width,e.lineCap="round";const d=0!=this.highlightItems.length;if(!this.animations.contains(c.id,z.AnimationType.Init)){const t=(t,i)=>{if(this.animations.reload(c.id,i),0==t)return;let s=Math.round(255-127*t).toString(16);s.length<2&&(s=0+s),e.fillStyle=c.color+s,e.strokeStyle=c.color+s};d&&!this.highlightItems.includes(c.id)?this.animations.handle(c.id,z.AnimationType.AnotherItemOver,{duration:G.Animations.circular,body:e=>{t(e,z.AnimationType.AnotherItemLeave)}}):d||this.animations.handle(c.id,z.AnimationType.AnotherItemLeave,{timer:G.Dates.minDate,duration:G.Animations.circular,backward:!0,body:e=>{t(e,z.AnimationType.AnotherItemOver)}})}switch(c.lineType){case z.LineType.Dash:e.setLineDash([3*c.width,2*c.width]);break;case z.LineType.Dotted:e.setLineDash([c.width,c.width]);case z.LineType.Solid:}for(const i of c.values){let x=c.values.indexOf(i),T=A(this,f,"f").indexOf(this.data.xType==z.PlotAxisType.Date?i.x?.toString():i.x),P=A(this,u,"f").indexOf(i.y);const k=()=>({x:$.Formatter.format(i.x,this.data.xType),y:$.Formatter.format(i.y,this.data.xType,this.settings.valuePostfix)});switch(s=A(this,r,"f").left,c.type!=z.PlotType.Bar&&(s+=T*A(this,a,"f").step),c.type==z.PlotType.Line&&(s-=A(this,a,"f").step/2-A(this,a,"f").step),c.type){case z.PlotType.Line:v=A(this,r,"f").top+A(this,m,"f").height-i.y/A(this,o,"f").unit*A(this,o,"f").step-Math.abs(A(this,o,"f").min/A(this,o,"f").unit*A(this,o,"f").step);const f=1500/c.values.length*1.2;if(this.state==z.RenderState.Init||this.animations.contains(i.id,z.AnimationType.Init))this.animations.handle(i.id,z.AnimationType.Init,{timer:new Date(Date.now()).addMilliseconds(f*(x-1)),duration:f,continuous:!0,body:t=>{if(0==x)return;s=A(this,r,"f").left+T*A(this,a,"f").step-A(this,a,"f").step/2,v=A(this,r,"f").top+A(this,m,"f").height-i.y/A(this,o,"f").unit*A(this,o,"f").step-Math.abs(A(this,o,"f").min/A(this,o,"f").unit*A(this,o,"f").step);const n=c.values[x-1];let h={x:A(this,r,"f").left+T*A(this,a,"f").step-A(this,a,"f").step/2,y:A(this,r,"f").top+A(this,m,"f").height-n.y/A(this,o,"f").unit*A(this,o,"f").step-Math.abs(A(this,o,"f").min/A(this,o,"f").unit*A(this,o,"f").step)};const l=h.x+(A(this,a,"f").step+(s-h.x))*t,d=h.y+(v-h.y)*t;h.x!=l&&h.y!=d&&(e.moveTo(h.x,h.y),e.lineTo(l,d))}});else if(e.lineTo(s,v),A(this,n,"m",w).call(this,s)){const e=this.getMousePosition(this.onMouseMoveEvent);Math.abs(e.y-v)<5&&(_(this,y,{x:s,y:v,index:x,data:i.data,series:c},"f"),t.push(new W.TooltipValue(`${c.label}: ${k().y}`,c.color)),_(this,h,s-A(this,a,"f").step/2,"f"))}break;case z.PlotType.AttentionLine:p=this.canvas.height-A(this,r,"f").bottom-i.y/A(this,o,"f").unit*A(this,o,"f").step,e.moveTo(A(this,r,"f").left,p),this.state==z.RenderState.Init||this.animations.contains(i.id,z.AnimationType.Init)?this.animations.handle(i.id,z.AnimationType.Init,{duration:1500,continuous:!0,body:t=>{e.lineTo(A(this,r,"f").left+(this.canvas.width-A(this,r,"f").left-A(this,r,"f").right)*t,this.canvas.height-A(this,r,"f").bottom-i.y/A(this,o,"f").unit*A(this,o,"f").step)}}):e.lineTo(this.canvas.width-A(this,r,"f").right,p);break;case z.PlotType.Column:p=i.y>this.data.yMax?this.data.yMax:i.y,v=A(this,m,"f").height*p/A(this,o,"f").max,v<A(this,o,"f").minStep&&(v=A(this,o,"f").minStep),M=A(this,a,"f").step*(c.width?c.width/100:.5)/S,e.beginPath(),this.state==z.RenderState.Init||this.animations.contains(i.id+C,z.AnimationType.Init)?this.animations.handle(i.id+C,z.AnimationType.Init,{duration:800,continuous:!0,body:t=>{p=i.y>this.data.yMax?this.data.yMax:i.y,s=A(this,r,"f").left+T*A(this,a,"f").step,v=A(this,m,"f").height*p/A(this,o,"f").max*t,v<A(this,o,"f").minStep&&(v=A(this,o,"f").minStep*t),C=this.data.values.filter(t=>t.type==z.PlotType.Column).indexOf(c),e.roundRect(s+C*M+(A(this,a,"f").step-S*M)/2,this.canvas.height-A(this,r,"f").bottom-v,M,v,[6,6,0,0]),e.fill()}}):(!A(this,n,"m",b).call(this,s+C*M+(A(this,a,"f").step-S*M)/2,this.canvas.height-A(this,r,"f").bottom-v,M,v)||null!=this.contextMenu?.isActive&&0!=this.contextMenu?.isActive||(_(this,y,{x:s,y:v,index:x,data:i.data,series:c},"f"),t.push(new W.TooltipValue(`${c.label}: ${k().y}`,c.color)),_(this,h,s,"f")),e.roundRect(s+C*M+(A(this,a,"f").step-S*M)/2,this.canvas.height-A(this,r,"f").bottom-v,M,v,[6,6,0,0]),e.fill());break;case z.PlotType.Bar:v=A(this,r,"f").top+P*A(this,o,"f").step+A(this,o,"f").step/2+(100-c.width)*A(this,o,"f").step/100/2;const u=c.width*A(this,o,"f").step/100/D;this.state==z.RenderState.Init||this.animations.contains(i.id+O,z.AnimationType.Init)?this.animations.handle(i.id+O,z.AnimationType.Init,{duration:800,continuous:!0,body:t=>{v=A(this,r,"f").top+P*A(this,o,"f").step+A(this,o,"f").step/2+(100-c.width)*A(this,o,"f").step/100/2,O=this.data.values.filter(t=>t.type==z.PlotType.Bar).indexOf(c),e.fillRect(s,v-A(this,o,"f").step/2+O*u,i.x/A(this,a,"f").unit*A(this,a,"f").step*t,u)}}):(d||(A(this,n,"m",b).call(this,s,v-A(this,o,"f").step/2+O*u,i.x/A(this,a,"f").unit*A(this,a,"f").step,u)?(_(this,y,{x:s,y:v,index:x,data:i.data,series:c},"f"),e.fillStyle+="88",t.push(new W.TooltipValue(`${c.label}: ${k().x}`,c.color)),_(this,l,v-A(this,o,"f").step/2,"f")):e.fillStyle=c.color),e.fillRect(s,v-A(this,o,"f").step/2+O*u,i.x/A(this,a,"f").unit*A(this,a,"f").step,u));break;case z.PlotType.StackingColumn:if(v=this.canvas.height-A(this,r,"f").bottom-i.y/A(this,o,"f").unit*A(this,o,"f").step,M=A(this,a,"f").step*(c.width?c.width/100:.5),this.state==z.RenderState.Init||this.animations.contains(i.id+x,z.AnimationType.Init))this.animations.handle(i.id+x,z.AnimationType.Init,{duration:800,continuous:!0,body:t=>{C=this.data.values.filter(t=>t.type==z.PlotType.StackingColumn&&t.values.filter(t=>this.data.xType==z.PlotAxisType.Date?t.x.getTime()==i.x.getTime():t.x==i.x).length>0).indexOf(c),s=A(this,r,"f").left+T*A(this,a,"f").step,v=this.canvas.height-A(this,r,"f").bottom-i.y/A(this,o,"f").unit*A(this,o,"f").step,0==C&&(E[T]=0);let n=null!=E[T]?E[T]:0;p=this.canvas.height-A(this,r,"f").bottom+n,g=(v-this.canvas.height+A(this,r,"f").bottom)*t,p>A(this,r,"f").top&&(p+g<A(this,r,"f").top&&(g-=p+g-A(this,r,"f").top),e.fillRect(s+(A(this,a,"f").step-M)/2,p,M,g)),E[T]+=(v-this.canvas.height+A(this,r,"f").bottom)*t}});else{0==C&&(E[T]=0);let o=null!=E[T]?E[T]:0;p=this.canvas.height-A(this,r,"f").bottom+o,g=v-this.canvas.height+A(this,r,"f").bottom,p>A(this,r,"f").top&&(p+g<A(this,r,"f").top&&(g-=p+g-A(this,r,"f").top),A(this,n,"m",b).call(this,s+(A(this,a,"f").step-M)/2,p+g,M,Math.abs(g))&&(_(this,y,{x:s,y:v,index:T,data:i.data,series:c},"f"),t.push(new W.TooltipValue(`${c.label}: ${k().y}`,c.color)),_(this,h,s,"f")),e.fillRect(s+(A(this,a,"f").step-M)/2,p,M,g)),E[T]+=v-this.canvas.height+A(this,r,"f").bottom}}}switch(e.setLineDash([]),c.type){case z.PlotType.Line:if(e.stroke(),A(this,y,"f")&&A(this,y,"f").series==c){e.beginPath(),e.lineWidth=1,e.strokeStyle=i,e.moveTo(A(this,r,"f").left,A(this,y,"f").y),e.lineTo(this.canvas.width-A(this,r,"f").right,A(this,y,"f").y),e.stroke();let t=Math.round(1.1*c.width);t<5&&(t=5),e.beginPath(),e.arc(A(this,y,"f").x,A(this,y,"f").y,t,0,2*Math.PI),e.fill(),e.lineWidth=Math.ceil(t/2),e.strokeStyle=k.adjustColor(c.color,50),e.stroke()}break;case z.PlotType.AttentionLine:e.stroke(),L.TextStyles.regular(e),e.fillText(c.label,A(this,r,"f").left+(this.canvas.width-A(this,r,"f").left-A(this,r,"f").right)/2,this.canvas.height-A(this,r,"f").bottom-c.values[0].y/A(this,o,"f").unit*A(this,o,"f").step+16);break;case z.PlotType.Column:case z.PlotType.StackingColumn:A(this,y,"f")&&this.highlight(A(this,y,"f").series),C++;break;case z.PlotType.Bar:A(this,y,"f")&&(e.lineWidth=1,e.strokeStyle=i,e.moveTo(A(this,r,"f").left,A(this,l,"f")+A(this,o,"f").step/2),e.lineTo(this.canvas.width-A(this,r,"f").right,A(this,l,"f")+A(this,o,"f").step/2),e.stroke()),O++}}A(this,n,"m",x).call(this),this.renderTitle(),this.tooltip.render(t.length>1&&!this.dropdown?.isActive,this.onMouseMoveEvent,t,A(this,y,"f")?A(this,y,"f").series.values[A(this,y,"f").index]:void 0),this.isDestroy||requestAnimationFrame(this.render.bind(this)),this.state=z.RenderState.Idle,super.renderDropdown(),this.onContextMenuEvent&&!A(this,y,"f")&&(this.onContextMenuEvent=void 0),null==A(this,y,"f")&&this.highlight(),!A(this,y,"f")||!this.renderContextMenu(A(this,y,"f").data)&&this.onContextMenuEvent||_(this,y,void 0,"f")}refresh(){super.refresh()}resize(){super.resize(),_(this,v,void 0,"f"),A(this,n,"m",M).call(this)}prepareSettings(){if(super.prepareSettings(),_(this,v,void 0,"f"),_(this,p,void 0,"f"),this.data.values=this.data.values.map(t=>new I.PlotSeries(t)),this.data.values.filter(t=>t.type==z.PlotType.Bar).length>0)for(let t of this.data.values){for(let e of t.values){const t=e.x;e.x=e.y,e.y=t}t.values.sort((t,e)=>e.x>t.x?1:-1)}for(let t of this.data.values){t.disabled=!t.values,t.type??=z.PlotType.Line;for(let e of t.values)e.id=k.guid(),this.data.xType==z.PlotAxisType.Date&&(k.isISOString(e.x)?e.x=new Date(e.x):console.warn(`${e.x} is not a date in ISO format.`))}_(this,r,{top:30,right:40,bottom:50,left:80},"f"),this.data.simple&&_(this,r,{top:10,right:10,bottom:10,left:10},"f"),this.settings.title&&(A(this,r,"f").top+=G.Values.titleOffset),this.tooltip=new j.Tooltip(this.canvas,this.settings),_(this,c,new Map,"f"),_(this,d,new Map,"f")}initDropdown(){super.initDropdown(),this.data.simple?this.dropdown=void 0:this.dropdown=new E.Dropdown(this.canvas,{x:-10,y:10,icon:z.Icon.ThreeLines,items:[{text:V.TextResources.exportPNG,action:()=>{B.Export.asPng(this.canvas,this.settings.title)}},{text:V.TextResources.exportCSV,action:()=>{B.Export.asCsv(F.Decomposition.toTable(O.PlotData.getRows(this.data)),this.settings.title)}},{isDivider:!0},{text:V.TextResources.decomposeToTable,action:()=>{new N.Modal(F.Decomposition.toTable(O.PlotData.getRows(this.data)),void 0,this.settings.title??V.TextResources.dataAsTable).open()}}]})}}e.PlotRenderer=q,a=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,f=new WeakMap,u=new WeakMap,v=new WeakMap,p=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakMap,n=new WeakSet,w=function(t){if(!this.onMouseMoveEvent)return!1;const e=this.getMousePosition(this.onMouseMoveEvent);return!this.dropdown?.isActive&&t-A(this,a,"f").step/2<=e.x&&e.x<t+A(this,a,"f").step/2&&A(this,r,"f").top<=e.y&&e.y<=this.canvas.height-A(this,r,"f").bottom&&A(this,r,"f").left<e.x},b=function(t,e,i,s){if(!this.onMouseMoveEvent)return!1;const n=this.getMousePosition(this.onMouseMoveEvent);return!this.dropdown?.isActive&&n.x>=t&&n.x<=t+i&&n.y>=e&&n.y<=e+s},x=function(t=!1){if(A(this,v,"f")&&t)return;if(this.data.simple)return;const e=H.Canvas.getContext(this.canvas);if(t&&e.clearRect(0,0,this.canvas.width,this.canvas.height),A(this,v,"f"))return void e.drawImage(A(this,v,"f"),0,0);if(!t)return;e.fillStyle=R.Theme.canvasBackground,e.fillRect(0,0,A(this,r,"f").left,this.canvas.height),e.fillRect(0,0,this.canvas.width,A(this,r,"f").top),e.fillRect(this.canvas.width-A(this,r,"f").right,0,this.canvas.width,this.canvas.height),e.fillRect(0,this.canvas.height-A(this,r,"f").bottom,this.canvas.width,this.canvas.height);const i=this.data.values.filter(t=>t.type==z.PlotType.Bar).length>0;e.setLineDash([]),(this.data.xTitle||this.data.yTitle)&&(e.textAlign="center",e.textBaseline="bottom",e.fillStyle=R.Theme.text,this.data.xTitle&&e.fillText(this.data.xTitle,A(this,r,"f").left+(this.canvas.width-A(this,r,"f").left-A(this,r,"f").right)/2,this.canvas.height-4),this.data.yTitle&&(e.rotate(-Math.PI/2),e.textBaseline="top",e.fillText(this.data.yTitle,-(A(this,r,"f").top+(this.canvas.height-A(this,r,"f").top-A(this,r,"f").bottom)/2),8),e.resetTransform())),e.textAlign="center",e.textBaseline="top";const s=A(this,a,"f").step,n=this.canvas.height-A(this,r,"f").bottom;let h=0,l=A(this,r,"f").left+s/2;for(let t=0;t<A(this,f,"f").length+1;t++)A(this,c,"f").trySet(Math.round(A(this,r,"f").left+t*A(this,a,"f").step),$.Formatter.format(A(this,f,"f")[t],this.data.xType));const p=Math.max(...[...A(this,c,"f").values()].map(t=>Math.ceil(k.stringWidth(t))))+10,m=Math.floor((this.canvas.width-A(this,r,"f").left-A(this,r,"f").right)/p),y=Math.ceil(1/(m/A(this,f,"f").length));for(;l<this.canvas.width-A(this,r,"f").right;)h%y==0&&(e.fillStyle=R.Theme.text+"b7",e.fillText((A(this,c,"f").get(Math.round(l-A(this,a,"f").step/2))??"")+(i?this.settings.valuePostfix:""),l,n+6)),l+=s,h++;e.textAlign="right",e.textBaseline="middle";const w=A(this,o,"f").count>10?10:A(this,o,"f").count;let b=i?1:0,x=A(this,u,"f").length/w;for(let t=i?1:0;t<A(this,u,"f").length+1;t++){const s=this.canvas.height-b*x*A(this,o,"f").step-A(this,r,"f").bottom,n=Math.round(this.canvas.height-t*A(this,o,"f").step-A(this,r,"f").bottom);if(A(this,d,"f").get(n)||A(this,d,"f").set(n,$.Formatter.format(A(this,o,"f").min+(t+(i?-1:0))*(A(this,o,"f").max-A(this,o,"f").min)/A(this,o,"f").count,z.PlotAxisType.Number,this.settings.valuePostfix)),t>=b*x){const t={x:A(this,r,"f").left,y:s,label:A(this,g,"f")>=1?Math.round((A(this,o,"f").min+(b*x+(i?-1:0))*(A(this,o,"f").max-A(this,o,"f").min)/A(this,o,"f").count)/A(this,g,"f"))*A(this,g,"f"):Math.round(A(this,o,"f").min+(b*x+(i?-1:0))*(A(this,o,"f").max-A(this,o,"f").min)/A(this,o,"f").count/A(this,g,"f"))*A(this,g,"f")};-0==t.label&&(t.label=0);let n="";if(this.data.shortLabels){const e=Math.floor(t.label.toString().length/4);e>0&&(t.label/=Math.pow(1e3,e),n=[V.TextResources.thousandShort,V.TextResources.millionShort,V.TextResources.billionShort][e-1])}e.fillText($.Formatter.number(t.label)+n+(i?"":this.settings.valuePostfix??""),t.x-12,t.y+(i?A(this,o,"f").step/2:0)),b++}}e.beginPath(),e.strokeStyle=R.Theme.line,e.lineWidth=1;const T=.5,M=this.data.values.filter(t=>t.type==z.PlotType.Bar).length>0;e.moveTo(A(this,r,"f").left-(M?T:0),this.canvas.height-A(this,r,"f").bottom+(M?-.5:T)),M?e.lineTo(A(this,r,"f").left-T,A(this,r,"f").top):e.lineTo(this.canvas.width-A(this,r,"f").right,this.canvas.height-A(this,r,"f").bottom+T),e.stroke(),this.canvas.width>0&&this.canvas.height>0&&createImageBitmap(e.getImageData(0,0,this.canvas.width,this.canvas.height)).then(t=>_(this,v,t,"f"))},T=function(){if(this.data.simple)return;const t=H.Canvas.getContext(this.canvas);if(A(this,p,"f"))return void t.putImageData(A(this,p,"f"),0,0);t.fillStyle=R.Theme.canvasBackground,t.fillRect(0,0,this.canvas.width,this.canvas.height);const e=R.Theme.lineAxis,i=this.data.values.filter(t=>t.type==z.PlotType.Bar).length>0;if(i){const i=A(this,a,"f").step,s=this.canvas.height-A(this,r,"f").bottom;let n=0,o=A(this,r,"f").left+i/2;for(let t=0;t<A(this,f,"f").length+1;t++)A(this,c,"f").trySet(Math.round(A(this,r,"f").left+t*A(this,a,"f").step),$.Formatter.format(A(this,f,"f")[t-1],this.data.xType));const h=Math.max(...[...A(this,c,"f").values()].map(t=>Math.ceil(k.stringWidth(t))))+10,l=Math.floor((this.canvas.width-A(this,r,"f").left-A(this,r,"f").right)/h),d=Math.ceil(1/(l/A(this,f,"f").length));for(;o<this.canvas.width-A(this,r,"f").right;)n%d==0&&(t.beginPath(),t.moveTo(o,s),t.lineTo(o,A(this,r,"f").top),t.lineWidth=1,t.strokeStyle=e,t.setLineDash([6,6]),t.stroke()),o+=i,n++}t.textAlign="right",t.textBaseline="middle";const s=A(this,o,"f").count>10?10:A(this,o,"f").count;let n=i?1:0,h=A(this,u,"f").length/s;for(let s=i?1:0;s<A(this,u,"f").length+1;s++){const i=this.canvas.height-n*h*A(this,o,"f").step-A(this,r,"f").bottom;if(s>=n*h){const s={x:A(this,r,"f").left,y:i};this.data.values.filter(t=>t.type.isAnyEquals(z.PlotType.Column,z.PlotType.StackingColumn,z.PlotType.Line)).length>0&&(t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(this.canvas.width-A(this,r,"f").right,s.y),t.lineWidth=1,t.strokeStyle=e,t.setLineDash([6,6]),t.stroke()),n++}}this.canvas.width>0&&this.canvas.height>0&&_(this,p,t.getImageData(0,0,this.canvas.width,this.canvas.height),"f")},M=function(){let t=this.data.values.flatMap(t=>t.values.map(t=>t.x)),e=this.data.values.flatMap(t=>t.values.map(t=>t.y));const i=this.data.xType==z.PlotAxisType.Date;if(i){let e=new Date(Math.min(...t));for(;e.getTime()<Math.max(...t);)t.includes(e.getTime())||t.push(new Date(e.getTime())),e=e.addDays(1);t.sort((t,e)=>t<e?-1:1)}e.sort((t,e)=>e>t?-1:1),_(this,f,[...new Set(t.filter(t=>null!=t).map(t=>i?t.toString():t))],"f"),_(this,u,[...new Set(e.filter(t=>null!=t))],"f"),_(this,a,{min:Math.min(...t),max:Math.max(...t),unit:(Math.abs(Math.min(...t))+Math.abs(Math.max(...t)))/(A(this,f,"f").length-1),step:(this.canvas.width-A(this,r,"f").left-A(this,r,"f").right)/A(this,f,"f").length,minStep:0,count:A(this,f,"f").length},"f");let s=Math.min(...e);s>0&&(s=0),_(this,o,{min:s,max:this.data.yMax??Math.max(...e),unit:(Math.abs(s)+Math.abs(this.data.yMax??Math.max(...e)))/(A(this,u,"f").length-1),step:(this.canvas.height-A(this,r,"f").top-A(this,r,"f").bottom)/A(this,u,"f").length,minStep:0,count:A(this,u,"f").length},"f");let n,h=this.data.values.filter(t=>t.type==z.PlotType.StackingColumn);if(h.length>0){let t=h.map(t=>t.values.flatMap(t=>+t.y));n=A(this,o,"f").max;for(let e=0;e<t[0].length;e++){let i=0;for(const s of t)i+=s[e];i>n&&(n=i)}A(this,o,"f").max=n>this.data.yMax?this.data.yMax:n,A(this,o,"f").unit=(Math.abs(A(this,o,"f").min)+Math.abs(A(this,o,"f").max))/(A(this,u,"f").length-1)}const l=k.stringWidth($.Formatter.number(A(this,o,"f").max));l>A(this,r,"f").left-40&&!this.data.simple&&(A(this,r,"f").left+=l-A(this,r,"f").left+40,A(this,a,"f").step=(this.canvas.width-A(this,r,"f").left-A(this,r,"f").right)/A(this,f,"f").length),_(this,g,Math.abs(A(this,o,"f").min)+Math.abs(A(this,o,"f").max),"f"),.5<=A(this,g,"f")&&A(this,g,"f")<1?_(this,g,.05,"f"):1<=A(this,g,"f")&&A(this,g,"f")<10?_(this,g,.1,"f"):10<=A(this,g,"f")&&A(this,g,"f")<100?_(this,g,2,"f"):100<=A(this,g,"f")&&A(this,g,"f")<1e3?_(this,g,20,"f"):1e3<=A(this,g,"f")&&A(this,g,"f")<1e4?_(this,g,50,"f"):1e4<=A(this,g,"f")&&A(this,g,"f")<1e5?_(this,g,1e3,"f"):1e5<=A(this,g,"f")&&A(this,g,"f")<1e6?_(this,g,1e4,"f"):1e6<=A(this,g,"f")&&A(this,g,"f")<1e7?_(this,g,5e4,"f"):_(this,g,1,"f"),1!=A(this,g,"f")&&(n=e.length>10?10*(A(this,o,"f").max/10+A(this,g,"f")-A(this,o,"f").max/10%A(this,g,"f")):Math.ceil(A(this,o,"f").max/A(this,g,"f"))*A(this,g,"f"),A(this,o,"f").max=n>this.data.yMax?this.data.yMax:n,A(this,o,"f").unit=(Math.abs(A(this,o,"f").min)+Math.abs(A(this,o,"f").max))/A(this,u,"f").length),_(this,m,{width:this.canvas.width-A(this,r,"f").left-A(this,r,"f").right,height:this.canvas.height-A(this,r,"f").top-A(this,r,"f").bottom},"f"),A(this,a,"f").minStep=.002*A(this,m,"f").width,A(this,o,"f").minStep=.002*A(this,m,"f").height}},572:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Dates=void 0;class i{}e.Dates=i,i.minDate=new Date(2e3,1,1)},601:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextStyles=void 0;const s=i(409);e.TextStyles=class{static title(t){t.fillStyle=s.Theme.text,t.textAlign="center",t.textBaseline="middle",t.font="20px sans-serif"}static regular(t){t.fillStyle=s.Theme.text,t.textAlign="center",t.textBaseline="middle",t.font="14px sans-serif"}static large(t){t.fillStyle=s.Theme.text,t.textAlign="center",t.textBaseline="middle",t.font="16px sans-serif"}static tooltip(t){t.font="14px sans-serif",t.textAlign="start",t.textBaseline="alphabetic"}static circularLabel(t,e){t.textAlign=e?"start":"end",t.textBaseline="alphabetic",t.font="14px sans-serif"}}},688:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Renderable=void 0;const s=i(5),n=i(183),a=i(168),o=i(869),r=i(283),h=i(409);e.Renderable=class{constructor(t){this.state=o.RenderState.Init,this.node=t.node,this.settings=t.settings,this.animations=new s.Animations,this.canvas=document.createElement(o.Tag.Canvas),this.canvas.style.imageRendering=r.Styles.ImageRendering.Pixelated,this.node.append(this.canvas),this.initAnimations()}render(){const t=a.Canvas.getContext(this.canvas);t.fillStyle=h.Theme.canvasBackground,t.fillRect(0,0,this.canvas.width,this.canvas.height)}refresh(){this.tooltip.refresh(),this.state=this.settings.disableInitAnimation?o.RenderState.Idle:o.RenderState.Init}resetMouse(){this.onMouseMoveEvent=new MouseEvent(o.Events.MouseMove),this.onClickEvent=new MouseEvent(o.Events.Click),this.onContextMenuEvent=void 0}initAnimations(){this.tooltip=new n.Tooltip(this.canvas,this.settings),this.canvasPosition=this.canvas.getBoundingClientRect(),this.canvasPosition.x+=scrollX,this.canvasPosition.y+=scrollY,this.state!=o.RenderState.Init||this.settings.disableInteractions||(this.canvas.onmousemove=t=>this.onMouseMoveEvent=t,this.canvas.onclick=t=>this.onClickEvent=t,this.canvas.oncontextmenu=t=>{t.preventDefault(),this.contextMenu=void 0,this.onContextMenuEvent?this.onContextMenuEvent=void 0:this.onContextMenuEvent=t},this.canvas.onmouseleave=()=>this.onMouseMoveEvent=new MouseEvent(o.Events.MouseMove))}destroy(){this.canvas.remove()}}},690:function(t,e,i){var s,n,a,o,r=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),h=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),l=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&r(e,t,i[n]);return h(e,t),e}),c=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};Object.defineProperty(e,"__esModule",{value:!0}),e.TreeRenderer=void 0;const d=i(495),f=i(459),u=i(138),v=l(i(10)),p=i(359),g=i(601),m=i(12),y=i(804),w=i(743),b=i(897),x=i(147),T=i(168),M=i(828),P=i(869),C=l(i(797));class S extends f.Renderer{constructor(t){super(t),n.add(this),this.settings.enableLegend=!1}render(){if(super.render(),0==this.data.values.filter(t=>t.value>0).length)return c(this,n,"m",o).call(this),void requestAnimationFrame(this.render.bind(this));const t=this.settings.title?C.Values.titleOffset:0,e=this.canvas.width-2*this.data.padding,i=this.canvas.height-2*this.data.padding-t;let s,r,h=this.data.values.reduce((t,e)=>t+e.value,0),l=e*i,d=this.data.padding,f=this.data.padding+t,u=this.data.padding,p=this.data.padding+t;const y=T.Canvas.getContext(this.canvas);let w=!0;for(let o=0;o<this.data.values.length;o++){const m=this.data.values[o],b=e-(d-this.data.padding),x=i-(f-this.data.padding-t);let T=[{color:m.color,label:m.label,s:m.value/h*l,value:m.value,id:m.id,x:d,y:f}];if(o+1<=this.data.values.length-1){const t=this.data.values[o+1];T.push({color:t.color,label:t.label,s:t.value/h*l,value:t.value,id:t.id,x:d,y:f}),o++}const M=1==T.length,S=o==this.data.values.length-1;if(w)for(let t=1;t<=b+o*o;t++){const e=b-t,i=T[0].s/e;if(i+(M?0:T[1].s/e)>=x){T[0].w=Math.floor(e),T[0].h=Math.floor(i),M||(T[1].w=Math.floor(e),T[1].h=x-T[0].h,T[1].y+=T[0].h);break}}else for(let t=1;t<=x+o*o;t++){const e=x-t,i=T[0].s/e;if(i+(M?0:T[1].s/e)>=b){T[0].h=Math.floor(e),T[0].w=Math.floor(i),M||(T[1].h=Math.floor(e),T[1].w=b-T[0].w,T[1].x+=T[0].w);break}}for(const t of T){S&&(w?(t.w=b,M&&(t.h=x)):(t.h=x,M&&(t.w=b))),y.beginPath(),y.fillStyle=t.color;const e=this.state!=P.RenderState.Init&&!this.animations.contains(t.id,P.AnimationType.Init),i=o+T.indexOf(t)+(S&&M?1:0),u=260,p=()=>{let t=0;for(let e=0;e<i;e++)t+=u-u*(e/this.data.values.length)/Math.E;return t},m=u-u*i/(this.data.values.length+1);if(e){const e=(e,i)=>{const s=t.x+t.w/2,n=t.y+t.h/2,a=t.w>t.h?1-12/t.w:1-12/t.h,o=1-a;y.translate(s-s*(a+e*o),n-n*(a+e*o)),y.scale(a+e*o,a+e*o),this.animations.reload(t.id,i)};c(this,n,"m",a).call(this,t)&&!s?(s=t,r=t.data,this.animations.handle(t.id,P.AnimationType.MouseOver,{duration:C.Animations.tree,backward:!0,body:t=>{e(t,P.AnimationType.MouseLeave)}})):this.animations.handle(t.id,P.AnimationType.MouseLeave,{timer:C.Dates.minDate,duration:C.Animations.tree,body:t=>{e(t,P.AnimationType.MouseOver)}})}else this.animations.handle(t.id,P.AnimationType.Init,{duration:p(),continuous:!0,body:e=>{if(e*p()-p()+m<0)return y.fillStyle+="00";e=(e*p()-p()+m)/m;const i=t.x+t.w/2,s=t.y+t.h/2,n=.7,a=1-n;y.translate(i-i*(n+e*a),s-s*(n+e*a)),y.scale(n+e*a,n+e*a);let o=Math.round(255*e).toString(16);o.length<2&&(o=0+o),y.fillStyle=t.color+o}});const A=4;y.roundRect(d+A,f+A,t.w-A,t.h-A,2*A),y.fill(),t.label&&v.stringWidth(t.label)<t.w-A&&t.h-A>16&&!this.animations.contains(t.id,P.AnimationType.Init)&&(y.beginPath(),g.TextStyles.large(y),y.fillStyle=v.isColorVisible(t.color,"#ffffff")?"#ffffff":"#000000",y.fillText(t.label,d+2+t.w/2,f+2+t.h/2)),y.resetTransform(),w?f+=t.h:d+=t.w,l-=t.w*t.h,h-=t.value}w?(d+=T[0].w,f=p):(f+=T[0].h,d=u),u=d,p=f,w=!w}this.tooltip.render(!!s&&!this.dropdown?.isActive,this.onMouseMoveEvent,[new m.TooltipValue(`${s?.label}: ${M.Formatter.format(s?.value,P.PlotAxisType.Number,this.settings.valuePostfix)}`)],this.data.values.find(t=>t.id==s?.id)),this.isDestroy||requestAnimationFrame(this.render.bind(this)),this.state=P.RenderState.Idle,super.renderDropdown(),s||this.contextMenu?this.renderContextMenu(r):this.onContextMenuEvent=void 0}refresh(){super.refresh()}resize(){super.resize(),this.initAnimations(),this.animations.clear()}prepareSettings(){super.prepareSettings(),this.data.values=this.data.values.map(t=>new u.Sector(t)),this.data.values=this.data.values.filter(t=>t.value>0),this.data.values.sort((t,e)=>(e.value??0)-(t.value??0)),this.calculateColors(!0);for(let t of this.data.values)t.disabled=!t.value,t.value??=0}initDropdown(){super.initDropdown(),this.dropdown=new p.Dropdown(this.canvas,{x:-10,y:10,icon:P.Icon.ThreeLines,items:[{text:x.TextResources.exportCSV,action:()=>{y.Export.asCsv(w.Decomposition.toTable(d.TreeData.getRows(this.data)),this.settings.title)}},{isDivider:!0},{text:x.TextResources.decomposeToTable,action:()=>{new b.Modal(w.Decomposition.toTable(d.TreeData.getRows(this.data)),void 0,this.settings.title??x.TextResources.dataAsTable).open()}}]})}}e.TreeRenderer=S,n=new WeakSet,a=function(t){if(!this.onMouseMoveEvent||!t)return!1;const e=this.getMousePosition(this.onMouseMoveEvent);return!this.dropdown?.isActive&&t.x<=e.x&&e.x<=t.x+t.w&&t.y<=e.y&&e.y<=t.y+t.h},o=function(){const t=T.Canvas.getContext(this.canvas);g.TextStyles.regular(t),t.fillText(x.TextResources.treeMapIsEmpty,this.canvas.width/2,this.canvas.height/2)}},743:function(t,e,i){var s,n=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),o=0;o<i.length;o++)"default"!==i[o]&&n(e,t,i[o]);return a(e,t),e});Object.defineProperty(e,"__esModule",{value:!0}),e.Decomposition=void 0;const r=o(i(10)),h=i(828),l=i(283),c=i(869);e.Decomposition=class{static toTable(t){let e=document.createElement(c.Tag.Div);e.classList.add("o-table");let i=new Map,s="",n="",a=0,o=new Map;for(const e of t.values){let i=new Map;for(const e of t.headers)i.set(e.value,0);for(const[t,s]of e.values)i.set(t,s);let s="";for(let t=0;t<a;t++)s+=" ";o.set(e.name+s,i),a++}for(const e of t.headers)n+=`\n                <div>\n                    ${e.display}\n                </div>\n            `;for(const[t,e]of o){let n="";for(const[t,s]of e)if(n+=`\n                    <div>\n                        ${null==s?"":h.Formatter.number(s)}\n                    </div>\n                `,i.has(t)){let e=+(i.get(t)??0);i.set(t,e+ +s)}else i.set(t,s);s+=`\n                <div class="o-table-row">\n                    <div>\n                        ${t.trim()}\n                    </div>\n                    \n                    ${n} \n                </div>\n            `}let r="";for(const[,t]of i)r+=`\n                <div>\n                    ${null==t?"":h.Formatter.number(t)}\n                </div>\n            `;return e.innerHTML=`\n            <div class="o-table-header">\n                <div></div>\n\n                ${n}\n            </div>\n        \n            <div class="o-table-body">\n                ${s}\n            </div>\n            \n            <div class="o-table-footer">\n                <div></div>\n\n                ${r}\n            </div>\n        `,e}static toChart(t,e){let i=document.createElement(c.Tag.Div),s=document.createElement(c.Tag.Div),n=document.createElement(c.Tag.Script),a=r.guid();i.style.display=l.Styles.Display.Flex,i.style.height="100%",s.id=a,s.style.flexGrow="1";let o=JSON.parse(JSON.stringify(t));return o.title&&(o.title=o.title+" (Other)"),o.data.values=e,o.minWidth=void 0,o.minHeight=void 0,n.innerHTML=`\n            new OCharts.chart(document.getElementById('${a}'), ${JSON.stringify(o)})\n                .render()\n        `,i.append(s,n),i}}},797:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Values=e.Dates=e.Animations=void 0;var s=i(126);Object.defineProperty(e,"Animations",{enumerable:!0,get:function(){return s.Animations}});var n=i(572);Object.defineProperty(e,"Dates",{enumerable:!0,get:function(){return n.Dates}});var a=i(975);Object.defineProperty(e,"Values",{enumerable:!0,get:function(){return a.Values}})},801:function(t,e,i){var s,n,a,o,r,h,l,c=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),d=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),f=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&c(e,t,i[n]);return d(e,t),e}),u=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},v=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i};Object.defineProperty(e,"__esModule",{value:!0}),e.GaugeRenderer=void 0;const p=i(459),g=f(i(10)),m=i(359),y=i(409),w=i(601),b=i(12),x=i(804),T=i(828),M=i(168),P=i(147),C=i(869);class S extends p.Renderer{constructor(t){super(t),n.add(this),a.set(this,void 0),o.set(this,void 0),this.settings.enableLegend=!1}render(){super.render(),u(this,n,"m",r).call(this);const t=this.data.values[0];this.tooltip.render(u(this,n,"m",h).call(this,this.onMouseMoveEvent,t)&&!this.dropdown?.isActive,this.onMouseMoveEvent,[new b.TooltipValue(`${t?.label}: ${T.Formatter.format(t?.current,C.PlotAxisType.Number,this.settings.valuePostfix)}`)],t),this.isDestroy||requestAnimationFrame(this.render.bind(this)),this.state=C.RenderState.Idle,super.renderDropdown()}refresh(){super.refresh()}resize(){super.resize(),this.initAnimations(),u(this,n,"m",l).call(this)}prepareSettings(){super.prepareSettings();for(let t of this.data.values)t.disabled=!t.value,t.value??=0;this.data.values.length>0&&this.data.values[0].value>this.data.max&&(this.data.values[0].value=this.data.max)}initDropdown(){super.initDropdown(),this.dropdown=new m.Dropdown(this.canvas,{x:-10,y:10,icon:C.Icon.ThreeLines,items:[{text:P.TextResources.exportPNG,action:()=>{x.Export.asPng(this.canvas,this.settings.title)}}]})}}e.GaugeRenderer=S,a=new WeakMap,o=new WeakMap,n=new WeakSet,r=function(){const t=M.Canvas.getContext(this.canvas),e=this.data.values[0]??{id:g.guid()};(this.state==C.RenderState.Init||this.animations.contains(e.id,C.AnimationType.Init))&&this.animations.handle(e.id,C.AnimationType.Init,{duration:450,continuous:!0,body:t=>{e.current=e.value*t}}),t.beginPath(),t.strokeStyle=e.color,t.lineCap="round",t.lineWidth=40;const i=e.current/this.data.max,s=(isNaN(i)?1:i)*Math.PI;e.value&&(t.arc(u(this,o,"f").x,u(this,o,"f").y,u(this,a,"f"),Math.PI,s-Math.PI),t.stroke()),t.beginPath(),t.lineWidth=1,t.lineCap="square";let n=0,r=Math.PI;for(;r>=0;){let e=r-Math.PI/10>0?Math.PI/10:r;const i=t=>({x:u(this,o,"f").x+(u(this,a,"f")+t)*Math.cos(Math.PI+n),y:u(this,o,"f").y+(u(this,a,"f")+t)*Math.sin(Math.PI+n)});let h=i(50),l=i(90),c=i(115);const d=Math.PI-r>s?"66":"ff";t.moveTo(h.x,h.y),t.lineTo(l.x,l.y),t.strokeStyle=y.Theme.text+d,t.stroke(),w.TextStyles.regular(t),t.fillStyle=y.Theme.text+d,t.fillText(T.Formatter.number(this.data.max-r/Math.PI*this.data.max),c.x,c.y),n+=e,r-=Math.PI/10}},h=function(t,e){if(!t)return!1;const i=this.getMousePosition(t),s={x:i.x-u(this,o,"f").x,y:i.y-u(this,o,"f").y};return!this.dropdown?.isActive&&(t=>{let i=Math.atan2(t.y-u(this,o,"f").y,t.x-u(this,o,"f").x);i<0&&(i+=2*Math.PI);const s=e.current/this.data.max,n=(isNaN(s)?1:s)*Math.PI;return i>Math.PI&&Math.PI+n>=i})(i)&&(t=>{const e=u(this,a,"f")+20,i=u(this,a,"f")-20;return t.x*t.x+t.y*t.y<=e*e&&t.x*t.x+t.y*t.y>=i*i})(s)},l=function(){const t=this.canvas.width<this.canvas.height?this.canvas.height-250:this.canvas.width;v(this,a,t/3,"f"),v(this,o,{x:this.canvas.width/2,y:this.canvas.height-u(this,a,"f")/5},"f")}},804:function(t,e,i){var s,n=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),o=0;o<i.length;o++)"default"!==i[o]&&n(e,t,i[o]);return a(e,t),e});Object.defineProperty(e,"__esModule",{value:!0}),e.Export=void 0;const r=i(409),h=o(i(10)),l=i(168),c=i(869);class d{static asPng(t,e){requestAnimationFrame(()=>{const i=l.Canvas.getContext(t);let s=h.stringWidth(c.Icon.ThreeLines)+20;i.fillStyle=r.Theme.canvasBackground,i.fillRect(t.width-s,0,s,64);let n=0,a=0;const o=new Uint32Array(i.getImageData(0,0,t.width,t.height).data.buffer);let f=!1;for(let e=0;e<t.width;e++){for(let i=0;i<t.height;i++)if(l.Canvas.isPixelBusy(o[e+i*t.width])){f=!0;break}if(f)break;n++}f=!1;for(let e=t.width;e>=0;e--){for(let i=0;i<t.height;i++)if(l.Canvas.isPixelBusy(o[e+i*t.width])){f=!0;break}if(f)break;a++}n>4&&(n-=4),a>4&&(a-=4),n>a&&(n=a),a>n&&(a=n);let u=document.createElement(c.Tag.Canvas);u.width=t.width-n-a,u.height=t.height;const v=l.Canvas.getContext(u);v.fillStyle=r.Theme.background,v.fillRect(0,0,t.width,t.height),v.drawImage(t,-n,0),d.saveAs((e??"chart")+".png",u.toDataURL("image/png"))})}static asCsv(t,e){let i=t.querySelectorAll("tr"),s=[];for(let t=0;t<i.length;t++){let e=[],n=i[t].querySelectorAll("td, th");for(let t=0;t<n.length;t++){let i=n[t].innerHTML.replace(/(\r\n|\n|\r)/gm,"").replace(/(\s\s)/gm," ");i=i.replace(/"/g,'""'),e.push('"'+i+'"')}s.push(e.join(","))}d.saveAs((e??"table")+".csv",s.join("\n"),"data:text/csv;charset=utf-8,"+encodeURIComponent(s.join("\n")),!0)}static saveAs(t,e,i,s){if(null!=window.showSaveFilePicker){const n={suggestedName:t,types:[{accept:s?{"text/csv":".csv"}:{"image/*":".png"}}],excludeAcceptAllOption:!0};function a(t){const e=atob(t.split(",")[1]),i=t.split(",")[0].split(":")[1].split(";")[0],s=new ArrayBuffer(e.length),n=new Uint8Array(s);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return new Blob([s],{type:i})}window.showSaveFilePicker(n).then(t=>{t.createWritable().then(t=>{t.write(s?e:a(e)).then(()=>t.close())})})}else{let o=document.createElement(c.Tag.A);o.href=i??e,o.download=t,o.click()}}}e.Export=d},828:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Formatter=void 0;const s=i(869);class n{static format(t,e,i){let a="";switch(e){case s.PlotAxisType.Number:a=n.number(t);break;case s.PlotAxisType.Date:a=n.date(new Date(t));break;case s.PlotAxisType.Text:a=n.text(t)}return a+(i??"")}}e.Formatter=n,n.number=t=>t?.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})??"",n.date=t=>t?.toLocaleDateString()??"",n.text=t=>t??""},830:function(t,e,i){var s,n,a,o,r,h,l,c,d,f=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),u=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),v=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&f(e,t,i[n]);return u(e,t),e}),p=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},g=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};Object.defineProperty(e,"__esModule",{value:!0}),e.Button=void 0;const m=i(601),y=i(409),w=i(5),b=v(i(10)),x=i(168),T=i(869),M=v(i(797)),P=i(283);e.Button=class{constructor(t,e){n.add(this),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),h.set(this,void 0),l.set(this,void 0),p(this,a,t,"f"),p(this,o,e,"f"),this.animations=new w.Animations,g(this,n,"m",c).call(this)}render(t,e){g(this,h,"f")||g(this,n,"m",c).call(this);const i=x.Canvas.getContext(g(this,a,"f"));i.beginPath();const s=(t,e)=>{this.animations.reload("animation-button",e),i.fillStyle=b.adjustColor(y.Theme.canvasBackground,-Math.round(25*t))};return g(this,n,"m",d).call(this,t)?(g(this,a,"f").style.cursor=P.Styles.Cursor.Pointer,e&&g(this,n,"m",d).call(this,e)&&(g(this,o,"f").action(),e=void 0),this.animations.handle("animation-button",T.AnimationType.MouseOver,{duration:300,body:t=>{s(t,T.AnimationType.MouseLeave)}})):this.animations.handle("animation-button",T.AnimationType.MouseLeave,{timer:M.Dates.minDate,duration:300,backward:!0,body:t=>{s(t,T.AnimationType.MouseOver)}}),i.roundRect(g(this,l,"f").x,g(this,l,"f").y,g(this,l,"f").width,g(this,l,"f").height,4),i.fill(),m.TextStyles.regular(i),i.fillText(g(this,o,"f").text,g(this,l,"f").x+g(this,l,"f").width/2,g(this,l,"f").y+g(this,l,"f").height/2),p(this,h,!0,"f"),e}resize(){g(this,n,"m",c).call(this)}},a=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,l=new WeakMap,n=new WeakSet,c=function(){p(this,r,g(this,a,"f").getBoundingClientRect(),"f"),g(this,r,"f").x+=scrollX,g(this,r,"f").y+=scrollY;const t=b.stringWidth(g(this,o,"f").text)+12;p(this,l,{x:g(this,o,"f").x+t>g(this,a,"f").width?g(this,a,"f").width-t:g(this,o,"f").x<0?g(this,a,"f").width+g(this,o,"f").x-t:g(this,o,"f").x,y:g(this,o,"f").y+20>g(this,a,"f").height?g(this,a,"f").height-20:g(this,o,"f").y<0?g(this,a,"f").height+g(this,o,"f").y-20:g(this,o,"f").y,width:t,height:20},"f")},d=function(t){if(!t)return!1;let e=t.clientX-g(this,r,"f").x+scrollX,i=t.clientY-g(this,r,"f").y+scrollY;return e>=g(this,l,"f").x&&e<=g(this,l,"f").x+g(this,l,"f").width&&i>=g(this,l,"f").y&&i<=g(this,l,"f").y+g(this,l,"f").height}},869:(t,e)=>{var i,s,n,a,o,r,h,l,c,d,f,u,v;Object.defineProperty(e,"__esModule",{value:!0}),e.DrawPointType=e.Icon=e.RenderState=e.Tag=e.PlotType=e.PlotAxisType=e.LineType=e.LegendPlace=e.Events=e.ErrorType=e.ChartType=e.Attribute=e.AnimationType=void 0,function(t){t[t.None=0]="None",t[t.MouseOver=1]="MouseOver",t[t.MouseLeave=2]="MouseLeave",t[t.Init=3]="Init",t[t.Click=4]="Click",t[t.AnotherItemOver=5]="AnotherItemOver",t[t.AnotherItemLeave=6]="AnotherItemLeave"}(i||(e.AnimationType=i={})),function(t){t.Name="name"}(s||(e.Attribute=s={})),function(t){t[t.Plot=0]="Plot",t[t.Circular=1]="Circular",t[t.Gauge=2]="Gauge",t[t.TreeMap=3]="TreeMap"}(n||(e.ChartType=n={})),function(t){t.NullContext="Can't find context",t.ElementNotExist="Element does not exist"}(a||(e.ErrorType=a={})),function(t){t.VisibilityChanged="visibilitychange",t.Blur="blur",t.MouseMove="mousemove",t.Click="click",t.Change="change",t.ContextMenu="contextmenu"}(o||(e.Events=o={})),function(t){t[t.Bottom=0]="Bottom",t[t.Left=1]="Left",t[t.Top=2]="Top",t[t.Right=3]="Right"}(r||(e.LegendPlace=r={})),function(t){t[t.Solid=0]="Solid",t[t.Dash=1]="Dash",t[t.Dotted=2]="Dotted"}(h||(e.LineType=h={})),function(t){t[t.Number=0]="Number",t[t.Date=1]="Date",t[t.Text=2]="Text"}(l||(e.PlotAxisType=l={})),function(t){t[t.Line=0]="Line",t[t.AttentionLine=1]="AttentionLine",t[t.Column=2]="Column",t[t.Bar=3]="Bar",t[t.StackingColumn=4]="StackingColumn"}(c||(e.PlotType=c={})),function(t){t.Canvas="canvas",t.A="a",t.Div="div",t.Dialog="dialog",t.Table="table",t.Script="script",t.Button="button",t.Span="span"}(d||(e.Tag=d={})),function(t){t[t.Idle=0]="Idle",t[t.Init=1]="Init"}(f||(e.RenderState=f={})),function(t){t.ThreeLines="☰",t.Close="×"}(u||(e.Icon=u={})),function(t){t[t.Move=0]="Move",t[t.Line=1]="Line",t[t.QuadraticCurve=2]="QuadraticCurve"}(v||(e.DrawPointType=v={}))},897:function(t,e,i){var s,n,a,o,r=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)},h=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i};Object.defineProperty(e,"__esModule",{value:!0}),e.Modal=void 0;const l=i(39),c=i(869);e.Modal=class{constructor(t,e,i){s.add(this),n.set(this,void 0),this.modal=document.createElement(c.Tag.Dialog),this.modal.classList.add(d.modal),e&&(this.modal.style.width=`${e.width}px`,this.modal.style.height=`${e.height}px`),this.modal.oncancel=()=>this.close(),document.body.appendChild(this.modal),r(this,s,"m",a).call(this,i),r(this,s,"m",o).call(this,t)}open(){l.Errors.throwIsUndefined(this.modal,c.ErrorType.ElementNotExist),this.modal.showModal()}close(){l.Errors.throwIsUndefined(this.modal,c.ErrorType.ElementNotExist),this.modal.close(),this.modal.remove(),this.modal=void 0}},n=new WeakMap,s=new WeakSet,a=function(t){l.Errors.throwIsUndefined(this.modal,c.ErrorType.ElementNotExist);let e=document.createElement(c.Tag.Span);e.classList.add(d.title),e.innerHTML=t??"";let i=document.createElement(c.Tag.Button);i.classList.add(d.close),i.innerHTML=c.Icon.Close;let s=document.createElement(c.Tag.Div);s.classList.add(d.header),s.appendChild(e),s.appendChild(i),this.modal.appendChild(s),i.onclick=()=>this.close()},o=function(t){null==r(this,n,"f")&&(h(this,n,document.createElement(c.Tag.Div),"f"),r(this,n,"f").classList.add(d.content),this.modal?.appendChild(r(this,n,"f"))),null!=t&&r(this,n,"f").appendChild(t)};class d{}d.modal="o-modal",d.title="o-modal-title",d.close="o-modal-close",d.header="o-modal-header",d.content="o-modal-content"},902:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PlotSeries=void 0;const s=i(527),n=i(869);class a extends s.Value{constructor(t){super(),this.lineType=n.LineType.Solid,Object.assign(this,t)}toggle(t){super.toggle(t)}checkCondition(){return super.checkCondition(),!0}reset(){super.reset()}}e.PlotSeries=a},927:function(t,e,i){var s,n,a,o,r,h,l,c=this&&this.__createBinding||(Object.create?function(t,e,i,s){void 0===s&&(s=i);var n=Object.getOwnPropertyDescriptor(e,i);n&&!("get"in n?!e.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,s,n)}:function(t,e,i,s){void 0===s&&(s=i),t[s]=e[i]}),d=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),f=this&&this.__importStar||(s=function(t){return s=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},s(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i=s(t),n=0;n<i.length;n++)"default"!==i[n]&&c(e,t,i[n]);return d(e,t),e}),u=this&&this.__classPrivateFieldSet||function(t,e,i,s,n){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(t,i):n?n.value=i:e.set(t,i),i},v=this&&this.__classPrivateFieldGet||function(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)};Object.defineProperty(e,"__esModule",{value:!0}),e.Legend=void 0;const p=i(688),g=f(i(10)),m=i(138),y=i(409),w=i(601),b=i(168),x=i(830),T=i(147),M=f(i(797)),P=i(283),C=i(869);class S extends p.Renderable{constructor(t){super(t),n.add(this),a.set(this,void 0),o.set(this,void 0),r.set(this,void 0),h.set(this,void 0),this.isDestroy=!1,u(this,r,t,"f"),this.prepareSettings()}render(){super.render();const t=b.Canvas.getContext(this.canvas);let e={x:20,y:21};this.canvas.style.cursor=P.Styles.Cursor.Default,w.TextStyles.regular(t),t.textAlign="start",t.textBaseline="alphabetic",t.translate(v(this,o,"f").x,v(this,o,"f").y),u(this,h,0,"f");for(const t of this.settings.data.values.filter(t=>!t.hideInLegend))e=v(this,n,"m",l).call(this,t,e.x,e.y);t.translate(-v(this,o,"f").x,-v(this,o,"f").y),this.isDestroy||requestAnimationFrame(this.render.bind(this)),this.onClickEvent=v(this,a,"f")?.render(this.onMouseMoveEvent,this.onClickEvent),this.state=C.RenderState.Idle}destroy(){this.isDestroy=!0,this.canvas.remove()}refresh(){this.state=C.RenderState.Init}resize(){this.calculateSizes(),v(this,a,"f")?.resize(),this.initAnimations()}calculateSizes(){switch(this.settings.legendPlace){case C.LegendPlace.Bottom:default:this.canvas.width=this.settings.width,this.canvas.height=S.getLegendHeight(this.settings.data.values,this.canvas.width),this.node.style.flexDirection=P.Styles.FlexDirection.Column;break;case C.LegendPlace.Top:this.canvas.width=this.settings.width,this.canvas.height=S.getLegendHeight(this.settings.data.values,this.canvas.width),this.node.style.flexDirection=P.Styles.FlexDirection.ColumnReverse;break;case C.LegendPlace.Left:this.canvas.width=500,this.canvas.height=this.settings.height,this.node.style.flexDirection=P.Styles.FlexDirection.Row;break;case C.LegendPlace.Right:this.canvas.width=500,this.canvas.height=this.settings.height,this.node.style.flexDirection=P.Styles.FlexDirection.RowReverse}u(this,o,{x:S.getOffsetToCenter(this.settings.data.values,this.canvas.width),y:(this.canvas.height-S.getLegendHeight(this.settings.data.values,this.canvas.width))/2},"f")}applySettings(t){this.settings=t,this.prepareSettings()}prepareSettings(){this.resize(),this.settings.disableInteractions||u(this,a,new x.Button(this.canvas,{x:-10,y:12,text:T.TextResources.reset,action:()=>{for(let t of this.settings.data.values)t.reset()}}),"f")}static getOffsetToCenter(t,e){let i=20;for(const s of t.filter(t=>!t.hideInLegend)){const t=g.stringWidth(s.label);if(i+t+47>=e-100)break;i+=t+47}return e/2-i/2}static getLegendHeight(t,e){let i=1,s=20,n=S.getOffsetToCenter(t,e);for(const a of t.filter(t=>!t.hideInLegend)){const t=g.stringWidth(a.label);s+t+48>=e-32-n&&(s=20,i++),s+=t+48}return 24+20*i+6*(i-1)}}e.Legend=S,a=new WeakMap,o=new WeakMap,r=new WeakMap,h=new WeakMap,n=new WeakSet,l=function(t,e,i){var s;const n=b.Canvas.getContext(this.canvas),a=g.stringWidth(t.label);e+48+a>=this.canvas.width-40-v(this,o,"f").x&&(e=20,i+=26);let l=e-6-6,c=i-3-6,d=12+a+18;const f=t=>{if(!t)return!1;const e=t.clientX-this.canvasPosition.x+scrollX-v(this,o,"f").x,i=t.clientY-this.canvasPosition.y+scrollY-v(this,o,"f").y;return e>=l&&e<=l+d&&i>=c&&i<=c+20},p=(e,i)=>{this.animations.reload(t.id,i),n.beginPath(),n.roundRect(l,c,d,20,6),n.fillStyle=g.adjustColor(y.Theme.canvasBackground,Math.round(-25*e)),n.fill()};return this.animations.handle(t.id,C.AnimationType.Click,{duration:M.Animations.legend,continuous:!0,before:()=>null!=this.onClickEvent&&(f(this.onClickEvent)||t instanceof m.Sector&&0!==t.current&&t.value!==t.current)&&t.checkCondition(),body:e=>{t.toggle(e),1==e&&(this.onClickEvent=new PointerEvent(C.Events.Click))}}),f(this.onMouseMoveEvent)?(this.animations.handle(t.id,C.AnimationType.MouseOver,{duration:M.Animations.button,body:t=>{p(t,C.AnimationType.MouseLeave)}}),t.disabled||(u(this,h,(s=v(this,h,"f"),++s),"f"),v(this,r,"f").highlight(t)),this.canvas.style.cursor=P.Styles.Cursor.Pointer):this.animations.handle(t.id,C.AnimationType.MouseLeave,{timer:M.Dates.minDate,duration:M.Animations.button,backward:!0,body:t=>{p(t,C.AnimationType.MouseOver)}}),n.beginPath(),n.arc(e-1,i+1,3,0,2*Math.PI),n.fillStyle=t.disabled?g.grayScale(t.color):t.color,n.fill(),n.fillStyle=y.Theme.text,t.disabled&&(n.fillStyle+="7f"),n.fillText(t.label,e+9+1,i+6),e+=20,t.disabled&&(n.moveTo(e-10,i+2),n.lineTo(e+a-10,i+2),n.strokeStyle=y.Theme.text+"7f",n.stroke()),{x:e+=a+22,y:i}}},975:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Values=void 0;class i{}e.Values=i,i.titleOffset=30}},e={};function i(s){var n=e[s];if(void 0!==n)return n.exports;var a=e[s]={exports:{}};return t[s].call(a.exports,a,a.exports,i),a.exports}Number.prototype.isAnyEquals=function(...t){return t.includes(this)},Date.prototype.addDays=function(t){let e=new Date(this);return e.setDate(e.getDate()+t),e},Date.prototype.addMilliseconds=function(t){let e=new Date(this);return e.setMilliseconds(e.getMilliseconds()+t),e},Map.prototype.trySet=function(t,e){this.has(t)||this.set(t,e)},(()=>{const t=i(88);function e(){}e.chart=function(e,i){return new t.Chart(e,i)},window.OCharts=e})()})();
//# sourceMappingURL=ocharts.js.map