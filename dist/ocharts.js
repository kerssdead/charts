(()=>{"use strict";({832:function(){class t{toggle(t){0===t&&(this.disabled=!this.disabled)}checkCondition(){return!1}reset(){this.disabled=!1}}var i,s,e=this&&this.__classPrivateFieldGet||function(t,i,s,e){if("a"===s&&!e)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof i?t!==i||!e:!i.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?e:"a"===s?e.call(t):e?e.value:i.get(t)};class h{constructor(t,h){i.add(this),this.node=t.node,this.settings=h,this.chart=t,this.animations=new wi,this.canvas=document.createElement("canvas"),e(this,i,"m",s).call(this),this.node.append(this.canvas),this.tooltip=new Ci(this.canvas,h)}render(){const t=this.canvas.getContext("2d",{willReadFrequently:!0});if(!t)throw ht.Errors.nullContext;t.clearRect(0,0,this.canvas.width,this.canvas.height),this.settings.title&&(t.beginPath(),t.fillStyle="#000000",t.textAlign="center",t.textBaseline="top",t.font="20px serif",t.fillText(this.settings.title,this.canvas.width/2,30),t.closePath())}refresh(){this.tooltip.refresh()}resize(){e(this,i,"m",s).call(this),this.tooltip.refresh()}resetMouse(){}}i=new WeakSet,s=function(){let t=this.node.getBoundingClientRect();this.canvas.width=this.chart.settings.width<t.width||0===t.width?this.chart.settings.width:t.width,this.canvas.height=this.chart.settings.height<t.height||0===t.height?this.chart.settings.height:t.height,this.settings.enableLegend&&(this.settings.legendPlace!==it.Top&&this.settings.legendPlace!==it.Bottom||(this.canvas.height-=ki.getLegendHeight(this.settings.data.values,this.canvas.width)),this.settings.legendPlace!==it.Left&&this.settings.legendPlace!==it.Right||(this.canvas.width-=500))};var a,n,o,l,f,r,d,c,u,g,v,m,w,x,y,p,M,b,k,S,C,W,T,P,I,D,R,L,F,E,A,B,O,Y,q,X,j,$,N,z,H,G,_,U,J,V,K,Q,Z,tt,it,st,et,ht,at,nt,ot,lt,ft,rt,dt,ct,ut,gt,vt,mt,wt,xt,yt,pt,Mt,bt,kt,St,Ct,Wt,Tt,Pt,It,Dt,Rt,Lt,Ft,Et,At,Bt,Ot,Yt,qt,Xt,jt,$t,Nt,zt,Ht,Gt,_t,Ut,Jt,Vt,Kt,Qt,Zt,ti,ii,si,ei,hi,ai,ni,oi,li,fi,ri,di,ci,ui,gi,vi,mi=this&&this.__classPrivateFieldSet||function(t,i,s,e,h){if("m"===e)throw new TypeError("Private method is not writable");if("a"===e&&!h)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof i?t!==i||!h:!i.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===e?h.call(t,s):h?h.value=s:i.set(t,s),s};class wi{constructor(){a.add(this),n.set(this,void 0),mi(this,n,new Map,"f")}add(t,i,s){const h=e(this,a,"m",l).call(this,t,i);e(this,n,"f").has(h)||e(this,n,"f").set(h,s),e(this,a,"m",o).call(this,h)}contains(t,i){return e(this,n,"f").has(e(this,a,"m",l).call(this,t,i))}reload(t,i){this.contains(t,i)&&(e(this,n,"f").get(e(this,a,"m",l).call(this,t,i)).timer=new Date)}clear(){e(this,n,"f").forEach((t,i)=>!e(this,a,"m",f).call(this,i,Q.Init)&&e(this,n,"f").delete(i))}}n=new WeakMap,a=new WeakSet,o=function(t){const i=e(this,n,"f").get(t),s=new Date,h=s.getTime()-(i.timer??s).getTime(),a=h>i.duration?1:h/i.duration,o=!i.before||i.before();!i.timer&&o&&(i.timer=s),o&&i.body(a),1!==a||o&&!i.continuous||e(this,n,"f").delete(t)},l=function(t,i){return t+"_"+i},f=function(t,i){return t.endsWith("_"+i)};class xi{constructor(t,i){r.add(this),d.set(this,void 0),c.set(this,void 0),u.set(this,void 0),g.set(this,void 0),mi(this,d,t,"f"),mi(this,c,i,"f"),this.animations=new wi,e(this,r,"m",v).call(this)}render(t,i){e(this,g,"f")||e(this,r,"m",v).call(this);let s=e(this,d,"f").getContext("2d",{willReadFrequently:!0});if(!s)throw ht.Errors.nullContext;const h=bi.stringWidth(e(this,c,"f").text)+20;s.beginPath();let a=e(this,c,"f").x+h>e(this,d,"f").width?e(this,d,"f").width-h:e(this,c,"f").x,n=e(this,c,"f").y+24>e(this,d,"f").height?e(this,d,"f").height-24:e(this,c,"f").y;return e(this,r,"m",m).call(this,t,a,n,h,24)?(e(this,d,"f").style.cursor="pointer",i&&e(this,r,"m",m).call(this,i,a,n,h,24)&&(e(this,c,"f").action(),i=void 0),this.animations.add("animation-button",Q.MouseOver,{duration:300,before:()=>void 0===i,body:t=>{this.animations.reload("animation-button-leave",Q.MouseLeave),s.fillStyle=bi.adjustColor("#ffffff",-Math.round(40*t))}})):this.animations.add("animation-button-leave",Q.MouseLeave,{duration:300,body:t=>{this.animations.reload("animation-button",Q.MouseOver),s.fillStyle=bi.adjustColor("#ffffff",-Math.round(40*(1-t)))}}),s.strokeStyle="#ffffff",s.roundRect(a,n,h,24,4),s.fill(),s.fillStyle="#000000",s.textAlign="center",s.textBaseline="middle",s.font="14px serif",s.fillText(e(this,c,"f").text,a+h/2,n+12),s.closePath(),mi(this,g,!0,"f"),i}}d=new WeakMap,c=new WeakMap,u=new WeakMap,g=new WeakMap,r=new WeakSet,v=function(){mi(this,u,e(this,d,"f").getBoundingClientRect(),"f"),e(this,u,"f").x+=window.scrollX,e(this,u,"f").y+=window.scrollY},m=function(t,i,s,h,a){if(!t)return!1;let n=t.clientX-e(this,u,"f").x+window.scrollX,o=t.clientY-e(this,u,"f").y+window.scrollY;return n>=i&&n<=i+h&&o>=s&&o<=s+a};class yi{constructor(t,i){w.add(this),x.set(this,void 0),y.set(this,void 0),p.set(this,void 0),t.chart=this,this.node=t,this.node.style.display="flex",this.node.style.flexDirection="column",this.node.style.alignItems="center",this.data=i.data,this.settings=i,e(this,w,"m",M).call(this),this.settings.enableLegend&&mi(this,y,new ki(this,t),"f"),document.addEventListener("visibilitychange",()=>e(this,x,"f").resetMouse()),window.addEventListener("blur",()=>e(this,x,"f").resetMouse())}render(){e(this,x,"f").render(),e(this,y,"f")?.render(),mi(this,p,new ResizeObserver(()=>e(this,w,"m",k).call(this)),"f"),e(this,p,"f").observe(this.node),e(this,w,"m",b).call(this)}}x=new WeakMap,y=new WeakMap,p=new WeakMap,w=new WeakSet,M=function(){const t=this.settings.baseColor??bi.randomColor();let i=Math.round(100/this.settings.data.values.length),s=-50;i<=1&&(i=1);const e=this.settings.type===Z.Plot,h=this.settings.type===Z.Circular;for(let a of this.settings.data.values){a.id=bi.guid(),a.color??=bi.adjustColor(t,s+=i),a.disabled=e?!a.values:!a.value,h&&(a.value??=0);let n=a;if(e){n.type??=et.Line;for(let t of n.values)t.id=bi.guid(),this.settings.data.xType===st.Date&&("string"==typeof t.x&&bi.isISOString(t.x)?t.x=new Date(t.x):console.warn(`${t.x} is not a date in ISO format.`))}}if(h&&this.settings.data.values.filter(t=>t.value<0)){for(const t of this.settings.data.values.filter(t=>t.value<0))console.warn(`"${t.label}" has negative value (${t.value}) and will not be render`);this.settings.data.values=this.settings.data.values.filter(t=>t.value>=0)}const a=this.node.parentNode.getBoundingClientRect();switch(this.settings.width&&0!==+this.settings.width||(this.settings.width=a.width),this.settings.height&&0!==+this.settings.height||(this.settings.height=a.height),this.settings.legendPlace??=it.Bottom,this.settings.type){case Z.Plot:mi(this,x,new Pi(this,this.settings),"f");break;case Z.Circular:mi(this,x,new Wi(this,this.settings),"f");break;case Z.Gauge:mi(this,x,new Ti(this,this.settings),"f");break;case Z.TreeMap:mi(this,x,new Ii(this,this.settings),"f")}},b=function(){e(this,x,"f").refresh(),e(this,y,"f")?.refresh()},k=function(){e(this,x,"f").resize(),e(this,y,"f")?.resize()};class pi{constructor(t,i){S.add(this),C.set(this,void 0),W.set(this,void 0),T.set(this,void 0),this.isActive=!1,P.set(this,void 0),mi(this,C,t,"f"),mi(this,W,i,"f"),this.animations=new wi,e(this,S,"m",I).call(this)}render(t,i){e(this,P,"f")||e(this,S,"m",I).call(this);let s=e(this,C,"f").getContext("2d",{willReadFrequently:!0});if(!s)throw ht.Errors.nullContext;const h=bi.stringWidth(e(this,W,"f").text)+20;s.beginPath();let a=e(this,W,"f").x+h>e(this,C,"f").width?e(this,C,"f").width-h:e(this,W,"f").x,n=e(this,W,"f").y+24>e(this,C,"f").height?e(this,C,"f").height-24:e(this,W,"f").y;if(e(this,S,"m",D).call(this,t,a,n,h,24)?(e(this,C,"f").style.cursor="pointer",i&&t.x===i.x&&t.y===i.y&&(this.isActive=!this.isActive,i=void 0),this.isActive?s.fillStyle=bi.adjustColor("#ffffff",-40):this.animations.add("animation-dropdown",Q.MouseOver,{duration:300,body:t=>{this.animations.reload("animation-dropdown",Q.MouseLeave),s.fillStyle=bi.adjustColor("#ffffff",-Math.round(40*t))}})):(e(this,C,"f").style.cursor="default",this.isActive?s.fillStyle=bi.adjustColor("#ffffff",-40):this.animations.add("animation-dropdown",Q.MouseLeave,{duration:300,body:t=>{this.animations.reload("animation-dropdown",Q.MouseOver),s.fillStyle=bi.adjustColor("#ffffff",-Math.round(40*(1-t)))}})),s.strokeStyle="#ffffff",s.roundRect(a,n,h,24,4),s.fill(),s.fillStyle="#000000",s.textAlign="center",s.textBaseline="middle",s.font="14px serif",s.fillText(e(this,W,"f").text,a+h/2,n+12),s.closePath(),this.isActive){n+=24;let h=Math.max(...e(this,W,"f").items.map(t=>bi.stringWidth(t.text)))+8;h<50&&(h=50),a+h>e(this,C,"f").width-4&&(a-=a+h-e(this,C,"f").width+4),s.beginPath(),s.roundRect(a,n,h,20*e(this,W,"f").items.length+8,4),s.fillStyle="#ffffff",s.strokeStyle="#353535",s.fill(),s.stroke(),s.closePath(),s.beginPath(),n+=4;for(const o of e(this,W,"f").items)e(this,S,"m",D).call(this,t,a,n,h,20)?(this.animations.add("animation-dropdown"+o.text,Q.MouseOver,{duration:300,before:()=>void 0===i,body:t=>{this.animations.reload("animation-dropdown"+o.text,Q.MouseLeave),s.fillStyle=bi.adjustColor("#ffffff",60-Math.round(100*t))}}),e(this,C,"f").style.cursor="pointer",i&&(o.action(),i=void 0,this.isActive=!1)):this.animations.add("animation-dropdown"+o.text,Q.MouseLeave,{duration:300,body:t=>{this.animations.reload("animation-dropdown",Q.MouseOver),s.fillStyle=bi.adjustColor("#ffffff",60-Math.round(100*(1-t)))}}),s.rect(a,n,h,20),s.fill(),s.fillStyle="#000000",s.textAlign="center",s.textBaseline="hanging",s.fillText(o.text,a+h/2,n+4),n+=20;s.closePath(),s.fillStyle="#000000"}return void 0!==i&&this.isActive&&(this.isActive=!1,i=void 0),mi(this,P,!0,"f"),i}refresh(){mi(this,P,!1,"f")}}C=new WeakMap,W=new WeakMap,T=new WeakMap,P=new WeakMap,S=new WeakSet,I=function(){mi(this,T,e(this,C,"f").getBoundingClientRect(),"f"),e(this,T,"f").x+=window.scrollX,e(this,T,"f").y+=window.scrollY},D=function(t,i,s,h,a){if(!t)return!1;let n=t.clientX-e(this,T,"f").x+window.scrollX,o=t.clientY-e(this,T,"f").y+window.scrollY;return n>=i&&n<=i+h&&o>=s&&o<=s+a};class Mi{static asPng(t,i){const s=t.getContext("2d",{willReadFrequently:!0});if(!s)throw ht.Errors.nullContext;let e=bi.stringWidth("Export PNG")+16;e<50&&(e=50),s.clearRect(t.width-e,0,e,64);let h=0,a=0;const n=new Uint32Array(s.getImageData(0,0,t.width,t.height).data.buffer);let o=!1;for(let i=0;i<t.width;i++){for(let s=0;s<t.height;s++)if(4278190080&n[i+s*t.width]){o=!0;break}if(o)break;h++}o=!1;for(let i=t.width;i>=0;i--){for(let s=0;s<t.height;s++)if(4278190080&n[i+s*t.width]){o=!0;break}if(o)break;a++}h>4&&(h-=4),a>4&&(a-=4),h>a&&(h=a),a>h&&(a=h);let l=document.createElement("canvas");l.width=t.width-h-a,l.height=t.height;let f=l.getContext("2d");if(!f)throw ht.Errors.nullContext;f.fillStyle="#FFFFFF",f.fillRect(0,0,t.width,t.height),f.drawImage(t,-h,0);let r=document.createElement("a");r.href=l.toDataURL("image/png"),r.download=(i??"chart")+".png",r.click()}}class bi{static adjustColor(t,i){return"#"+t.replace(/^#/,"").replace(/../g,t=>("0"+Math.min(255,Math.max(0,parseInt(t,16)+i)).toString(16)).slice(-2))}static grayScale(t){return"#"+Array(4).join(Math.round([.3,.59,.11].reduce((i,s,e)=>i+s*parseInt(t[2*e+1]+t[2*e+2],16),0)/3).toString(16).padStart(2,"0"))}static randomColor(){let t="#";for(let i=0;i<6;i++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}static stringWidth(t,i){const s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2796875,.2765625,.3546875,.5546875,.5546875,.8890625,.665625,.190625,.3328125,.3328125,.3890625,.5828125,.2765625,.3328125,.2765625,.3015625,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.2765625,.2765625,.584375,.5828125,.584375,.5546875,1.0140625,.665625,.665625,.721875,.721875,.665625,.609375,.7765625,.721875,.2765625,.5,.665625,.5546875,.8328125,.721875,.7765625,.665625,.7765625,.721875,.665625,.609375,.721875,.665625,.94375,.665625,.665625,.609375,.2765625,.3546875,.2765625,.4765625,.5546875,.3328125,.5546875,.5546875,.5,.5546875,.5546875,.2765625,.5546875,.5546875,.221875,.240625,.5,.221875,.8328125,.5546875,.5546875,.5546875,.5546875,.3328125,.5,.2765625,.5546875,.5,.721875,.5,.5,.5,.3546875,.259375,.353125,.5890625];return Array.from(t).reduce((t,i)=>t+(s[i.charCodeAt(0)]??.5279276315789471),0)*(i||14)}static guid(){const t=()=>(65536*(1+Math.random())|0).toString(16).substring(1);return(t()+t()+"-"+t()+"-4"+t().slice(0,3)+"-"+t()+"-"+t()+t()+t()).toLowerCase()}static hexToRgb(t){if(t.length>4){const i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(i)return{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}}else{const i=/^#?([a-f\d])([a-f\d])([a-f\d])$/i.exec(t);if(i)return{r:parseInt(i[1]+i[1],16),g:parseInt(i[2]+i[2],16),b:parseInt(i[3]+i[3],16)}}return new Di}static isColorVisible(t,i){const s=bi.hexToRgb(t),e=bi.hexToRgb(i);return(s.r+s.g+s.b)/(e.r+e.g+e.b)<.77}static isISOString(t){return/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+/.test(t)}}class ki{constructor(t,i){switch(R.add(this),L.set(this,void 0),F.set(this,void 0),E.set(this,void 0),A.set(this,!1),B.set(this,void 0),this.chart=t,this.canvas=document.createElement("canvas"),this.canvas.style.width="fit-content",t.settings.legendPlace){case it.Bottom:this.canvas.width=this.chart.settings.width,this.canvas.height=ki.getLegendHeight(this.chart.data.values,this.canvas.width),i.style.flexDirection="column";break;case it.Top:this.canvas.width=this.chart.settings.width,this.canvas.height=ki.getLegendHeight(this.chart.data.values,this.canvas.width),i.style.flexDirection="column-reverse";break;case it.Left:this.canvas.width=500,this.canvas.height=this.chart.settings.height,i.style.flexDirection="row";break;case it.Right:this.canvas.width=500,this.canvas.height=this.chart.settings.height,i.style.flexDirection="row-reverse"}t.node.append(this.canvas),this.animations=new wi,mi(this,B,new xi(this.canvas,{x:this.canvas.width-110,y:10,text:"Reset",action:()=>{for(let t of this.chart.data.values)t.reset()}}),"f"),e(this,R,"m",Y).call(this)}render(){const t=this.canvas.getContext("2d",{willReadFrequently:!0});if(!t)throw ht.Errors.nullContext;t.clearRect(0,0,this.canvas.width,this.canvas.height);let i={x:20,y:20};this.canvas.style.cursor="default",t.font="14px serif",t.textAlign="start",t.textBaseline="alphabetic",t.strokeStyle="#000000";const s=ki.getOffsetToCenter(this.chart.data.values,this.canvas.width),h=(this.canvas.height-ki.getLegendHeight(this.chart.data.values,this.canvas.width))/2;t.translate(s,h);for(const t of this.chart.data.values.filter(t=>!t.hideInLegend))i=e(this,R,"m",O).call(this,t,i.x,i.y,s,h);t.translate(-s,-h),requestAnimationFrame(this.render.bind(this)),mi(this,E,e(this,B,"f").render(e(this,F,"f"),e(this,E,"f")),"f"),mi(this,A,!0,"f")}refresh(){mi(this,A,!1,"f")}resize(){e(this,R,"m",Y).call(this)}static getOffsetToCenter(t,i){let s=20;for(const e of t.filter(t=>!t.hideInLegend)){const t=bi.stringWidth(e.label);if(s+t+47>=i-100)break;s+=t+47}return i/2-s/2}static getLegendHeight(t,i){let s=1,e=20,h=ki.getOffsetToCenter(t,i);for(const a of t.filter(t=>!t.hideInLegend)){const t=bi.stringWidth(a.label);e+t+57>=i-100-h&&(e=20,s++),e+=t+57}return 40*s}}function Si(){}L=new WeakMap,F=new WeakMap,E=new WeakMap,A=new WeakMap,B=new WeakMap,R=new WeakSet,O=function(t,i,s,h,a){const n=this.canvas.getContext("2d",{willReadFrequently:!0});if(!n)throw ht.Errors.nullContext;const o=bi.stringWidth(t.label),l=10;i+50+o>=this.canvas.width-100-h&&(i=20,s+=38);let f=i-l-l,r=s-5-l,d=52+o;const c=t=>{if(!t)return!1;const i=t.clientX-e(this,L,"f").x+window.scrollX-h,s=t.clientY-e(this,L,"f").y+window.scrollY-a;return i>=f&&i<=f+d&&s>=r&&s<=r+30};return e(this,E,"f")&&this.animations.add(t.id,Q.Click,{duration:220,continuous:!0,before:()=>c(e(this,E,"f"))&&t.checkCondition(),body:i=>{t.toggle(i),1===i&&mi(this,E,new PointerEvent("click"),"f")}}),e(this,F,"f")&&(c(e(this,F,"f"))&&(this.canvas.style.cursor="pointer"),this.animations.add(t.id,Q.MouseLeave,{duration:100,before:()=>!c(e(this,F,"f"))&&!e(this,A,"f"),body:t=>{n.beginPath(),n.roundRect(f,r,d,30,l),n.fillStyle=bi.adjustColor("#ffffff",Math.round(-50*(1-t))),n.fill()}}),this.animations.add(t.id,Q.MouseOver,{duration:100,before:()=>c(e(this,F,"f")),body:t=>{n.beginPath(),n.roundRect(f,r,d,30,l),n.fillStyle=bi.adjustColor("#ffffff",Math.round(-50*t)),n.fill()}})),n.beginPath(),n.arc(i,s,l,0,2*Math.PI),n.fillStyle=t.disabled?bi.grayScale(t.color):t.color,n.fill(),n.fillStyle="#000000",n.fillText(t.label,i+20,s+4),i+=20,t.disabled&&(n.beginPath(),n.moveTo(i-5,s),n.lineTo(i+o,s),n.stroke()),{x:i+=o+45,y:s}},Y=function(){mi(this,L,this.canvas.getBoundingClientRect(),"f"),e(this,L,"f").x+=window.scrollX,e(this,L,"f").y+=window.scrollY,e(this,A,"f")||(this.canvas.onmousemove=t=>mi(this,F,t,"f"),this.canvas.onclick=t=>mi(this,E,t,"f"))},Si.chart=function(t,i){return new yi(t,i)},window.OCharts=Si;class Ci{constructor(t,i){q.add(this),X.set(this,void 0),j.set(this,void 0),$.set(this,void 0),N.set(this,void 0),z.set(this,void 0),H.set(this,void 0),G.set(this,void 0),_.set(this,120),this.canvas=t,this.data=i.data,mi(this,X,i.enableTooltip,"f"),mi(this,j,!!i.templateId,"f"),e(this,j,"f")&&mi(this,N,document.getElementById(i.templateId),"f"),this.refresh()}render(t,i,s,h){if(e(this,q,"m",V).call(this),e(this,X,"f")&&i)if(t||e(this,z,"f")||e(this,H,"f")){e(this,G,"f")||mi(this,G,new Date,"f"),e(this,H,"f")?e(this,z,"f")&&mi(this,G,new Date,"f"):mi(this,z,!0,"f"),e(this,j,"f")?e(this,q,"m",J).call(this,i,h):e(this,q,"m",U).call(this,i,s);const a=e(this,q,"m",K).call(this);e(this,H,"f")&&a>=1&&(mi(this,z,!1,"f"),mi(this,H,!1,"f")),e(this,H,"f")&&a<=0&&(mi(this,z,!1,"f"),mi(this,H,!1,"f"),mi(this,G,void 0,"f")),t||null==e(this,G,"f")||mi(this,H,!0,"f")}else mi(this,G,void 0,"f")}refresh(){mi(this,$,this.canvas.getBoundingClientRect(),"f"),e(this,$,"f").x+=window.scrollX,e(this,$,"f").y+=window.scrollY}}X=new WeakMap,j=new WeakMap,$=new WeakMap,N=new WeakMap,z=new WeakMap,H=new WeakMap,G=new WeakMap,_=new WeakMap,q=new WeakSet,U=function(t,i){const s=this.canvas.getContext("2d",{willReadFrequently:!0});if(!s)throw ht.Errors.nullContext;const h=i.split("\n").filter(t=>!!t),a=Math.max(...h.map(t=>bi.stringWidth(t)));let n=t.clientX-e(this,$,"f").x+10,o=t.clientY-e(this,$,"f").y+window.scrollY+10;n+a+16>e(this,$,"f").width&&(n=e(this,$,"f").width-(a+16)),o+10+18*h.length>e(this,$,"f").height&&(o=e(this,$,"f").height-10-18*h.length),s.beginPath(),s.roundRect(n,o,a+16,16+16*h.length,20);let l=Math.round(77*e(this,q,"m",K).call(this)).toString(16);1==l.length&&(l="0"+l),s.fillStyle="#000000"+l,s.fill();for(let t of h)s.fillStyle="#ffffff",s.font="14px serif",s.textAlign="start",s.textBaseline="alphabetic",s.fillText(t,n+12,o+22),o+=16},J=function(t,i){if(void 0===i)return;const s=e(this,N,"f").id+i.id;let h=document.getElementById(s);const a=()=>{e(this,q,"m",V).call(this),h.style.visibility="visible"};if(!h){const t=/\${[^}]*}/gm;let n=e(this,N,"f").cloneNode(!0);h=document.createElement("div"),h.innerHTML=n.innerHTML,h.id=s,h.style.position="absolute",h.style.pointerEvents="none",h.style.visibility="visible",h.setAttribute("name",e(this,N,"f").id);const o=[...h.innerHTML.matchAll(t)];let l=h.innerHTML;for(const t of o){const s=t[0].replace("${","").replace("}","").replaceAll(" ","");l=l.replaceAll(t[0],i.data[s])}h.innerHTML=l,document.body.appendChild(h),h.position=h.getBoundingClientRect(),a()}"hidden"===h.style.visibility&&a(),0===h.position.height&&(h.position=h.getBoundingClientRect());const n=10;let o=t.clientX,l=t.clientY+window.scrollY;o+h.position.width-e(this,$,"f").x>e(this,$,"f").width-n&&(o=e(this,$,"f").width-h.position.width+e(this,$,"f").x-n),l+h.position.height-e(this,$,"f").y>e(this,$,"f").height-n&&(l=e(this,$,"f").height-h.position.height+e(this,$,"f").y-n),h.style.left=o+n+"px",h.style.top=l+n+"px"},V=function(){if(!e(this,j,"f"))return;const t=document.querySelectorAll(`[name="${e(this,N,"f").id}"]`);for(let i of t)i.style.visibility="hidden"},K=function(){if(!e(this,G,"f"))return 0;let t=e(this,H,"f")?1-((new Date).getTime()-e(this,G,"f").getTime())/e(this,_,"f"):((new Date).getTime()-e(this,G,"f").getTime())/e(this,_,"f");return t>1&&(t=1),t<0&&(t=0),t},function(t){t[t.MouseOver=0]="MouseOver",t[t.MouseLeave=1]="MouseLeave",t[t.Init=2]="Init",t[t.Click=3]="Click"}(Q||(Q={})),function(t){t[t.Plot=0]="Plot",t[t.Circular=1]="Circular",t[t.Gauge=2]="Gauge",t[t.TreeMap=3]="TreeMap"}(Z||(Z={})),function(t){t[t.Pie=0]="Pie",t[t.Donut=1]="Donut"}(tt||(tt={})),function(t){t[t.Bottom=0]="Bottom",t[t.Left=1]="Left",t[t.Top=2]="Top",t[t.Right=3]="Right"}(it||(it={})),function(t){t[t.Date=1]="Date"}(st||(st={})),function(t){t[t.Line=0]="Line",t[t.AttentionLine=1]="AttentionLine",t[t.Column=2]="Column",t[t.Bar=3]="Bar",t[t.StackingColumn=4]="StackingColumn"}(et||(et={})),function(t){class i{}i.nullContext=new Error("Can't find context"),t.Errors=i}(ht||(ht={}));class Wi extends h{constructor(t,i){if(super(t,i),at.add(this),nt.set(this,!1),ot.set(this,void 0),lt.set(this,void 0),ft.set(this,void 0),rt.set(this,void 0),dt.set(this,void 0),ct.set(this,void 0),ut.set(this,void 0),gt.set(this,void 0),vt.set(this,void 0),mt.set(this,void 0),wt.set(this,void 0),xt.set(this,void 0),yt.set(this,void 0),pt.set(this,void 0),this.data=this.chart.data,this.data.values=this.data.values.map(t=>new Li(t)),i.enableOther&&this.data.values.length>20){const t=this.data.values.splice(20).reduce((t,i)=>t+i.current,0);this.data.values=this.data.values.slice(0,20),this.data.values.push(new Li({value:t,current:t,label:"Other",id:bi.guid(),color:"#a3a3a3",innerRadius:this.data.innerRadius}))}for(const t of this.data.values)t.current=t.value,t.innerRadius??=this.data.type===tt.Donut?this.data.innerRadius??50:0;mi(this,pt,new pi(this.canvas,{x:this.canvas.width-10,y:10,text:"Menu",items:[{text:"Export PNG",action:()=>{Mi.asPng(this.canvas,this.settings.title)}}]}),"f"),e(this,at,"m",Tt).call(this),mi(this,gt,Math.random()%(2*Math.PI),"f"),mi(this,wt,[],"f"),e(this,at,"m",kt).call(this),this.canvas.dispatchEvent(new MouseEvent("mousemove"))}render(){super.render(),mi(this,dt,e(this,gt,"f"),"f"),mi(this,mt,!1,"f"),this.canvas.style.cursor="default",0===this.data.values.filter(t=>!t.disabled).length?e(this,at,"m",Ct).call(this):e(this,at,"m",Mt).call(this),mi(this,ut,e(this,pt,"f").render(e(this,ct,"f"),e(this,ut,"f")),"f"),mi(this,nt,!0,"f")}refresh(){super.refresh(),mi(this,nt,!1,"f"),e(this,pt,"f").refresh()}resize(){super.resize(),e(this,at,"m",kt).call(this),e(this,at,"m",Tt).call(this)}resetMouse(){super.resetMouse(),mi(this,ct,new MouseEvent("mousemove"),"f"),mi(this,ut,new MouseEvent("click"),"f")}}nt=new WeakMap,ot=new WeakMap,lt=new WeakMap,ft=new WeakMap,rt=new WeakMap,dt=new WeakMap,ct=new WeakMap,ut=new WeakMap,gt=new WeakMap,vt=new WeakMap,mt=new WeakMap,wt=new WeakMap,xt=new WeakMap,yt=new WeakMap,pt=new WeakMap,at=new WeakSet,Mt=function(){if(e(this,ct,"f")||!e(this,nt,"f")){mi(this,rt,this.data.values.reduce((t,i)=>t+i.current,0),"f");let t=e(this,gt,"f");mi(this,xt,this.data.values.flatMap(i=>{const s=i.current/e(this,rt,"f")*2*Math.PI;return{id:i.id,value:s,sum:(t+=s)-s}}).reverse(),"f"),mi(this,yt,{x:e(this,lt,"f").x+e(this,ft,"f")*Math.cos(e(this,gt,"f")),y:e(this,lt,"f").y+e(this,ft,"f")*Math.sin(e(this,gt,"f"))},"f");for(const t of this.data.values)e(this,at,"m",bt).call(this,t);const i=this.data.values.find(t=>t.id===e(this,vt,"f"));this.tooltip.render(e(this,mt,"f")&&!!e(this,vt,"f"),e(this,ct,"f"),`${i?.label}: ${i?.current.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`),e(this,at,"m",Wt).call(this)}requestAnimationFrame(this.render.bind(this))},bt=function(t){const i=this.canvas.getContext("2d",{willReadFrequently:!0});if(!i)throw ht.Errors.nullContext;i.fillStyle=t.color,i.strokeStyle=t.color;const s=t.current/e(this,rt,"f"),h=2*(isNaN(s)?1:s)*Math.PI,a=1===this.data.values.filter(t=>!t.disabled).length;!e(this,ut,"f")&&!e(this,wt,"f").includes(t.id)||this.animations.contains(t.id,Q.Init)||a||this.animations.add(t.id,Q.Click,{duration:100,before:()=>(e(this,ut,"f")&&e(this,at,"m",St).call(this,e(this,ut,"f"),t)&&(e(this,wt,"f").includes(t.id)?mi(this,wt,e(this,wt,"f").filter(i=>i!==t.id),"f"):e(this,wt,"f").push(t.id),mi(this,ut,new PointerEvent("click"),"f")),!0),body:()=>{if(!e(this,wt,"f").includes(t.id))return;let s=e(this,dt,"f")+h/2;const a={x:20*Math.cos(s),y:20*Math.sin(s)};i.translate(a.x,a.y),i.fillStyle=t.color}}),e(this,ct,"f")&&e(this,at,"m",St).call(this,e(this,ct,"f"),t)&&(mi(this,vt,t.id,"f"),mi(this,mt,!0,"f")),!e(this,nt,"f")||this.animations.contains(t.id,Q.Init)?this.animations.add(t.id,Q.Init,{timer:new Date,duration:125+(this.chart.data.values.indexOf(t)+1)/this.chart.data.values.length*175,continuous:!0,body:s=>{const a=e(this,lt,"f").x+e(this,ft,"f")/2*Math.cos(e(this,dt,"f")+h/2),n=e(this,lt,"f").y+e(this,ft,"f")/2*Math.sin(e(this,dt,"f")+h/2),o=.7,l=1-o;i.translate(a-a*(o+s*l),n-n*(o+s*l)),i.scale(o+s*l,o+s*l);let f=Math.round(255*s).toString(16);f.length<2&&(f=0+f),i.fillStyle=t.color+f,i.strokeStyle=t.color+f}}):!e(this,ct,"f")||this.animations.contains(t.id,Q.Init)||e(this,wt,"f").includes(t.id)||a||(e(this,at,"m",St).call(this,e(this,ct,"f"),t)?this.animations.add(t.id,Q.MouseOver,{duration:100,body:s=>{const h=t.current/e(this,rt,"f"),a=2*(isNaN(h)?1:h)*Math.PI;this.canvas.style.cursor="pointer";let n=e(this,dt,"f")+a/2;const o={x:20*Math.cos(n)*s,y:20*Math.sin(n)*s};i.translate(o.x,o.y),t.transition=o,i.fillStyle=bi.adjustColor(t.color,Math.round(33*s)),i.strokeStyle=bi.adjustColor(t.color,Math.round(33*s)),this.animations.reload(t.id,Q.MouseLeave)}}):this.animations.add(t.id,Q.MouseLeave,{timer:new Date(2e3,1,1),duration:100,body:s=>{let a=e(this,dt,"f")+h/2;const n={x:20*Math.cos(a)*(1-s),y:20*Math.sin(a)*(1-s)};i.translate(n.x,n.y),t.transition=n,i.fillStyle=bi.adjustColor(t.color,Math.round(33*(1-s))),i.strokeStyle=bi.adjustColor(t.color,Math.round(33*(1-s))),this.animations.reload(t.id,Q.MouseOver)}}));let n={x:e(this,lt,"f").x+e(this,ft,"f")*Math.cos(e(this,dt,"f")+h),y:e(this,lt,"f").y+e(this,ft,"f")*Math.sin(e(this,dt,"f")+h)};if(h>0){if(i.save(),t.current>0){let s={x:e(this,lt,"f").x+(e(this,ft,"f")+10)*Math.cos(e(this,dt,"f")+h/2),y:e(this,lt,"f").y+(e(this,ft,"f")+10)*Math.sin(e(this,dt,"f")+h/2)},a={x:e(this,lt,"f").x+(e(this,ft,"f")+20)*Math.cos(e(this,dt,"f")+h/2),y:e(this,lt,"f").y+(e(this,ft,"f")+20)*Math.sin(e(this,dt,"f")+h/2)};const n=s.x>e(this,lt,"f").x?1:-1;let o={x:a.x+10*n,y:a.y},l=!1;const f=bi.stringWidth(t.label),r=1===n?o.x+8:o.x-f-8,d=new Uint32Array(i.getImageData(r,o.y-12,f,24).data.buffer);if((r<0||r+f>this.canvas.width||o.y-12<0||o.y+12>this.canvas.height)&&(l=!0),!l)for(let t=0;t<d.length;t++)if(4278190080&d[t]){l=!0;break}if(!l){i.beginPath(),i.moveTo(s.x,s.y),i.quadraticCurveTo(a.x,a.y,o.x,o.y),i.strokeStyle="#000000",i.stroke();let e=Math.round(t.current/t.value*255).toString(16);e.length<2&&(e=0+e),i.fillStyle="#000000"+e,i.textAlign=1===n?"start":"end",i.textBaseline="alphabetic",i.font="14px serif",i.fillText(t.label,o.x+8*n,o.y+4)}}i.restore(),i.beginPath(),this.chart.data.type===tt.Pie&&i.moveTo(e(this,lt,"f").x,e(this,lt,"f").y),i.lineTo(e(this,yt,"f").x,e(this,yt,"f").y);let s=0,a=h;for(;a>0;){let t=a-Math.PI/6>0?Math.PI/6:a;n={x:e(this,lt,"f").x+e(this,ft,"f")*Math.cos(e(this,dt,"f")+s+t),y:e(this,lt,"f").y+e(this,ft,"f")*Math.sin(e(this,dt,"f")+s+t)};const h=Math.PI-t,o=e(this,ft,"f")/Math.sin(h/2),l={x:e(this,lt,"f").x+o*Math.cos(e(this,dt,"f")+s+t/2),y:e(this,lt,"f").y+o*Math.sin(e(this,dt,"f")+s+t/2)};i.quadraticCurveTo(l.x,l.y,n.x,n.y),s+=t,a-=Math.PI/6}if(this.chart.data.type===tt.Donut||0!==t.innerRadius){const o=e(this,ft,"f")*(t.innerRadius/100),l={x:n.x-(e(this,ft,"f")-o)*(n.x-e(this,lt,"f").x)/e(this,ft,"f"),y:n.y-(e(this,ft,"f")-o)*(n.y-e(this,lt,"f").y)/e(this,ft,"f")};for(i.lineTo(l.x,l.y),a=0,s=h;a<h;){let t=a+Math.PI/6<h?Math.PI/6:h-a;n={x:e(this,lt,"f").x+o*Math.cos(e(this,dt,"f")+s-t),y:e(this,lt,"f").y+o*Math.sin(e(this,dt,"f")+s-t)};const l=Math.PI-t,f=o/Math.sin(l/2),r={x:e(this,lt,"f").x+f*Math.cos(e(this,dt,"f")+s-t/2),y:e(this,lt,"f").y+f*Math.sin(e(this,dt,"f")+s-t/2)};i.quadraticCurveTo(r.x,r.y,n.x,n.y),s-=t,a+=Math.PI/6}n={x:e(this,lt,"f").x+e(this,ft,"f")*Math.cos(e(this,dt,"f")+h),y:e(this,lt,"f").y+e(this,ft,"f")*Math.sin(e(this,dt,"f")+h)}}i.closePath(),i.fill(),i.stroke(),mi(this,dt,e(this,dt,"f")+h,"f")}i.resetTransform(),mi(this,yt,n,"f")},kt=function(){mi(this,ot,this.canvas.getBoundingClientRect(),"f"),e(this,ot,"f").x+=window.scrollX,e(this,ot,"f").y+=window.scrollY,e(this,nt,"f")||(this.canvas.onmousemove=t=>mi(this,ct,t,"f"),this.canvas.onclick=t=>mi(this,ut,t,"f"))},St=function(t,i){const s=t=>t.x*t.x+t.y*t.y<=e(this,ft,"f")*e(this,ft,"f")&&(this.data.type!==tt.Donut||t.x*t.x+t.y*t.y>=e(this,ft,"f")*(i.innerRadius/100)*e(this,ft,"f")*(i.innerRadius/100));let h={x:t.clientX-e(this,ot,"f").x+window.scrollX,y:t.clientY-e(this,ot,"f").y+window.scrollY};const a={x:h.x-e(this,lt,"f").x,y:h.y-e(this,lt,"f").y},n={x:h.x-e(this,lt,"f").x-i.transition?.x,y:h.y-e(this,lt,"f").y-i.transition?.y};return(t=>{let s=Math.atan2(t.y-e(this,lt,"f").y,t.x-e(this,lt,"f").x);s<0&&(s+=2*Math.PI),s<e(this,gt,"f")&&(s=2*Math.PI-Math.abs(e(this,gt,"f")-s)+e(this,gt,"f"));let h=e(this,xt,"f").findIndex(t=>t.id===i.id),a=e(this,xt,"f")[h].sum;return a<=s&&a+e(this,xt,"f")[h].value-s>=0})(h)&&(s(a)||s(n))},Ct=function(){const t=this.canvas.getContext("2d",{willReadFrequently:!0});if(!t)throw ht.Errors.nullContext;t.clearRect(0,0,e(this,ot,"f").width,e(this,ot,"f").height),t.closePath(),t.beginPath(),t.arc(e(this,lt,"f").x,e(this,lt,"f").y,e(this,ft,"f"),0,2*Math.PI),t.strokeStyle="#000000",t.stroke(),t.font="14px serif",t.textAlign="center",t.textBaseline="middle",t.fillStyle="#000000",t.fillText("All data is hidden",e(this,lt,"f").x,e(this,lt,"f").y),requestAnimationFrame(this.render.bind(this))},Wt=function(){if(this.data.innerTitle){const t=this.canvas.getContext("2d",{willReadFrequently:!0});if(!t)throw ht.Errors.nullContext;t.beginPath(),t.fillStyle="#000000",t.font="16px serif",t.textAlign="center",t.textBaseline="middle",t.fillText(this.data.innerTitle,e(this,lt,"f").x,e(this,lt,"f").y),t.closePath()}},Tt=function(){const t=this.canvas.width>this.canvas.height?this.canvas.height:this.canvas.width;mi(this,lt,{x:this.canvas.width/2,y:this.canvas.height/2},"f"),mi(this,ft,t/3,"f")};class Ti extends h{constructor(t,i){super(t,i),Pt.add(this),It.set(this,void 0),Dt.set(this,void 0),Rt.set(this,void 0),Lt.set(this,void 0),Ft.set(this,void 0),Et.set(this,void 0),At.set(this,void 0),this.data=t.data,e(this,Pt,"m",qt).call(this),mi(this,Rt,new pi(this.canvas,{x:this.canvas.width-10,y:10,text:"Menu",items:[{text:"Export PNG",action:()=>{Mi.asPng(this.canvas,this.settings.title)}}]}),"f"),this.data.values.length>0&&this.data.values[0].value>this.data.max&&(this.data.values[0].value=this.data.max),this.animations=new wi,e(this,Pt,"m",Yt).call(this)}render(){super.render(),e(this,Pt,"m",Bt).call(this);const t=this.data.values[0];this.tooltip.render(e(this,Pt,"m",Ot).call(this,e(this,Ft,"f"),t),e(this,Ft,"f"),`${t?.label}: ${t?.current.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`),mi(this,Et,e(this,Rt,"f").render(e(this,Ft,"f"),e(this,Et,"f")),"f"),requestAnimationFrame(this.render.bind(this)),mi(this,At,!0,"f")}refresh(){super.refresh()}resize(){super.resize(),e(this,Pt,"m",Yt).call(this),e(this,Pt,"m",qt).call(this)}resetMouse(){super.resetMouse(),mi(this,Ft,new MouseEvent("mousemove"),"f"),mi(this,Et,new MouseEvent("click"),"f")}}It=new WeakMap,Dt=new WeakMap,Rt=new WeakMap,Lt=new WeakMap,Ft=new WeakMap,Et=new WeakMap,At=new WeakMap,Pt=new WeakSet,Bt=function(){const t=this.canvas.getContext("2d",{willReadFrequently:!0});if(!t)throw ht.Errors.nullContext;const i=this.data.values[0]??{id:bi.guid()};e(this,At,"f")&&!this.animations.contains(i.id,Q.Init)||this.animations.add(i.id,Q.Init,{duration:450,continuous:!0,body:t=>{i.current=i.value*t}}),t.beginPath(),t.strokeStyle=i.color,t.lineCap="round",t.lineWidth=40;const s=i.current/this.data.max,h=(isNaN(s)?1:s)*Math.PI;i.value&&(t.arc(e(this,Dt,"f").x,e(this,Dt,"f").y,e(this,It,"f"),Math.PI,h-Math.PI),t.stroke()),t.beginPath(),t.lineWidth=1,t.lineCap="square";let a=0,n=Math.PI;for(;n>=0;){let i=n-Math.PI/10>0?Math.PI/10:n,s={x:e(this,Dt,"f").x+(e(this,It,"f")+50)*Math.cos(Math.PI+a),y:e(this,Dt,"f").y+(e(this,It,"f")+50)*Math.sin(Math.PI+a)},o={x:e(this,Dt,"f").x+(e(this,It,"f")+90)*Math.cos(Math.PI+a),y:e(this,Dt,"f").y+(e(this,It,"f")+90)*Math.sin(Math.PI+a)},l={x:e(this,Dt,"f").x+(e(this,It,"f")+115)*Math.cos(Math.PI+a),y:e(this,Dt,"f").y+(e(this,It,"f")+115)*Math.sin(Math.PI+a)};const f=Math.PI-n>h?"66":"ff";t.moveTo(s.x,s.y),t.lineTo(o.x,o.y),t.strokeStyle="#000000"+f,t.stroke(),t.textAlign="center",t.textBaseline="middle",t.fillStyle="#000000"+f,t.fillText((this.data.max-n/Math.PI*this.data.max).toString(),l.x,l.y),a+=i,n-=Math.PI/10}},Ot=function(t,i){if(!t)return!1;let s={x:t.clientX-e(this,Lt,"f").x+window.scrollX,y:t.clientY-e(this,Lt,"f").y+window.scrollY};const h={x:s.x-e(this,Dt,"f").x,y:s.y-e(this,Dt,"f").y};return(t=>{let s=Math.atan2(t.y-e(this,Dt,"f").y,t.x-e(this,Dt,"f").x);s<0&&(s+=2*Math.PI);const h=i.current/this.data.max,a=(isNaN(h)?1:h)*Math.PI;return s>Math.PI&&Math.PI+a>=s})(s)&&(t=>{const i=e(this,It,"f")+20,s=e(this,It,"f")-20;return t.x*t.x+t.y*t.y<=i*i&&t.x*t.x+t.y*t.y>=s*s})(h)},Yt=function(){mi(this,Lt,this.canvas.getBoundingClientRect(),"f"),e(this,Lt,"f").x+=window.scrollX,e(this,Lt,"f").y+=window.scrollY,e(this,At,"f")||(this.canvas.onmousemove=t=>mi(this,Ft,t,"f"),this.canvas.onclick=t=>mi(this,Et,t,"f"))},qt=function(){const t=this.canvas.width<this.canvas.height?this.canvas.height-250:this.canvas.width;mi(this,It,t/3,"f"),mi(this,Dt,{x:this.canvas.width/2,y:this.canvas.height-e(this,It,"f")/3},"f")};class Pi extends h{constructor(t,i){if(super(t,i),Xt.add(this),jt.set(this,void 0),$t.set(this,void 0),Nt.set(this,void 0),zt.set(this,void 0),Ht.set(this,void 0),Gt.set(this,void 0),_t.set(this,void 0),Ut.set(this,void 0),Jt.set(this,void 0),Vt.set(this,void 0),Kt.set(this,void 0),Qt.set(this,void 0),Zt.set(this,void 0),ti.set(this,void 0),ii.set(this,void 0),si.set(this,void 0),ei.set(this,void 0),this.data=t.data,this.data.values=this.data.values.map(t=>new Ri(t)),this.data.values.filter(t=>t.type===et.Bar).length>0)for(let t of this.data.values){for(let i of t.values){const t=i.x;i.x=i.y,i.y=t}t.values.sort((t,i)=>i.x>t.x?1:-1)}mi(this,Nt,{top:30,right:40,bottom:50,left:80},"f"),i.title&&(e(this,Nt,"f").top+=50),mi(this,_t,new pi(this.canvas,{x:this.canvas.width-10,y:10,text:"Menu",items:[{text:"Export PNG",action:()=>{Mi.asPng(this.canvas,this.settings.title)}}]}),"f"),e(this,Xt,"m",li).call(this),this.tooltip=new Ci(this.canvas,this.settings),mi(this,Kt,new Map,"f"),mi(this,Qt,new Map,"f"),e(this,Xt,"m",hi).call(this)}render(){super.render();let t=e(this,Jt,"f")?e(this,Kt,"f").get(Math.round(e(this,Jt,"f"))):e(this,Vt,"f")?e(this,Qt,"f").get(Math.round(e(this,Vt,"f"))):void 0;const i=this.canvas.getContext("2d",{willReadFrequently:!0});if(!i)throw ht.Errors.nullContext;i.textAlign="center",i.textBaseline="top",i.font="14px serif",i.fillStyle="#000000",i.lineJoin="round";const s="#00000088";e(this,Xt,"m",oi).call(this);let h=0,a=0,n=0,o=0,l=0,f=0,r=this.data.values.filter(t=>t.type===et.Column).length,d=0,c=this.data.values.filter(t=>t.type===et.Bar).length,u=e(this,$t,"f").step/(2*c),g=[];for(let t=0;t<e(this,ti,"f").length;t++)g.push(0);let v=!1;for(const c of this.data.values.filter(t=>!t.disabled)){let m;i.beginPath(),i.strokeStyle=c.color,i.fillStyle=c.color,i.lineWidth=c.width;for(const s of c.values){let w=c.values.indexOf(s),x=e(this,Zt,"f").indexOf(this.data.xType===st.Date?s.x.toString():s.x),y=e(this,ti,"f").indexOf(s.y);const p=()=>({x:s.x?this.data.xType===st.Date?e(this,Zt,"f")[x]:e(this,Zt,"f")[x].toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0",y:s.y?e(this,ti,"f")[y].toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0"});switch(h=e(this,Nt,"f").left,c.type!==et.Bar&&(h+=x*e(this,jt,"f").step),c.type===et.Line&&(h-=e(this,jt,"f").step/2-e(this,jt,"f").step),c.type){case et.Line:a=e(this,Nt,"f").top+e(this,ei,"f").height-s.y/e(this,$t,"f").unit*e(this,$t,"f").step-Math.abs(e(this,$t,"f").min/e(this,$t,"f").unit*e(this,$t,"f").step);const M=1500/c.values.length*1.2;!e(this,Ut,"f")||this.animations.contains(s.id,Q.Init)?this.animations.add(s.id,Q.Init,{duration:w*M,continuous:!0,body:t=>{if(t=(t*w*M-w*M)/M,0===w||t<0)return;h=e(this,Nt,"f").left+x*e(this,jt,"f").step-e(this,jt,"f").step/2,a=e(this,Nt,"f").top+e(this,ei,"f").height-s.y/e(this,$t,"f").unit*e(this,$t,"f").step-Math.abs(e(this,$t,"f").min/e(this,$t,"f").unit*e(this,$t,"f").step);const n=c.values[w-1];let o=e(this,Nt,"f").left+x*e(this,jt,"f").step-e(this,jt,"f").step/2,l=e(this,Nt,"f").top+e(this,ei,"f").height-n.y/e(this,$t,"f").unit*e(this,$t,"f").step-Math.abs(e(this,$t,"f").min/e(this,$t,"f").unit*e(this,$t,"f").step);i.lineTo(o+(h-o)*t,l+(a-l)*t)}}):(i.lineTo(h,a),e(this,Xt,"m",ai).call(this,h)&&(m={x:h,y:a,index:w},t+=`\n${c.label}: ${p().y}`,mi(this,Jt,h+e(this,jt,"f").step/2,"f")));break;case et.AttentionLine:n=this.canvas.height-e(this,Nt,"f").bottom-s.y/e(this,$t,"f").unit*e(this,$t,"f").step,i.moveTo(e(this,Nt,"f").left,n),!e(this,Ut,"f")||this.animations.contains(s.id,Q.Init)?this.animations.add(s.id,Q.Init,{duration:1500,continuous:!0,body:t=>{i.lineTo(e(this,Nt,"f").left+(this.canvas.width-e(this,Nt,"f").left-e(this,Nt,"f").right)*t,this.canvas.height-e(this,Nt,"f").bottom-s.y/e(this,$t,"f").unit*e(this,$t,"f").step)}}):i.lineTo(this.canvas.width-e(this,Nt,"f").right,n);break;case et.Column:n=s.y>this.data.yMax?this.data.yMax:s.y,a=e(this,ei,"f").height*n/e(this,$t,"f").max,a<e(this,$t,"f").minStep&&(a=e(this,$t,"f").minStep),l=e(this,jt,"f").step*(c.width?c.width/100:.5)/r,!e(this,Ut,"f")||this.animations.contains(s.id+f,Q.Init)?this.animations.add(s.id+f,Q.Init,{duration:800,continuous:!0,body:t=>{n=s.y>this.data.yMax?this.data.yMax:s.y,h=e(this,Nt,"f").left+x*e(this,jt,"f").step,a=e(this,ei,"f").height*n/e(this,$t,"f").max*t,a<e(this,$t,"f").minStep&&(a=e(this,$t,"f").minStep*t),f=this.data.values.filter(t=>t.type===et.Column).indexOf(c),i.fillRect(h+f*l+(e(this,jt,"f").step-r*l)/2,this.canvas.height-e(this,Nt,"f").bottom-a,l,a)}}):(e(this,Xt,"m",ai).call(this,h+e(this,jt,"f").step/2)?(v=this.data.values.filter(t=>(t.type===et.Column||t.type===et.StackingColumn)&&t.values.filter(t=>t.x===s.x).length>0&&!t.disabled).length-1<=f,m={x:h,y:a,index:w},t+=`\n${c.label}: ${p().y}`,mi(this,Jt,h+e(this,jt,"f").step,"f"),i.fillStyle+="88"):i.fillStyle=c.color,i.fillRect(h+f*l+(e(this,jt,"f").step-r*l)/2,this.canvas.height-e(this,Nt,"f").bottom-a,l,a));break;case et.Bar:a=e(this,Nt,"f").top+y*e(this,$t,"f").step+e(this,$t,"f").step/2,!e(this,Ut,"f")||this.animations.contains(s.id+d,Q.Init)?this.animations.add(s.id+d,Q.Init,{duration:800,continuous:!0,body:t=>{a=e(this,Nt,"f").top+y*e(this,$t,"f").step+e(this,$t,"f").step/2,d=this.data.values.filter(t=>t.type===et.Bar).indexOf(c),i.fillRect(h,a-e(this,$t,"f").step/4+d*u,s.x/e(this,jt,"f").unit*e(this,jt,"f").step*t,u)}}):(i.fillRect(h,a-e(this,$t,"f").step/4+d*u,s.x/e(this,jt,"f").unit*e(this,jt,"f").step,u),e(this,Xt,"m",ni).call(this,a)&&(m={x:h,y:a,index:w},t+=`\n${c.label}: ${p().x}`,mi(this,Vt,a-e(this,$t,"f").step/2,"f")));break;case et.StackingColumn:if(a=this.canvas.height-e(this,Nt,"f").bottom-s.y/e(this,$t,"f").unit*e(this,$t,"f").step,l=e(this,jt,"f").step*(c.width?c.width/100:.5),!e(this,Ut,"f")||this.animations.contains(s.id+w,Q.Init))this.animations.add(s.id+w,Q.Init,{duration:800,continuous:!0,body:t=>{f=this.data.values.filter(t=>t.type===et.StackingColumn&&t.values.filter(t=>t.x===s.x).length>0).indexOf(c),h=e(this,Nt,"f").left+x*e(this,jt,"f").step,a=this.canvas.height-e(this,Nt,"f").bottom-s.y/e(this,$t,"f").unit*e(this,$t,"f").step,0===f&&(g[x]=0);let r=void 0!==g[x]?g[x]:0;n=this.canvas.height-e(this,Nt,"f").bottom+r,o=(a-this.canvas.height+e(this,Nt,"f").bottom)*t,n>e(this,Nt,"f").top&&(n+o<e(this,Nt,"f").top&&(o-=n+o-e(this,Nt,"f").top),i.fillRect(h+(e(this,jt,"f").step-l)/2,n,l,o)),g[x]+=(a-this.canvas.height+e(this,Nt,"f").bottom)*t}});else{e(this,Xt,"m",ai).call(this,h+e(this,jt,"f").step/2)?(v=this.data.values.filter(t=>(t.type===et.Column||t.type===et.StackingColumn)&&t.values.filter(t=>t.x===s.x).length>0&&!t.disabled).length-1<=f,m={x:h,y:a,index:x},t+=`\n${c.label}: ${p().y}`,mi(this,Jt,h+e(this,jt,"f").step,"f"),i.fillStyle+="88"):i.fillStyle=c.color;let r=void 0!==g[x]?g[x]:0;n=this.canvas.height-e(this,Nt,"f").bottom+r,o=a-this.canvas.height+e(this,Nt,"f").bottom,n>e(this,Nt,"f").top&&(n+o<e(this,Nt,"f").top&&(o-=n+o-e(this,Nt,"f").top),i.fillRect(h+(e(this,jt,"f").step-l)/2,n,l,o)),g[x]+=a-this.canvas.height+e(this,Nt,"f").bottom}}}switch(c.type){case et.Line:i.stroke(),m&&(i.beginPath(),i.arc(m.x,m.y,5,0,2*Math.PI),i.fill());break;case et.AttentionLine:i.stroke(),i.fillStyle="#000000",i.textBaseline="top",i.textAlign="center",i.fillText(c.label,e(this,Nt,"f").left+(this.canvas.width-e(this,Nt,"f").left-e(this,Nt,"f").right)/2,this.canvas.height-e(this,Nt,"f").bottom-c.values[0].y/e(this,$t,"f").unit*e(this,$t,"f").step+8);break;case et.Column:case et.StackingColumn:if(m&&v){let t=void 0!==g[m.index]?g[m.index]:0;this.canvas.height-e(this,Nt,"f").bottom+t>e(this,Nt,"f").top&&(i.lineWidth=1,i.strokeStyle=s,i.moveTo(e(this,Jt,"f")-e(this,jt,"f").step/2,e(this,Nt,"f").top),i.lineTo(e(this,Jt,"f")-e(this,jt,"f").step/2,this.canvas.height-e(this,Nt,"f").bottom+t),i.stroke())}f++;break;case et.Bar:m&&(i.lineWidth=1,i.strokeStyle=s,i.moveTo(e(this,Nt,"f").left,e(this,Vt,"f")+e(this,$t,"f").step/2),i.lineTo(this.canvas.width-e(this,Nt,"f").right,e(this,Vt,"f")+e(this,$t,"f").step/2),i.stroke()),d++}}i.beginPath(),i.strokeStyle="#000000",i.lineWidth=1,this.data.values.filter(t=>t.type===et.Bar).length>0?(i.moveTo(e(this,Nt,"f").left,this.canvas.height-e(this,Nt,"f").bottom),i.lineTo(e(this,Nt,"f").left,e(this,Nt,"f").top),i.stroke()):(i.moveTo(e(this,Nt,"f").left,this.canvas.height-e(this,Nt,"f").bottom),i.lineTo(this.canvas.width-e(this,Nt,"f").right,this.canvas.height-e(this,Nt,"f").bottom),i.stroke()),this.tooltip.render(!!t&&t.includes("\n"),e(this,Ht,"f"),t),mi(this,Gt,e(this,_t,"f").render(e(this,Ht,"f"),e(this,Gt,"f")),"f"),requestAnimationFrame(this.render.bind(this)),mi(this,Ut,!0,"f")}refresh(){super.refresh()}resize(){super.resize(),mi(this,ii,null,"f"),e(this,Xt,"m",li).call(this)}resetMouse(){super.resetMouse(),mi(this,Ht,new MouseEvent("mousemove"),"f"),mi(this,Gt,new MouseEvent("click"),"f")}}jt=new WeakMap,$t=new WeakMap,Nt=new WeakMap,zt=new WeakMap,Ht=new WeakMap,Gt=new WeakMap,_t=new WeakMap,Ut=new WeakMap,Jt=new WeakMap,Vt=new WeakMap,Kt=new WeakMap,Qt=new WeakMap,Zt=new WeakMap,ti=new WeakMap,ii=new WeakMap,si=new WeakMap,ei=new WeakMap,Xt=new WeakSet,hi=function(){mi(this,zt,this.canvas.getBoundingClientRect(),"f"),e(this,zt,"f").x+=window.scrollX,e(this,zt,"f").y+=window.scrollY,this.canvas.onmousemove=t=>mi(this,Ht,t,"f"),this.canvas.onclick=t=>mi(this,Gt,t,"f")},ai=function(t){if(!e(this,Ht,"f"))return!1;let i=e(this,Ht,"f").clientX-e(this,zt,"f").x+window.scrollX,s=e(this,Ht,"f").clientY-e(this,zt,"f").y+window.scrollY;return t-e(this,jt,"f").step/2<=i&&i<t+e(this,jt,"f").step/2&&e(this,Nt,"f").top<=s&&s<=this.canvas.height-e(this,Nt,"f").bottom&&e(this,Nt,"f").left<i},ni=function(t){if(!e(this,Ht,"f"))return!1;let i=e(this,Ht,"f").clientX-e(this,zt,"f").x+window.scrollX,s=e(this,Ht,"f").clientY-e(this,zt,"f").y+window.scrollY;return t-e(this,$t,"f").step/2<=s&&s<t+e(this,$t,"f").step/2&&e(this,Nt,"f").left<=i&&i<=this.canvas.width-e(this,Nt,"f").right},oi=function(){const t=this.canvas.getContext("2d",{willReadFrequently:!0});if(!t)throw ht.Errors.nullContext;if(e(this,ii,"f"))return void t.putImageData(e(this,ii,"f"),0,0);const i="#0000001e",s=this.data.values.filter(t=>t.type===et.Column).length>0,h=this.data.values.filter(t=>t.type===et.Bar).length>0;(this.data.xTitle||this.data.yTitle)&&(t.textAlign="center",t.textBaseline="bottom",this.data.xTitle&&t.fillText(this.data.xTitle,e(this,Nt,"f").left+(this.canvas.width-e(this,Nt,"f").left-e(this,Nt,"f").right)/2,this.canvas.height-4),this.data.yTitle&&(t.rotate(-Math.PI/2),t.textBaseline="top",t.fillText(this.data.yTitle,-(e(this,Nt,"f").top+(this.canvas.height-e(this,Nt,"f").top-e(this,Nt,"f").bottom)/2),8),t.resetTransform())),t.textAlign="center",t.textBaseline="top";const a=e(this,jt,"f").count>20?20:e(this,jt,"f").count;let n=h?0:1,o=e(this,Zt,"f").length/a;for(let a=h?0:1;a<e(this,Zt,"f").length+1;a++){const l=e(this,Nt,"f").left+n*o*e(this,jt,"f").step,f=Math.round(e(this,Nt,"f").left+a*e(this,jt,"f").step);e(this,Kt,"f").has(f)||e(this,Kt,"f").set(f,this.data.xType===st.Date?new Date(e(this,Zt,"f")[a-1]).toLocaleDateString():isNaN(+e(this,jt,"f").min)||!isFinite(+e(this,jt,"f").min)?e(this,Zt,"f")[a-1]:(e(this,jt,"f").min+(a+(s?-1:0))*(e(this,jt,"f").max-e(this,jt,"f").min)/(e(this,jt,"f").count-1)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}));const r={x:l,y:this.canvas.height-e(this,Nt,"f").bottom,label:this.data.xType===st.Date?new Date(e(this,Zt,"f")[a-1]).toLocaleDateString():isNaN(+e(this,jt,"f").min)||!isFinite(+e(this,jt,"f").min)?e(this,Zt,"f")[a-1]:(e(this,jt,"f").min+(a+(s?-1:0))*(e(this,jt,"f").max-e(this,jt,"f").min)/(e(this,jt,"f").count-1)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})};let d=a>=n*o;if(d){const i=bi.stringWidth(r.label),s=r.x,e=new Uint32Array(t.getImageData(s-i/2,r.y+4,i>0?i:1,24).data.buffer);for(let t=0;t<e.length;t++)if(4278190080&e[t]){d=!1;break}}d&&(t.fillText(r.label,r.x-(h?0:e(this,jt,"f").step/2),r.y+12),h&&(t.beginPath(),t.moveTo(r.x,r.y),t.lineTo(r.x,e(this,Nt,"f").top),t.lineWidth=1,t.strokeStyle=i,t.stroke()),n++)}t.textAlign="right",t.textBaseline="middle";const l=e(this,$t,"f").count>10?10:e(this,$t,"f").count;let f=h?1:0,r=e(this,ti,"f").length/l;for(let s=h?1:0;s<e(this,ti,"f").length+1;s++){const a=this.canvas.height-f*r*e(this,$t,"f").step-e(this,Nt,"f").bottom,n=Math.round(this.canvas.height-s*e(this,$t,"f").step-e(this,Nt,"f").bottom);if(e(this,Qt,"f").get(n)||e(this,Qt,"f").set(n,(e(this,$t,"f").min+(s+(h?-1:0))*(e(this,$t,"f").max-e(this,$t,"f").min)/e(this,$t,"f").count).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})),s>=f*r){const s={x:e(this,Nt,"f").left,y:a,label:e(this,si,"f")>=1?Math.round((e(this,$t,"f").min+(f*r+(h?-1:0))*(e(this,$t,"f").max-e(this,$t,"f").min)/e(this,$t,"f").count)/e(this,si,"f"))*e(this,si,"f"):Math.round(e(this,$t,"f").min+(f*r+(h?-1:0))*(e(this,$t,"f").max-e(this,$t,"f").min)/e(this,$t,"f").count/e(this,si,"f"))*e(this,si,"f")};let n;if(this.data.shortLabels){let t=0;for(;s.label>=1e3;)s.label/=1e3,t++;let i="";switch(t){case 1:i="K";break;case 2:i="M";break;case 3:i="B"}n=s.label.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})+i}else n=s.label.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});t.fillText(n,s.x-12,s.y+(h?e(this,$t,"f").step/2:0)),this.data.values.filter(t=>t.type===et.Column||t.type===et.StackingColumn||t.type===et.Line).length>0&&(t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(this.canvas.width-e(this,Nt,"f").right,s.y),t.lineWidth=1,t.strokeStyle=i,t.stroke()),f++}}mi(this,ii,t.getImageData(0,0,this.canvas.width,this.canvas.height),"f")},li=function(){let t=this.data.values.flatMap(t=>t.values.map(t=>t.x)),i=this.data.values.flatMap(t=>t.values.map(t=>t.y));const s=this.data.xType===st.Date;if(s){let l=new Date(Math.min(...t));function f(t,i){let s=new Date(t);return s.setDate(s.getDate()+i),s}for(;l.getTime()<Math.max(...t);)t.includes(l.getTime())||t.push(new Date(l.getTime())),l=f(l,1);t.sort((t,i)=>t<i?-1:1)}i.sort((t,i)=>i>t?-1:1),mi(this,Zt,[...new Set(t.filter(t=>void 0!==t).map(t=>s?t.toString():t))],"f"),mi(this,ti,[...new Set(i.filter(t=>void 0!==t))],"f"),mi(this,jt,{min:Math.min(...t),max:Math.max(...t),unit:(Math.abs(Math.min(...t))+Math.abs(Math.max(...t)))/(e(this,Zt,"f").length-1),step:(this.canvas.width-e(this,Nt,"f").left-e(this,Nt,"f").right)/e(this,Zt,"f").length,minStep:0,count:e(this,Zt,"f").length},"f");let h=Math.min(...i);h>0&&(h=0),mi(this,$t,{min:h,max:this.data.yMax??Math.max(...i),unit:(Math.abs(h)+Math.abs(this.data.yMax??Math.max(...i)))/(e(this,ti,"f").length-1),step:(this.canvas.height-e(this,Nt,"f").top-e(this,Nt,"f").bottom)/e(this,ti,"f").length,minStep:0,count:e(this,ti,"f").length},"f");let a,n=this.data.values.filter(t=>t.type===et.StackingColumn);if(n.length>0){let r=n.map(t=>t.values.flatMap(t=>+t.y));a=e(this,$t,"f").max;for(let d=0;d<r[0].length;d++){let c=0;for(const u of r)c+=u[d];c>a&&(a=c)}e(this,$t,"f").max=a>this.data.yMax?this.data.yMax:a,e(this,$t,"f").unit=(Math.abs(e(this,$t,"f").min)+Math.abs(e(this,$t,"f").max))/(e(this,ti,"f").length-1)}const o=bi.stringWidth(e(this,$t,"f").max.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}));o>e(this,Nt,"f").left-40&&(e(this,Nt,"f").left+=o-e(this,Nt,"f").left+40,e(this,jt,"f").step=(this.canvas.width-e(this,Nt,"f").left-e(this,Nt,"f").right)/e(this,Zt,"f").length),mi(this,si,Math.abs(e(this,$t,"f").min)+Math.abs(e(this,$t,"f").max),"f"),.5<=e(this,si,"f")&&e(this,si,"f")<1?mi(this,si,.05,"f"):1<=e(this,si,"f")&&e(this,si,"f")<10?mi(this,si,.1,"f"):10<=e(this,si,"f")&&e(this,si,"f")<100?mi(this,si,2,"f"):100<=e(this,si,"f")&&e(this,si,"f")<1e3?mi(this,si,20,"f"):1e3<=e(this,si,"f")&&e(this,si,"f")<1e4?mi(this,si,50,"f"):1e4<=e(this,si,"f")&&e(this,si,"f")<1e5?mi(this,si,1e3,"f"):1e5<=e(this,si,"f")&&e(this,si,"f")<1e6?mi(this,si,1e4,"f"):1e6<=e(this,si,"f")&&e(this,si,"f")<1e7?mi(this,si,5e4,"f"):mi(this,si,1,"f"),1!==e(this,si,"f")&&(a=i.length>10?10*(e(this,$t,"f").max/10+e(this,si,"f")-e(this,$t,"f").max/10%e(this,si,"f")):Math.ceil(e(this,$t,"f").max/e(this,si,"f"))*e(this,si,"f"),e(this,$t,"f").max=a>this.data.yMax?this.data.yMax:a,e(this,$t,"f").unit=(Math.abs(e(this,$t,"f").min)+Math.abs(e(this,$t,"f").max))/e(this,ti,"f").length),mi(this,ei,{width:this.canvas.width-e(this,Nt,"f").left-e(this,Nt,"f").right,height:this.canvas.height-e(this,Nt,"f").top-e(this,Nt,"f").bottom,x:0,y:0,left:0,bottom:0,right:0,top:0,toJSON(){}},"f"),e(this,jt,"f").minStep=.002*e(this,ei,"f").width,e(this,$t,"f").minStep=.002*e(this,ei,"f").height};class Ii extends h{constructor(t,i){super(t,i),fi.add(this),ri.set(this,void 0),di.set(this,void 0),ci.set(this,void 0),this.data=t.data,this.data.values.sort((t,i)=>i.value>t.value?1:-1);const s=i.baseColor??bi.randomColor();let h=Math.round(100/this.data.values.length),a=-50;h<=1&&(h=1);for(let t of this.data.values)t.color=bi.adjustColor(s,a+=h);e(this,fi,"m",ui).call(this)}render(){if(super.render(),0===this.data.values.filter(t=>t.value>0).length)return void e(this,fi,"m",vi).call(this);let t=this.settings.title?50:0,i=this.canvas.width-2*this.data.padding,s=this.canvas.height-2*this.data.padding-t,h=this.data.values.reduce((t,i)=>t+i.value,0),a=i*s,n=this.data.padding,o=this.data.padding+t,l=this.data.padding,f=this.data.padding+t,r=new Fi;const d=this.canvas.getContext("2d",{willReadFrequently:!0});if(!d)throw ht.Errors.nullContext;let c=!0;for(let u=0;u<this.data.values.length;u++){const g=this.data.values[u],v=i-l+this.data.padding,m=s-f+this.data.padding+t;let w=[{color:g.color,label:g.label,s:g.value/h*a,value:g.value,id:g.id,x:n,y:o,w:0,h:0}];if(u+1<=this.data.values.length-1){const t=this.data.values[u+1];w.push({color:t.color,label:t.label,s:t.value/h*a,value:t.value,id:t.id,x:n,y:o,w:0,h:0}),u++}const x=1===w.length,y=u===this.data.values.length-1;if(c)for(let t=1;t<=v+u*u;t++){const i=v-t,s=w[0].s/i;if(s+(x?0:w[1].s/i)>=m){w[0].w=Math.floor(i),w[0].h=Math.floor(s),x||(w[1].w=Math.floor(i),w[1].h=m-w[0].h,w[1].y+=w[0].h);break}}else for(let t=1;t<=m+u*u;t++){const i=m-t,s=w[0].s/i;if(s+(x?0:w[1].s/i)>=v){w[0].h=Math.floor(i),w[0].w=Math.floor(s),x||(w[1].h=Math.floor(i),w[1].w=v-w[0].w,w[1].x+=w[0].w);break}}for(const t of w){y&&(c?(t.w=v,x&&(t.h=m)):(t.h=m,x&&(t.w=v))),d.fillStyle=t.color;const i=e(this,ci,"f")&&!this.animations.contains(t.id,Q.Init),s=u+w.indexOf(t)+(y&&x?1:0),l=260,f=()=>{let t=0;for(let i=0;i<s;i++)t+=l-l*(i/this.data.values.length)/Math.E;return t},g=l-l*s/(this.data.values.length+1);i?e(this,fi,"m",gi).call(this,t)?(r=t,this.animations.add(t.id,Q.MouseOver,{duration:140,body:i=>{i=1-i;const s=t.x+t.w/2,e=t.y+t.h/2,h=.95,a=1-h;d.translate(s-s*(h+i*a),e-e*(h+i*a)),d.scale(h+i*a,h+i*a),this.animations.reload(t.id,Q.MouseLeave)}})):this.animations.add(t.id,Q.MouseLeave,{timer:new Date(2e3,1,1),duration:140,body:i=>{const s=t.x+t.w/2,e=t.y+t.h/2,h=.95,a=1-h;d.translate(s-s*(h+i*a),e-e*(h+i*a)),d.scale(h+i*a,h+i*a),this.animations.reload(t.id,Q.MouseOver)}}):this.animations.add(t.id,Q.Init,{duration:f(),continuous:!0,body:i=>{if(i*f()-f()+g<0)return void(d.fillStyle=t.color+"00");i=(i*f()-f()+g)/g,i=((Math.log(i)+1)/Math.E+1)/Math.E*2;const s=t.x+t.w/2,e=t.y+t.h/2,h=.7,a=1-h;d.translate(s-s*(h+i*a),e-e*(h+i*a)),d.scale(h+i*a,h+i*a);let n=Math.round(255*i).toString(16);n.length<2&&(n=0+n),d.fillStyle=t.color+n}});const p=4;d.roundRect(n+p,o+p,t.w-p,t.h-p,2*p),d.fill(),t.label&&bi.stringWidth(t.label)<t.w-p&&t.h-p>16&&!this.animations.contains(t.id,Q.Init)&&(d.beginPath(),d.fillStyle=bi.isColorVisible(t.color,"#ffffff")?"#ffffff":"#000000",d.font="16px serif",d.textAlign="center",d.textBaseline="middle",d.fillText(t.label,n+t.w/2,o+t.h/2)),d.resetTransform(),c?o+=t.h:n+=t.w,a-=t.w*t.h,h-=t.value}c?(n+=w[0].w,o=f):(o+=w[0].h,n=l),l=n,f=o,c=!c}this.tooltip.render(!!r,e(this,di,"f"),`${r?.label}: ${r?.value?.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`,this.data.values.find(t=>t.id===r?.id)),requestAnimationFrame(this.render.bind(this)),mi(this,ci,!0,"f")}refresh(){super.refresh()}resize(){super.resize(),e(this,fi,"m",ui).call(this),this.animations.clear()}resetMouse(){super.resetMouse(),mi(this,di,new MouseEvent("mousemove"),"f")}}ri=new WeakMap,di=new WeakMap,ci=new WeakMap,fi=new WeakSet,ui=function(){mi(this,ri,this.canvas.getBoundingClientRect(),"f"),e(this,ri,"f").x+=window.scrollX,e(this,ri,"f").y+=window.scrollY,e(this,ci,"f")||(this.canvas.onmousemove=t=>mi(this,di,t,"f"))},gi=function(t){if(!e(this,di,"f")||!t)return!1;let i=e(this,di,"f").clientX-e(this,ri,"f").x+window.scrollX,s=e(this,di,"f").clientY-e(this,ri,"f").y+window.scrollY;return t.x<=i&&i<=t.x+t.w&&t.y<=s&&s<=t.y+t.h},vi=function(){const t=this.canvas.getContext("2d",{willReadFrequently:!0});if(!t)return ht.Errors.nullContext;t.font="14px serif",t.textAlign="center",t.textBaseline="middle",t.fillStyle="#000000",t.fillText("Incorrect values",this.canvas.width/2,this.canvas.height/2)};class Di{}class Ri extends t{constructor(t){super(),Object.assign(this,t)}toggle(t){super.toggle(t)}checkCondition(){return super.checkCondition(),!0}reset(){super.reset()}}class Li extends t{constructor(t){super(),Object.assign(this,t)}toggle(t){super.toggle(t),this.disabled?this.current=this.value*(1-t):this.current=this.value*t}checkCondition(){return super.checkCondition(),0===this.current&&!this.disabled||0!==this.value}reset(){super.reset(),this.current=this.value}}class Fi{constructor(){}}}})[832]()})();
//# sourceMappingURL=ocharts.js.map